<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Expected kin counts by type of relative in a two-sex multi-state time-varying framework • DemoKin</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Expected kin counts by type of relative in a two-sex multi-state time-varying framework">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DemoKin</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Reference_OneSex.html">Expected kin counts by type of relative in a one-sex framework</a></li>
    <li><a class="dropdown-item" href="../articles/Reference_TwoSex_MultiState_TimeVariant.html">Expected kin counts by type of relative in a two-sex multi-state time-varying framework</a></li>
    <li><a class="dropdown-item" href="../articles/Reference_TwoSex.html">Two-sex kinship model</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/IvanWilli/DemoKin/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Expected kin counts by type of relative in a two-sex multi-state time-varying framework</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/IvanWilli/DemoKin/blob/main/vignettes/Reference_TwoSex_MultiState_TimeVariant.Rmd" class="external-link"><code>vignettes/Reference_TwoSex_MultiState_TimeVariant.Rmd</code></a></small>
      <div class="d-none name"><code>Reference_TwoSex_MultiState_TimeVariant.Rmd</code></div>
    </div>

    
    
<p>Since the inception of Caswell’s <span class="citation">[@caswell_formal_2019]</span> proposed one-sex
time-invariant age-structured matrix model of kinship, there have been
many extensions to the framework (many of which are documented within
this package). Caswell <span class="citation">[-@caswell_formal_2021]</span> updated the original
model to incorporate time-varying vital rates, Caswell <span class="citation">[-@caswell_formal_2022]</span> introduced two-sexes to
the model, and Caswell <span class="citation">[-@caswell_formal_2020]</span> considered a multi-stage
population of kin. Here, we provide an R function which combines the
three aforementioned models.</p>
<p>In this vignette, we’ll demonstrate how the function
<code>kin_multi_stage_time_variant_2sex</code> computes stage-specific
kinship networks encompassing both sexes for an average member of a
population, the sex of whom is user specified, and who is subject to
time-varying demographic rates. We call this individual Focal. We seek
the number of, age, and stage distribution of Focal’s relatives, for
each age of Focal’s life, and as a function of the year in which Focal
is born.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pkgload</span><span class="fu">::</span><span class="fu"><a href="https://pkgload.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org" class="external-link">Matrix</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jabiru/tictoc" class="external-link">tictoc</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>dplyr.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># hide if we don't want to see summarise output (but also #lose #progress bar)</span></span></code></pre></div>
<div class="section level3">
<h3 id="kin-counts-by-parity">Kin counts by parity<a class="anchor" aria-label="anchor" href="#kin-counts-by-parity"></a>
</h3>
<p>In this example we use parity as an example stage. UK data ranging
from 1965 - 2022 is sourced from the <a href="https://www.mortality.org/" class="external-link">Human Mortality Database</a> and <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/birthsdeathsandmarriages/conceptionandfertilityrates/adhocs/1887fertilityratesbyparityenglandandwales1934to2022/" class="external-link">Office
for National Statistics</a>. Some simplifying assumptions we make due to
data availability are as follows:</p>
<ol style="list-style-type: lower-roman">
<li>Fertility rates vary with time, are distinct among parity class, but
the same over sexes (the so-called ``androgynous approximation’’).</li>
<li>Mortality rates vary with time, are distinct across sex, but are the
same over parity classes (no parity-specific mortality)</li>
<li>The age-specific probabilities of parity-progression vary with time,
but are the same over sex (androgynous approximation again)</li>
</ol>
<p>In order to implement the model, the function
<code>kin_multi_stage_time_variant_2sex</code> expects the following 7
inputs of vital rates, fed in as lists:</p>
<ol style="list-style-type: decimal">
<li><p><code>U_list_females</code> A list of female age-and-parity
specific survival probabilities over the timescale (in matrix forms).
This input list has length = the timescale, and each entry represents
the rates of a specific period in matrix form: stage columns, age
rows.</p></li>
<li><p><code>U_list_males</code> A list of male age-and-parity specific
survival probabilities over the timescale (in matrix forms). This input
list has length = the timescale, and each entry represents the rates of
a specific period in matrix form: stage columns, age rows.</p></li>
<li><p><code>F_list_females</code> A list of female age-and-parity
specific fertility rates over the timescale (in matrix forms). This
input list has length = the timescale, and each entry represents the
rates of a specific period in matrix form: stage columns, age
rows.</p></li>
<li><p><code>F_list_males</code> A list of male age-and-parity specific
fertility rates over the timescale (in matrix forms). This input list
has length = the timescale, and each entry represents the rates of a
specific period in matrix form: stage columns, age rows.</p></li>
<li><p><code>T_list_females</code> A list of lists of female
age-specific probabilities of moving up parity over the timescale (in
matrix forms). The outer list has length = the timescale. The inner list
has length = number of ages. Each outer list entry is comprised of a
list of matrices (stage*stage dimensional), each matrix describes
age-specific probabilities of moving stage. Thus for each year, we have
a list of age-specific probabilities of moving from one stage to the
next.</p></li>
<li><p>Same as 5) but for males</p></li>
<li><p><code>H_list</code> A list of length = timescale, in which each
element is a matrix which assigns the offspring of individuals in some
stage to the appropriate age class (age in rows and states in
columns)</p></li>
</ol>
<p>To avoid the need for tedious calculations to put data into such
format in this vignette, these lists are constructed in another file and
simply imported below. The code below reads in the above function input
lists.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">F_mat_fem</span> <span class="op">&lt;-</span> <span class="va">Female_parity_fert_list_UK</span></span>
<span><span class="va">F_mat_male</span> <span class="op">&lt;-</span> <span class="va">Female_parity_fert_list_UK</span></span>
<span><span class="va">T_mat_fem</span> <span class="op">&lt;-</span> <span class="va">Parity_transfers_by_age_list_UK</span></span>
<span><span class="va">T_mat_male</span> <span class="op">&lt;-</span> <span class="va">Parity_transfers_by_age_list_UK</span></span>
<span><span class="va">U_mat_fem</span> <span class="op">&lt;-</span> <span class="va">Female_parity_mortality_list_UK</span></span>
<span><span class="va">U_mat_male</span> <span class="op">&lt;-</span> <span class="va">Male_parity_mortality_list_UK</span></span>
<span><span class="va">H_mat</span> <span class="op">&lt;-</span> <span class="va">Redistribution_by_parity_list_UK</span></span></code></pre></div>
<p>Recap: above are lists of period-specific demographic rates, in
particular comprising:</p>
<p>U_mat_fem: list of age by stage matrices, entries give female
probability of survival. List starting 1965 ending 2022.</p>
<p>U_mat_male: list of age by stage matrices, entries give female
probability of survival. List starting 1965 ending 2022.</p>
<p>F_mat_fem: list of age by stage matrices, entries give female fert,
List starting 1965 ending 2022.</p>
<p>F_mat_male == F_mat_fem.</p>
<p>T_mat_fem: list of lists of matrices: Each outer list entry is a list
of matrices where each matrix gives age-specific probabilities a female
moves up parity (inner list has length of number of age-classes). Outer
list starting 1965 ending 2022</p>
<p>T_mat_male == T_mat_fem.</p>
<p>H_mat: list of matrices which redistributes newborns to age-class 1
and parity 0. No time-variation.</p>
</div>
<div class="section level3">
<h3 id="accumulated-number-of-kin-focal-expects-over-the-lifecourse-under-time-varying-rates-from-1965-to-2005">1. Accumulated number of kin Focal expects over the lifecourse under
time-varying rates from 1965 to 2005<a class="anchor" aria-label="anchor" href="#accumulated-number-of-kin-focal-expects-over-the-lifecourse-under-time-varying-rates-from-1965-to-2005"></a>
</h3>
<p>We feed the above inputs into the matrix model, along with other
arguments:</p>
<ul>
<li>UK sex ratio –&gt; <code>birth_female</code> = 0.49</li>
<li>We are considering parity –&gt; <code>parity</code> = TRUE</li>
<li>We want some of Focal’s kin network –&gt; <code>output_kin</code> =
c(“d”, “oa”, “ys”, “os”)</li>
<li>Accumulated kin in this example –&gt; <code>summary_kin</code> =
TRUE</li>
<li>Focal is female –&gt; <code>sex_Focal</code> = “Female”</li>
<li>Focal born into parity 0 –&gt; <code>initial_stage_Focal</code> =
1</li>
<li>timescale as ouptut – &gt; <code>output_years</code> = c(1965, 1975,
1985, 1995, 2005)</li>
</ul>
<p>Accumulated kin are outputted by the argument
<code>summary_kin</code> = TRUE. In such cases, for each age of Focal,
we sum over all possible ages of kin yielding the marginal stage
distribution of kin.</p>
<p>The first sets of time-varying vital rates in our input lists are
e.g., U_mat_fem[[1]] (corresponding to mortality in 1965), the 41-st
entry is U_mat_fem[[(1+40)]] (mortality in 2005). We require consistency
between the length of the list of vital rates and the timescale:
U_mat_fem[[1:(1+40)]] = in length = seq(1965,2005). Therefore we use the
input lists of demographic rates</p>
<p><code>U_list_females</code> = U_mat_fem[1:(1+no_years)] which runs
from U_mat_fem[[1]] = 1965 set of rates, up to U_mat_fem[[41]] = 2005
set of rates, and so on…</p>
<blockquote>
<p>this run takes some time (round 10 min) so we don´t include the
output in the vignette. Please try it!</p>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run kinship model for a female Focal over a timescale of no_years (we use 40 here)</span></span>
<span><span class="va">no_years</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="co"># and we start projecting kin in 1965</span></span>
<span><span class="co"># We decide here to count accumulated kin by age of Focal, and not distributions of kin</span></span>
<span><span class="va">kin_out_1965_2005</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/kin_multi_stage_time_variant_2sex.html">kin_multi_stage_time_variant_2sex</a></span><span class="op">(</span>U_list_females <span class="op">=</span> <span class="va">U_mat_fem</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">no_years</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    U_list_males <span class="op">=</span> <span class="va">U_mat_male</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">no_years</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    F_list_females <span class="op">=</span> <span class="va">F_mat_fem</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">no_years</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    F_list_males <span class="op">=</span> <span class="va">F_mat_male</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">no_years</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    T_list_females <span class="op">=</span> <span class="va">T_mat_fem</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">no_years</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    T_list_males <span class="op">=</span> <span class="va">T_mat_fem</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">no_years</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    H_list <span class="op">=</span> <span class="va">H_mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">no_years</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                    birth_female <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fl">0.51</span>, <span class="co">## Sex ratio -- UK value</span></span>
<span>                                    parity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                    output_kin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"oa"</span>, <span class="st">"ys"</span>, <span class="st">"os"</span><span class="op">)</span>,</span>
<span>                                    summary_kin <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                    sex_Focal <span class="op">=</span> <span class="st">"Female"</span>, <span class="co">##  define Focal's sex at birth</span></span>
<span>                                    initial_stage_Focal <span class="op">=</span> <span class="fl">1</span>, <span class="co">## Define Focal's stage at birth</span></span>
<span>                                    output_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1965</span>, <span class="fl">1975</span>, <span class="fl">1985</span>, <span class="fl">1995</span>, <span class="fl">2005</span><span class="op">)</span> <span class="co">## the sequence of years we run the function over</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-the-output">1.1. Visualizing the output<a class="anchor" aria-label="anchor" href="#visualizing-the-output"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kin_out_1965_2005</span><span class="op">$</span><span class="va">kin_summary</span><span class="op">)</span></span></code></pre></div>
<p>Notice the structure of the output data. We have columns
<code>age_focal</code> and <code>kin_stage</code> because we sum over
all ages of kin, and produce the marginal stage distribution given age
of Focal. We have a column corresponding to sex of kin
<code>sex_kin</code>, a column showing which <code>year</code> we are
considering, and a column headed <code>group</code> which selects the
kin type. Finally, we have columns showing Focal’s cohort of birth
<code>cohort</code> (e.g., year - age of Focal), and an as.factor()
equivalent.</p>
</div>
<div class="section level3">
<h3 id="plotting-kin-for-an-average-focal-at-some-fixed-period-in-time">1.1.1. Plotting kin for an average Focal at some fixed period in
time<a class="anchor" aria-label="anchor" href="#plotting-kin-for-an-average-focal-at-some-fixed-period-in-time"></a>
</h3>
<p>Let’s suppose that we really want to understand the age*parity
distributions of the accumulated number of aunts and uncles older than
Focal’s mother and father, for each age of Focal, over years 1965, 1975,
1985, 1995, 2005. Some people will do….</p>
<p>We restrict Focal’s kinship network to aunts and uncles older than
Focal’s mother by <code>group</code> == “oa”. We visualise the marginal
parity distributions of kin: <code>stage_kin</code>, for each age of
Focal <code>age_focal</code>, using different colour schemes. Implicit
in the below plot is that we really plot Focal’s born into different
<code>cohort</code> – i.e., in the 2005 panel we show a 50 year old
Focal was born in 1955, while a 40 year old Focal was born in 1965.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_out_1965_2005</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"oa"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age_focal</span>, y <span class="op">=</span> <span class="va">count</span>, color <span class="op">=</span> <span class="va">stage_kin</span>, fill <span class="op">=</span> <span class="va">stage_kin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"stack"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">sex_kin</span> <span class="op">~</span> <span class="va">year</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">40</span>,<span class="fl">50</span>,<span class="fl">60</span>,<span class="fl">70</span>,<span class="fl">80</span>,<span class="fl">90</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Older aunts and uncles"</span><span class="op">)</span></span></code></pre></div>
<p>We could also consider any other kin in Focal’s network, for
instance, offspring using <code>group</code> == “d”</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_out_1965_2005</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"d"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age_focal</span>, y <span class="op">=</span> <span class="va">count</span>, color <span class="op">=</span> <span class="va">stage_kin</span>, fill <span class="op">=</span> <span class="va">stage_kin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"stack"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">sex_kin</span> <span class="op">~</span> <span class="va">year</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">40</span>,<span class="fl">50</span>,<span class="fl">60</span>,<span class="fl">70</span>,<span class="fl">80</span>,<span class="fl">90</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Offspring"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting-the-kin-of-focal-as-a-function-of-focals-cohort-of-birth">1.1.2. Plotting the kin of Focal as a function of Focal’s cohort of
birth<a class="anchor" aria-label="anchor" href="#plotting-the-kin-of-focal-as-a-function-of-focals-cohort-of-birth"></a>
</h3>
<p>Since we only ran the model for 40 years (between 1965-2005), there
is very little scope to view kinship as cohort-specific. We can however
compare cohorts for 40-year segments of Focal’s life. Below, following
from the above example, we once again consider offspring and only show
Focals born of <code>cohort</code> 1910, 1925, or 1965:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_out_1965_2005</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"d"</span>, <span class="va">cohort</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1910</span>,<span class="fl">1925</span>,<span class="fl">1965</span><span class="op">)</span> <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age_focal</span>, y <span class="op">=</span> <span class="va">count</span>, color <span class="op">=</span> <span class="va">stage_kin</span>, fill <span class="op">=</span> <span class="va">stage_kin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"stack"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">sex_kin</span> <span class="op">~</span> <span class="va">cohort</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Offspring"</span><span class="op">)</span></span></code></pre></div>
<p>The LHS plot (1910 cohort) should be interpreted as follows: if Focal
is born in 1910, between 1965-2005 he/she will be 55-95 years old. Focal
will have already accumulated its maximal number of offspring, and their
overall number will now be dropping as mortality risk begins. The
offspring of Focal will be approximately 20-35, and began if not
completed reproduction/parity progression.</p>
<p>The middle plot (1925 cohort) shows Focal between ages 40 and 80.
Again, Focal will have completed reproduction and can only lose
offspring as he/she ages. However, Offspring at Focal of age 40 will be
around 10-20 and still have high probability of being in parity 0.
Whereas, Focal at age of 80 will have offspring aged around 50, who in
turn will have completed reproduction as demonstrated by a well mixed
parity-distribution at this age of Focal.</p>
<p>the RHS plot (1965 cohort) simply reflects the fact that Focal will
not start reproduction until around 15 years old.</p>
</div>
<div class="section level3">
<h3 id="now-lets-consider-the-distributions-of-kin-focal-expects-over-the-lifecourse">2. Now lets consider the distributions of kin Focal expects over the
lifecourse<a class="anchor" aria-label="anchor" href="#now-lets-consider-the-distributions-of-kin-focal-expects-over-the-lifecourse"></a>
</h3>
<p>To obtain distributions of kin as output, we simply use the
<code>kin_full</code> data.frame.</p>
</div>
<div class="section level3">
<h3 id="visualizing-the-output-1">2.1. Visualizing the output<a class="anchor" aria-label="anchor" href="#visualizing-the-output-1"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kin_out_1965_2005</span><span class="op">$</span><span class="va">kin_full</span><span class="op">)</span></span></code></pre></div>
<p>Notice the additional column <code>age_kin</code>. Rather than
grouping kin by stage and summing over all ages, the output here (in
data frame form) gives an expected number of kin for each age*stage
combination, for each age of Focal.</p>
</div>
<div class="section level3">
<h3 id="plotting-kin-distributions-for-an-average-focal-of-fixed-age-at-some-fixed-period-in-time">2.1.1. Plotting kin distributions for an average Focal of fixed age,
at some fixed period in time<a class="anchor" aria-label="anchor" href="#plotting-kin-distributions-for-an-average-focal-of-fixed-age-at-some-fixed-period-in-time"></a>
</h3>
<p>Lets’s consider Focal is aged 50 <code>age_focal</code> == 50, and
examine kin younger siblings; <code>group</code> == “ys”. Restricting
ourselves to the years 1965, 1975, 1985, 1995, 2005, we can plot the
expected age*stage distribution of these kin over the considered
periods, as shown below:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_out_1965_2005</span><span class="op">$</span><span class="va">kin_full</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ys"</span>,</span>
<span>                <span class="va">age_focal</span> <span class="op">==</span> <span class="fl">50</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age_kin</span>, y <span class="op">=</span> <span class="va">count</span>, color <span class="op">=</span> <span class="va">stage_kin</span>, fill <span class="op">=</span> <span class="va">stage_kin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"stack"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">sex_kin</span> <span class="op">~</span> <span class="va">year</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">40</span>,<span class="fl">50</span>,<span class="fl">60</span>,<span class="fl">70</span>,<span class="fl">80</span>,<span class="fl">90</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Younger siblings"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Focal 50"</span><span class="op">)</span></span></code></pre></div>
<p>Notice the discontinuity along the x-abscissa at 50. This reflects
the fact that Focal’s younger siblings cannot are of age &lt;50.
Contrastingly, when we look at the age*stage distribution of older
siblings, we observe another discontinuity which bounds kin to be of age
&gt;50, as plotted below:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_out_1965_2005</span><span class="op">$</span><span class="va">kin_full</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"os"</span>,</span>
<span>                <span class="va">age_focal</span> <span class="op">==</span> <span class="fl">50</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age_kin</span>, y <span class="op">=</span> <span class="va">count</span>, color <span class="op">=</span> <span class="va">stage_kin</span>, fill <span class="op">=</span> <span class="va">stage_kin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"stack"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">sex_kin</span> <span class="op">~</span> <span class="va">year</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">40</span>,<span class="fl">50</span>,<span class="fl">60</span>,<span class="fl">70</span>,<span class="fl">80</span>,<span class="fl">90</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Older siblings"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Focal 50"</span><span class="op">)</span></span></code></pre></div>
<p>With a simple bit of playing with the output data frame, we can plot
the age*stage distribution of the combined siblings of Focal</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_out_1965_2005</span><span class="op">$</span><span class="va">kin_full</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ys"</span> <span class="op">|</span> <span class="va">group</span> <span class="op">==</span> <span class="st">"os"</span><span class="op">)</span>,</span>
<span>                <span class="va">age_focal</span> <span class="op">==</span> <span class="fl">50</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">group</span>, values_from <span class="op">=</span> <span class="va">count</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>count <span class="op">=</span> <span class="va">`ys`</span> <span class="op">+</span> <span class="va">`os`</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age_kin</span>, y <span class="op">=</span> <span class="va">count</span>, color <span class="op">=</span> <span class="va">stage_kin</span>, fill <span class="op">=</span> <span class="va">stage_kin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"stack"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">sex_kin</span> <span class="op">~</span> <span class="va">year</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">40</span>,<span class="fl">50</span>,<span class="fl">60</span>,<span class="fl">70</span>,<span class="fl">80</span>,<span class="fl">90</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"All siblings"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Focal 50"</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Iván Williams, Diego Alburez-Gutierrez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
