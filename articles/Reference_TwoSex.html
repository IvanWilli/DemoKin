<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Two-sex kinship model • DemoKin</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Two-sex kinship model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DemoKin</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Reference_OneSex.html">Expected kin counts by type of relative in a one-sex framework</a></li>
    <li><a class="dropdown-item" href="../articles/Reference_TwoSex_MultiState_TimeVariant.html">Expected kin counts by type of relative in a two-sex multi-state time-varying framework</a></li>
    <li><a class="dropdown-item" href="../articles/Reference_TwoSex.html">Two-sex kinship model</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/IvanWilli/DemoKin/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Two-sex kinship model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/IvanWilli/DemoKin/blob/main/vignettes/Reference_TwoSex.Rmd" class="external-link"><code>vignettes/Reference_TwoSex.Rmd</code></a></small>
      <div class="d-none name"><code>Reference_TwoSex.Rmd</code></div>
    </div>

    
    
<p>Human males generally live shorter and reproduce later than females.
These sex-specific processes affect kinship dynamics in a number of
ways. For example, the degree to which an average member of the
population, call her Focal, has a living grandparent is affected by
differential mortality affecting the parental generation at older ages.
We may also be interested in considering how kinship structures vary by
Focal’s sex: a male Focal may have a different number of grandchildren
than a female Focal given differences in fertility by sex. Documenting
these differences matters since women often face greater expectations to
provide support and informal care to relatives. As they live longer,
they may find themselves at greater risk of being having no living kin.
The function <code>kin2sex</code> implements two-sex kinship models as
introduced by Caswell <span class="citation">(2022)</span>. This
vignette show how to run two-sex models and highlights some of the
advantages of this model over one-sex models in populations with
time-invariant and time-variant rates.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># library(DemoKin)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="fu">pkgload</span><span class="fu">::</span><span class="fu"><a href="https://pkgload.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># devtools::load_all()</span></span></code></pre></div>
<div class="section level3">
<h3 id="demographic-rates-by-sex">1. Demographic rates by sex<a class="anchor" aria-label="anchor" href="#demographic-rates-by-sex"></a>
</h3>
<p>Data on female fertility by age is less common than female fertility.
Schoumaker (2019) shows that male TFR is almost always higher than
female Total Fertility Rates (TFR) using a sample of 160 countries. For
this example, we use data from 2012 France to exemplify the use of the
two-sex function. Data on female and male fertility and mortality are
included in <code>DemoKin</code>. In this population, male and female
TFR is almost identical (1.98 and 1.99) but the distributions of
fertility by sex varies over age:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fra_asfr_sex</span>, package <span class="op">=</span> <span class="st">"DemoKin"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fra_surv_sex</span>, package <span class="op">=</span> <span class="st">"DemoKin"</span><span class="op">)</span></span>
<span><span class="va">fra_fert_f</span> <span class="op">&lt;-</span> <span class="va">fra_asfr_sex</span><span class="op">[</span>,<span class="st">"ff"</span><span class="op">]</span></span>
<span><span class="va">fra_fert_m</span> <span class="op">&lt;-</span> <span class="va">fra_asfr_sex</span><span class="op">[</span>,<span class="st">"fm"</span><span class="op">]</span></span>
<span><span class="va">fra_surv_f</span> <span class="op">&lt;-</span> <span class="va">fra_surv_sex</span><span class="op">[</span>,<span class="st">"pf"</span><span class="op">]</span></span>
<span><span class="va">fra_surv_m</span> <span class="op">&lt;-</span> <span class="va">fra_surv_sex</span><span class="op">[</span>,<span class="st">"pm"</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fra_fert_m</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fra_fert_f</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.0115</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fra_fert_f</span>, <span class="va">fra_fert_m</span>, <span class="va">fra_surv_f</span>, <span class="va">fra_surv_m</span><span class="op">)</span>,</span>
<span>           age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>           sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"f"</span>, <span class="fl">101</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="fl">101</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>           risk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"fertility rate"</span>, <span class="fl">101</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"survival probability"</span>, <span class="fl">101</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">value</span>, col<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">risk</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reference_TwoSex_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="time-invariant-two-sex-kinship-models">2. Time-invariant two-sex kinship models<a class="anchor" aria-label="anchor" href="#time-invariant-two-sex-kinship-models"></a>
</h3>
<p>We now introduce the functions <code>kin2sex</code>, which is similar
to the one-sex function <code>kin</code> (see <code><a href="../reference/kin.html">?kin</a></code>) with
two exceptions. First, the user needs to specify mortality and fertility
by sex. Second, the user must indicate the sex of Focal (which was
assumed to be female in the one-sex model). Let us first consider the
application for time-invariant populations:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kin2sex.html">kin2sex</a></span><span class="op">(</span></span>
<span>  pf <span class="op">=</span> <span class="va">fra_surv_f</span>,</span>
<span>  pm <span class="op">=</span> <span class="va">fra_surv_m</span>, </span>
<span>  ff <span class="op">=</span> <span class="va">fra_fert_f</span>, </span>
<span>  fm <span class="op">=</span> <span class="va">fra_fert_m</span>, </span>
<span>  time_invariant <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sex_focal <span class="op">=</span> <span class="st">"f"</span>, </span>
<span>  birth_female <span class="op">=</span> <span class="fl">.5</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>The output of <code>kin2sex</code> is equivalent to that of
<code>kin</code>, except that it includes a column <code>sex_kin</code>
to specify the sex of the given relatives.</p>
<p>Let’s group aunts and siblings to visualize the number of living kin
by Focal’s age.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_out</span> <span class="op">&lt;-</span> <span class="va">kin_result</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>kin <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">kin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="st">"s"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"s"</span>,</span>
<span>                         <span class="va">kin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ya"</span>, <span class="st">"oa"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"a"</span>,</span>
<span>                         <span class="cn">T</span> <span class="op">~</span> <span class="va">kin</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">kin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"m"</span>, <span class="st">"gm"</span>, <span class="st">"ggm"</span>, <span class="st">"s"</span>, <span class="st">"a"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kin_out</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">kin</span>, <span class="va">age_focal</span>, <span class="va">sex_kin</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count_living</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age_focal</span>, <span class="va">count</span>, fill<span class="op">=</span><span class="va">sex_kin</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">kin</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reference_TwoSex_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p><strong>A note on terminology</strong></p>
<p>The function <code>kin2sex</code> uses the same codes as
<code>kin</code> to identify relatives (see
<code><a href="../reference/demokin_codes.html">demokin_codes()</a></code>). Note that when running a two-sex model,
the code ‘m’ refers to either mothers or fathers! Use the column
<code>sex_kin</code> to determine the sex of a given relatives. For
example, in order to consider only sons and ignore daughters, use:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_result</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">kin</span> <span class="op">==</span> <span class="st">"d"</span>, <span class="va">sex_kin</span> <span class="op">==</span> <span class="st">"m"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 11</span></span></span>
<span><span class="co">#&gt;   age_focal kin   sex_kin year  cohort count_living mean_age sd_age count_dead</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         0 d     m       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>                0      <span style="color: #BB0000;">NaN</span>    <span style="color: #BB0000;">NaN</span>          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>         1 d     m       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>                0      <span style="color: #BB0000;">NaN</span>    <span style="color: #BB0000;">NaN</span>          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>         2 d     m       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>                0      <span style="color: #BB0000;">NaN</span>    <span style="color: #BB0000;">NaN</span>          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>         3 d     m       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>                0      <span style="color: #BB0000;">NaN</span>    <span style="color: #BB0000;">NaN</span>          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>         4 d     m       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>                0      <span style="color: #BB0000;">NaN</span>    <span style="color: #BB0000;">NaN</span>          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>         5 d     m       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>                0      <span style="color: #BB0000;">NaN</span>    <span style="color: #BB0000;">NaN</span>          0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: count_cum_dead &lt;dbl&gt;, mean_age_lost &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Information on kin availability by sex allows us to consider sex
ratios, a traditional measure in demography, with females often in
denominator. The following figure, for example, shows that a 25yo French
woman in our hypothetical population can expect to have 0.5 grandfathers
for every grandmother:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_out</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">kin</span>, <span class="va">age_focal</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>sex_ratio<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count_living</span><span class="op">[</span><span class="va">sex_kin</span><span class="op">==</span><span class="st">"m"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count_living</span><span class="op">[</span><span class="va">sex_kin</span><span class="op">==</span><span class="st">"f"</span><span class="op">]</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age_focal</span>, <span class="va">sex_ratio</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">kin</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reference_TwoSex_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>The experience of kin loss for Focal depends on differences in
mortality between sexes. A female Focal starts losing fathers earlier
than mothers. We see a slightly different pattern for grandparents since
Focal’s experience of grandparental loss is dependent on the initial
availability of grandparents (i.e. if Focal’s grandparent died before
her birth, she will never experience his death).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sex ratio</span></span>
<span><span class="va">kin_out</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">kin</span>, <span class="va">sex_kin</span>, <span class="va">age_focal</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count_dead</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age_focal</span>, <span class="va">count</span>, col<span class="op">=</span><span class="va">sex_kin</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">kin</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reference_TwoSex_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="time-variant-two-sex-kinship-models">3. Time-variant two-sex kinship models<a class="anchor" aria-label="anchor" href="#time-variant-two-sex-kinship-models"></a>
</h3>
<p>We look at populations where demographic rates are not static but
change on a yearly basis. For this, we consider the case of Sweden using
data pre-loaded in <code>DemoKin</code>. For this example, we will
create ‘pretend’ male fertility rates by slightly perturbing the
existing female rates. This is a toy example, since a real two-sex model
should use actual female and male rates as inputs.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">swe_px</span><span class="op">)</span></span>
<span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">swe_px</span><span class="op">)</span></span>
<span><span class="va">swe_surv_f_matrix</span> <span class="op">&lt;-</span> <span class="va">swe_px</span></span>
<span><span class="va">swe_surv_m_matrix</span> <span class="op">&lt;-</span> <span class="va">swe_px</span> <span class="op">^</span> <span class="fl">1.5</span> <span class="co"># artificial perturbation for this example</span></span>
<span><span class="va">swe_fert_f_matrix</span> <span class="op">&lt;-</span> <span class="va">swe_asfr</span></span>
<span><span class="va">swe_fert_m_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="va">years</span><span class="op">)</span>,  </span>
<span>            <span class="va">swe_asfr</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="op">(</span><span class="va">ages</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span><span class="op">:</span><span class="va">ages</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.05</span> <span class="co"># artificial perturbation for this example</span></span></code></pre></div>
<p>This is how it looks for year 1900:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, sex <span class="op">=</span> <span class="st">"Female"</span>, component <span class="op">=</span> <span class="st">"Fertility rate"</span>, value <span class="op">=</span> <span class="va">swe_fert_f_matrix</span><span class="op">[</span>,<span class="st">"1900"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, sex <span class="op">=</span> <span class="st">"Male"</span>, component <span class="op">=</span> <span class="st">"Fertility rate"</span>, value <span class="op">=</span> <span class="va">swe_fert_m_matrix</span><span class="op">[</span>,<span class="st">"1900"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, sex <span class="op">=</span> <span class="st">"Female"</span>, component <span class="op">=</span> <span class="st">"Survival probability"</span>, value <span class="op">=</span> <span class="va">swe_surv_f_matrix</span><span class="op">[</span>,<span class="st">"1900"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, sex <span class="op">=</span> <span class="st">"Male"</span>, component <span class="op">=</span> <span class="st">"Survival probability"</span>, value <span class="op">=</span> <span class="va">swe_surv_m_matrix</span><span class="op">[</span>,<span class="st">"1900"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">value</span>, col <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">component</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reference_TwoSex_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>We now run the time-variant two-sex models (note the
<code>time_invariant = FALSE</code> argument):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_out_time_variant</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kin2sex.html">kin2sex</a></span><span class="op">(</span></span>
<span>                      pf <span class="op">=</span> <span class="va">swe_surv_f_matrix</span>, </span>
<span>                      pm <span class="op">=</span> <span class="va">swe_surv_m_matrix</span>,</span>
<span>                      ff <span class="op">=</span> <span class="va">swe_fert_f_matrix</span>, </span>
<span>                      fm <span class="op">=</span> <span class="va">swe_fert_m_matrix</span>,</span>
<span>                      sex_focal <span class="op">=</span> <span class="st">"f"</span>,</span>
<span>                      time_invariant <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      birth_female <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>                      output_cohort <span class="op">=</span> <span class="fl">1900</span></span>
<span>                      <span class="op">)</span></span>
<span><span class="co">#&gt;  Preparing output...</span></span>
<span><span class="co">#&gt; Assuming stable population before 1900.</span></span></code></pre></div>
<p>We can plot data on kin availability alongside values coming from a
time-invariant model to show how demographic change matters: the
time-variant models take into account changes derived from the
demographic transition, whereas the time-invariant models assume
never-changing rates.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_out_time_invariant</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kin2sex.html">kin2sex</a></span><span class="op">(</span></span>
<span>                      <span class="va">swe_surv_f_matrix</span><span class="op">[</span>,<span class="st">"1900"</span><span class="op">]</span>, <span class="va">swe_surv_m_matrix</span><span class="op">[</span>,<span class="st">"1900"</span><span class="op">]</span>, </span>
<span>                      <span class="va">swe_fert_f_matrix</span><span class="op">[</span>,<span class="st">"1900"</span><span class="op">]</span>, <span class="va">swe_fert_m_matrix</span><span class="op">[</span>,<span class="st">"1900"</span><span class="op">]</span>, </span>
<span>                      sex_focal <span class="op">=</span> <span class="st">"f"</span>, birth_female <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">kin_out_time_variant</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cohort</span> <span class="op">==</span> <span class="fl">1900</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"variant"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">kin_out_time_invariant</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"invariant"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>kin <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">kin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ys"</span>, <span class="st">"os"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"s"</span>,</span>
<span>                         <span class="va">kin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ya"</span>, <span class="st">"oa"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"a"</span>,</span>
<span>                         <span class="cn">T</span> <span class="op">~</span> <span class="va">kin</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">kin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"m"</span>, <span class="st">"gm"</span>, <span class="st">"ggm"</span>, <span class="st">"s"</span>, <span class="st">"a"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">kin</span>, <span class="va">age_focal</span>, <span class="va">sex_kin</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count_living</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age_focal</span>, <span class="va">count</span>, linetype<span class="op">=</span><span class="va">type</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">kin</span><span class="op">)</span>, rows<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">sex_kin</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reference_TwoSex_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="approximations">4. Approximations<a class="anchor" aria-label="anchor" href="#approximations"></a>
</h3>
<p>Caswell <span class="citation">(2022)</span> introduced two
approaches for approximating two-sex kinship structures for cases when
male demographic rates are not available. The first is the
<em>androgynous</em> approximation, which assumes equal fertility and
survival for males and females. The second is the use of <em>GKP
factors</em> apply to each type of relative (e.g., multiplying mothers
by two to obtain the number of mothers and fathers).</p>
<p>Here, we present a visual evaluation of the accuracy of these
approximations by comparing to ‘true’ two-sex models using the French
data included with <code>DemoKin</code> for time-invariant models <span class="citation">(Caswell 2022)</span>. We start by considering the
androgynous approximation. We compare expected kin counts by age and
find high levels of consistency for all kin types, except for
grandfathers and great-grandfathers:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kin2sex.html">kin2sex</a></span><span class="op">(</span><span class="va">fra_surv_f</span>, <span class="va">fra_surv_m</span>, <span class="va">fra_fert_f</span>, <span class="va">fra_fert_m</span>, sex_focal <span class="op">=</span> <span class="st">"f"</span>, birth_female <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kin_out_androgynous</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kin2sex.html">kin2sex</a></span><span class="op">(</span><span class="va">fra_surv_f</span>, <span class="va">fra_surv_f</span>, <span class="va">fra_fert_f</span>, <span class="va">fra_fert_f</span>, sex_focal <span class="op">=</span> <span class="st">"f"</span>, birth_female <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">kin_out</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span>,</span>
<span>  <span class="va">kin_out_androgynous</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"androgynous"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">kin</span>, <span class="va">age_focal</span>, <span class="va">sex_kin</span>, <span class="va">type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count_living</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age_focal</span>, <span class="va">count</span>, linetype <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>row <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">sex_kin</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">kin</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reference_TwoSex_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>Next, we consider the use of GKP factors and find that it also
approximates relatively accurately kin counts at different ages of
Focal. These are presented as examples only. Users are invited to
perform more rigorous comparisons of these approximations.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># with gkp</span></span>
<span><span class="va">kin_out_1sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kin.html">kin</a></span><span class="op">(</span><span class="va">fra_surv_f</span>, <span class="va">fra_fert_f</span>, birth_female <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kin_out_GKP</span> <span class="op">&lt;-</span> <span class="va">kin_out_1sex</span><span class="op">$</span><span class="va">kin_summary</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>count_living <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">kin</span> <span class="op">==</span> <span class="st">"m"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">2</span>,</span>
<span>                            <span class="va">kin</span> <span class="op">==</span> <span class="st">"gm"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">4</span>,</span>
<span>                            <span class="va">kin</span> <span class="op">==</span> <span class="st">"ggm"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">8</span>,</span>
<span>                            <span class="va">kin</span> <span class="op">==</span> <span class="st">"d"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">2</span>,</span>
<span>                            <span class="va">kin</span> <span class="op">==</span> <span class="st">"gd"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">4</span>,</span>
<span>                            <span class="va">kin</span> <span class="op">==</span> <span class="st">"ggd"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">4</span>,</span>
<span>                            <span class="va">kin</span> <span class="op">==</span> <span class="st">"oa"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">4</span>,</span>
<span>                            <span class="va">kin</span> <span class="op">==</span> <span class="st">"ya"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">4</span>,</span>
<span>                            <span class="va">kin</span> <span class="op">==</span> <span class="st">"os"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">2</span>,</span>
<span>                            <span class="va">kin</span> <span class="op">==</span> <span class="st">"ys"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">2</span>,</span>
<span>                            <span class="va">kin</span> <span class="op">==</span> <span class="st">"coa"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">8</span>,</span>
<span>                            <span class="va">kin</span> <span class="op">==</span> <span class="st">"cya"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">8</span>,</span>
<span>                            <span class="va">kin</span> <span class="op">==</span> <span class="st">"nos"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">4</span>,</span>
<span>                            <span class="va">kin</span> <span class="op">==</span> <span class="st">"nys"</span> <span class="op">~</span> <span class="va">count_living</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">kin_out</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span>,</span>
<span>  <span class="va">kin_out_androgynous</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"androgynous"</span><span class="op">)</span>,</span>
<span>  <span class="va">kin_out_GKP</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"gkp"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>kin <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">kin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ys"</span>, <span class="st">"os"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"s"</span>,</span>
<span>                          <span class="va">kin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ya"</span>, <span class="st">"oa"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"a"</span>,</span>
<span>                          <span class="va">kin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coa"</span>, <span class="st">"cya"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"c"</span>,</span>
<span>                          <span class="va">kin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nys"</span>, <span class="st">"nos"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"n"</span>,</span>
<span>                          <span class="cn">T</span> <span class="op">~</span> <span class="va">kin</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">age_focal</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">15</span>, <span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">80</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">kin</span>, <span class="va">age_focal</span>, <span class="va">type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count_living</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">type</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">kin</span><span class="op">)</span>, row <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">age_focal</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reference_TwoSex_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="causes-of-death">2. Causes of death<a class="anchor" aria-label="anchor" href="#causes-of-death"></a>
</h3>
<p>Now assume we have two causes of death (COD). For females, the risk
of the first COD is half the risk of the second COD for ages greater
than 50. For males, the risk of the first COD is 2/3 of the second COD
for ages greater than 50. We operationalize this using two matrices with
dimension 2 by 101 (number of causes by number of ages).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Hf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">.5</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fra_surv_f</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Hm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.33</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fra_surv_f</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Hf</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Hm</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></code></pre></div>
<p>This is a generalization of the approach outlined by Caswell <span class="citation">(2023)</span>. In the original formulation, the inputs
in matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
are the hazard rates. Here, we treat them like a relative risk factor
related to the underlying probability of dying. For more details, see
section 2.3 and formula 30 in section A.1 of Caswell <span class="citation">(2023)</span>. Now we run the time-invariant two-sex
model by COD for France 2012, assuming a death count distribution based
on the two competing causes; note that the <code>kin2sex</code> function
now takes the arguments <code>Hf</code> and <code>Hm</code> but the
other arguments remain unchanged:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_out_cod_invariant</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kin2sex.html">kin2sex</a></span><span class="op">(</span></span>
<span>                      pf <span class="op">=</span> <span class="va">fra_surv_f</span>,</span>
<span>                      pm <span class="op">=</span> <span class="va">fra_surv_m</span>, </span>
<span>                      ff <span class="op">=</span> <span class="va">fra_fert_f</span>, </span>
<span>                      fm <span class="op">=</span> <span class="va">fra_fert_m</span>,</span>
<span>                      Hf <span class="op">=</span> <span class="va">Hf</span>,</span>
<span>                      Hm <span class="op">=</span> <span class="va">Hm</span>,</span>
<span>                      time_invariant <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The output of <code>kin2sex</code> is the the <code>kin_full</code>
data frame that we have encountered before. The only differences is that
<code>kin_full</code> now includes one column for each COD specified in
the input. Therefore, the number of columns will vary depending on how
many COD you are considering!</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kin_out_cod_invariant</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 9</span></span></span>
<span><span class="co">#&gt;   year  cohort age_focal sex_kin kin   age_kin living deadcause1 deadcause2</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>             0 f       d           0      0          0          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>             1 f       d           0      0          0          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>             2 f       d           0      0          0          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>             3 f       d           0      0          0          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>             4 f       d           0      0          0          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>             5 f       d           0      0          0          0</span></span></code></pre></div>
<p>We can now plot the death distribution by age and COD of Focal’s
parents when Focal is 30 yo.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kin_out_cod_invariant</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">kin</span> <span class="op">==</span> <span class="st">"m"</span>, <span class="va">age_focal</span> <span class="op">==</span> <span class="fl">30</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>deadcause1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">deadcause1</span><span class="op">)</span>,</span>
<span>            deadcause2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">deadcause2</span><span class="op">)</span>, .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">age_kin</span>, <span class="va">sex_kin</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">deadcause1</span><span class="op">:</span><span class="va">deadcause2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age_kin</span>, <span class="va">value</span>, col <span class="op">=</span> <span class="va">sex_kin</span>, linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Expected number of parental deaths"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reference_TwoSex_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>In this simplified example, the parents of Focal only died after age
50. This helped highlight the relative difference between the COD for
each sex. Note that the sum of the death counts by sex gives the same
result as the total deaths by sex at that age in the less complex model
(i.e., the one that does not consider COD, see section 2 of this
guide).</p>
<p>You can add as many COD as you want, but keep in mind that this can
be computationally intensive. For time-variant kinship models that
consider COD, you must provide a list of matrices by sex
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">Hf</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">Hm</annotation></semantics></math>).
The elements of this list should be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
matrices for each year (following the same order than the mortality and
fertility components).</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-caswell_formal_2022" class="csl-entry">
Caswell, Hal. 2022. <span>“The Formal Demography of Kinship
<span>IV</span>: <span>Two</span>-Sex Models and Their
Approximations.”</span> <em>Demographic Research</em> 47 (September):
359–96. <a href="https://doi.org/10.4054/DemRes.2022.47.13" class="external-link">https://doi.org/10.4054/DemRes.2022.47.13</a>.
</div>
<div id="ref-Caswell2023" class="csl-entry">
Caswell, Hal, Rachel Margolis, and Ashton Verdery. 2023. <span>“<span class="nocase">The formal demography of kinship V: Kin loss,
bereavement, and causes of death</span>.”</span> <em>Demographic
Research</em> 49 (December): 1163–1200. <a href="https://www.demographic-research.org/articles/volume/49/41" class="external-link">https://www.demographic-research.org/articles/volume/49/41</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Iván Williams, Diego Alburez-Gutierrez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
