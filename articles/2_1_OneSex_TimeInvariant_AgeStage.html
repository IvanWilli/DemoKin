<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>One-sex time-invariant kinship model specified by age and stage • DemoKin</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="One-sex time-invariant kinship model specified by age and stage">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DemoKin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_1_OneSex_TimeInvariant_Age.html">One-sex time-invariant model</a>
    </li>
    <li>
      <a href="../articles/1_2_OneSex_TimeVarying_Age.html">One-sex time-varying model</a>
    </li>
    <li>
      <a href="../articles/1_3_TwoSex_TimeInvariant_Age.html">Two-sex time-invariant model</a>
    </li>
    <li>
      <a href="../articles/1_4_TwoSex_TimeVarying_Age.html">Two-sex time-varying model</a>
    </li>
    <li>
      <a href="../articles/2_1_OneSex_TimeInvariant_AgeStage.html">One-sex time-invariant Age-Stage model</a>
    </li>
    <li>
      <a href="../articles/2_2_TwoSex_TimeVarying_AgeStage.html">Two-sex time-varying Age-Stage model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/IvanWilli/DemoKin" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>One-sex time-invariant kinship model specified
by age and stage</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/IvanWilli/DemoKin/blob/main/vignettes/2_1_OneSex_TimeInvariant_AgeStage.Rmd" class="external-link"><code>vignettes/2_1_OneSex_TimeInvariant_AgeStage.Rmd</code></a></small>
      <div class="hidden name"><code>2_1_OneSex_TimeInvariant_AgeStage.Rmd</code></div>

    </div>

    
    
<style>
/* Make TOC appear on the right side */
.tocify {
  position: fixed;
  top: 50px;
  right: 0;
  width: 240px;
  height: calc(100% - 50px);
  overflow-y: auto;
  margin-left: 0;
  padding-left: 0;
}

/* Adjust main content to make room for right-side TOC */
.main-container {
  max-width: calc(100% - 260px);
  margin-left: 10px;
  margin-right: 250px;
}

/* Limit TOC to only show 2 levels */
.tocify-subheader .tocify-subheader {
  display: none;
}

/* Style for learning objectives box */
.learning-objectives {
  background-color: #e0f7fa;
  border-left: 5px solid #00acc1;
  padding: 15px;
  margin-bottom: 20px;
  border-radius: 3px;
}
</style>
<div class="learning-objectives">
<p><strong>Learning Objectives</strong>: In this vignette, you will
learn how to extend the one-sex kinship model to incorporate stages
alongside age. You will understand the implementation of multi-state
matrix models, explore how demographic processes can vary by stage
(e.g., parity), and analyze how these additional dimensions affect
kinship structures.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In previous vignettes, we explored kinship models where individuals
were classified only by age. However, demographic processes are often
influenced by other characteristics beyond age. For example, mortality
and fertility rates may vary by marital status, education level, health
condition, parity (number of children already born), or other
socioeconomic factors.</p>
<p>Multi-state kinship models address this limitation by incorporating
both age and stage (additional states) in the analysis. These models
allow us to:</p>
<ul>
<li>Account for heterogeneity in mortality and fertility by stage</li>
<li>Track changes in stage over the life course (e.g., transitions
between parity states)</li>
<li>Analyze kin availability by both age and stage</li>
<li>Understand how stage-specific demographic patterns shape family
structures</li>
<li>Provide more nuanced estimates of kinship dynamics</li>
</ul>
<p>In this vignette, we will start from a simple model, <strong>one-sex
time-invariant multi-state kinship model</strong>, outlined in Caswell
<span class="citation">(2020)</span>, using the <code>DemoKin</code>
package. We’ll focus specifically on parity as our stage variable, which
allows us to analyze how fertility history affects kinship networks.</p>
<div class="section level3">
<h3 id="preparation">Package Installation<a class="anchor" aria-label="anchor" href="#preparation"></a>
</h3>
<p>If you haven’t already installed the required packages from the
previous vignettes, here’s what you’ll need:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install basic data analysis packages</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"dplyr"</span><span class="op">)</span>     <span class="co"># Data manipulation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tidyr"</span><span class="op">)</span>     <span class="co"># Data tidying</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span>   <span class="co"># Data visualization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"knitr"</span><span class="op">)</span>     <span class="co"># Document generation</span></span>
<span></span>
<span><span class="co"># Install DemoKin</span></span>
<span><span class="co"># DemoKin is available on CRAN (https://cran.r-project.org/web/packages/DemoKin/index.html), </span></span>
<span><span class="co"># but we'll use the development version on GitHub (https://github.com/IvanWilli/DemoKin):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"IvanWilli/DemoKin"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/IvanWilli/DemoKin" class="external-link">DemoKin</a></span><span class="op">)</span>  <span class="co"># For kinship analysis</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="load-packages">Setting Up the Analysis Environment<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h2>
<p>Let’s load the necessary packages for our analysis:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>    <span class="co"># For data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>    <span class="co"># For restructuring data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>  <span class="co"># For visualization</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>    <span class="co"># For document generation</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="multi-state-models">Multi-State Kinship Models<a class="anchor" aria-label="anchor" href="#multi-state-models"></a>
</h2>
<div class="section level3">
<h3 id="understanding-stage-models">Understanding Stage-Structured Models<a class="anchor" aria-label="anchor" href="#understanding-stage-models"></a>
</h3>
<p>In traditional age-structured models, an individual’s demographic
rates depend only on their age. In multi-state models, we expand this
framework to consider both age and stage, where “stage” represents
another characteristic that influences demographic processes.</p>
<p>Key components of multi-state models include:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Age-and-stage-specific mortality rates</strong>: How
survival probabilities vary by both age and stage</li>
<li>
<strong>Age-and-stage-specific fertility rates</strong>: How
fertility varies by both age and stage</li>
<li>
<strong>Age-specific transition probabilities</strong>: How
individuals move between stages at each age</li>
</ol>
<p>These components allow us to build more realistic models of
population dynamics and kinship networks by accounting for heterogeneity
beyond age.</p>
</div>
<div class="section level3">
<h3 id="parity-models">Parity as a Stage Variable<a class="anchor" aria-label="anchor" href="#parity-models"></a>
</h3>
<p>In this vignette, we’ll focus on <strong>parity</strong> (the number
of children already born to a woman) as our stage variable. Parity is
particularly relevant for kinship studies because:</p>
<ul>
<li>Fertility rates often vary substantially by parity</li>
<li>A woman’s ultimate family size affects her kinship network</li>
<li>Parity transitions follow clear rules (can only increase by integer
values)</li>
<li>Parity status can influence other demographic processes like
mortality</li>
</ul>
<p>The <code>DemoKin</code> package includes data from Slovakia in 1980,
which we’ll use to implement a parity-based kinship model.</p>
</div>
<div class="section level3">
<h3 id="data-structure">Understanding the Data Structure<a class="anchor" aria-label="anchor" href="#data-structure"></a>
</h3>
<p>For multi-state models, we need several matrices that specify how
demographic rates vary by both age and stage. Let’s examine the
structure of the Slovakia data included in the <code>DemoKin</code>
package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine fertility rates by age and parity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">svk_fxs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     1 2 3 4 5 6</span></span>
<span><span class="co">## out 0 0 0 0 0 0</span></span>
<span><span class="co">## elt 0 0 0 0 0 0</span></span>
<span><span class="co">## elt 0 0 0 0 0 0</span></span>
<span><span class="co">## elt 0 0 0 0 0 0</span></span>
<span><span class="co">## elt 0 0 0 0 0 0</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine survival probabilities by age and parity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">svk_pxs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            1       2       3       4       5       6</span></span>
<span><span class="co">## [1,] 0.98267 0.98267 0.98267 0.98267 0.98267 0.98267</span></span>
<span><span class="co">## [2,] 0.99858 0.99858 0.99858 0.99858 0.99858 0.99858</span></span>
<span><span class="co">## [3,] 0.99928 0.99928 0.99928 0.99928 0.99928 0.99928</span></span>
<span><span class="co">## [4,] 0.99962 0.99962 0.99962 0.99962 0.99962 0.99962</span></span>
<span><span class="co">## [5,] 0.99979 0.99979 0.99979 0.99979 0.99979 0.99979</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine birth matrix (where newborns enter the population)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">svk_Hxs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     1 2 3 4 5 6</span></span>
<span><span class="co">## out 1 1 1 1 1 1</span></span>
<span><span class="co">## elt 0 0 0 0 0 0</span></span>
<span><span class="co">## elt 0 0 0 0 0 0</span></span>
<span><span class="co">## elt 0 0 0 0 0 0</span></span>
<span><span class="co">## elt 0 0 0 0 0 0</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Look at the structure of the transition matrices</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html" class="external-link">typeof</a></span><span class="op">(</span><span class="va">svk_Uxs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "list"</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">svk_Uxs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 110</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svk_Uxs</span><span class="op">[[</span><span class="fl">20</span><span class="op">]</span><span class="op">]</span>  <span class="co"># Transition matrix for age 20</span></span></code></pre></div>
<pre><code><span><span class="co">##           [,1]      [,2]      [,3]      [,4]      [,5] [,6]</span></span>
<span><span class="co">## [1,] 0.8263006 0.0000000 0.0000000 0.0000000 0.0000000    0</span></span>
<span><span class="co">## [2,] 0.1736994 0.8050297 0.0000000 0.0000000 0.0000000    0</span></span>
<span><span class="co">## [3,] 0.0000000 0.1949703 0.8794961 0.0000000 0.0000000    0</span></span>
<span><span class="co">## [4,] 0.0000000 0.0000000 0.1205039 0.8455037 0.0000000    0</span></span>
<span><span class="co">## [5,] 0.0000000 0.0000000 0.0000000 0.1544963 0.8157141    0</span></span>
<span><span class="co">## [6,] 0.0000000 0.0000000 0.0000000 0.0000000 0.1842859    1</span></span></code></pre>
<p>In this dataset:</p>
<ul>
<li>
<code>svk_fxs</code> is a data frame of fertility rates by age
(rows) and parity stage (columns)</li>
<li>
<code>svk_pxs</code> contains survival probabilities by age and
parity</li>
<li>
<code>svk_Hxs</code> specifies where newborns enter the population
(in this case, at parity 0)</li>
<li>
<code>svk_Uxs</code> is a list of matrices, one for each age,
containing the probabilities of transitioning between parity states
conditional on survival</li>
</ul>
<p>For parity, the stages represent:</p>
<ul>
<li>Stage 1: Parity 0 (no children)</li>
<li>Stage 2: Parity 1 (one child)</li>
<li>Stage 3: Parity 2 (two children)</li>
<li>Stage 4: Parity 3 (three children)</li>
<li>Stage 5: Parity 4 (four children)</li>
<li>Stage 6: Parity 5+ (five or more children)</li>
</ul>
<p>Let’s examine the transition matrix for a woman of reproductive age
to understand how women move between parity states:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the transition matrix for age 25</span></span>
<span><span class="co"># This shows probabilities of moving between parity states</span></span>
<span><span class="va">svk_Uxs</span><span class="op">[[</span><span class="fl">25</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##           [,1]      [,2]       [,3]       [,4]      [,5] [,6]</span></span>
<span><span class="co">## [1,] 0.8180248 0.0000000 0.00000000 0.00000000 0.0000000    0</span></span>
<span><span class="co">## [2,] 0.1819752 0.7593786 0.00000000 0.00000000 0.0000000    0</span></span>
<span><span class="co">## [3,] 0.0000000 0.2406214 0.91107756 0.00000000 0.0000000    0</span></span>
<span><span class="co">## [4,] 0.0000000 0.0000000 0.08892244 0.92006759 0.0000000    0</span></span>
<span><span class="co">## [5,] 0.0000000 0.0000000 0.00000000 0.07993241 0.8674747    0</span></span>
<span><span class="co">## [6,] 0.0000000 0.0000000 0.00000000 0.00000000 0.1325253    1</span></span></code></pre>
<p>This matrix shows the probabilities of moving from one parity state
(columns) to another (rows) for a 25-year-old woman, conditional on
survival. Some key observations:</p>
<ul>
<li>The matrix shows transitions from column j (starting parity) to row
i (ending parity)</li>
<li>The diagonal elements represent the probability of remaining in the
same parity state</li>
<li>Non-zero values appear only in the lower-triangular portion because
parity can only increase (women can’t “un-have” children)</li>
<li>Women at higher parities generally have lower probabilities of
having another child</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="run-model-multi-state">Implementing the Multi-State Model<a class="anchor" aria-label="anchor" href="#run-model-multi-state"></a>
</h2>
<p>Now let’s implement the multi-state kinship model using the
<code>kin_multi_stage</code> function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use birth_female=1 because fertility is for females only</span></span>
<span><span class="va">demokin_svk1980_caswell2020</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/kin_multi_stage.html">kin_multi_stage</a></span><span class="op">(</span></span>
<span>    U <span class="op">=</span> <span class="va">svk_Uxs</span>,            <span class="co"># List of transition matrices</span></span>
<span>    f <span class="op">=</span> <span class="va">svk_fxs</span>,            <span class="co"># Fertility rates by age and parity</span></span>
<span>    D <span class="op">=</span> <span class="va">svk_pxs</span>,            <span class="co"># Survival probabilities by age and parity</span></span>
<span>    H <span class="op">=</span> <span class="va">svk_Hxs</span>,            <span class="co"># Birth matrix</span></span>
<span>    birth_female <span class="op">=</span> <span class="fl">1</span>,       <span class="co"># All births are female (one-sex model)</span></span>
<span>    parity <span class="op">=</span> <span class="cn">TRUE</span>           <span class="co"># Stages represent parity states</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>This function computes the joint age-parity distribution of kin for a
focal individual under the specified demographic conditions. The output
includes information on both the age and parity state of each
relative.</p>
</div>
<div class="section level2">
<h2 id="age-and-parity-distribution">Analyzing Age and Parity Distributions<a class="anchor" aria-label="anchor" href="#age-and-parity-distribution"></a>
</h2>
<p>Let’s examine how both age and parity are distributed among
relatives. First, we’ll look at the age-parity distribution of aunts
when the focal individual is 20 and 60 years old:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demokin_svk1980_caswell2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">kin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"oa"</span>,<span class="st">"ya"</span><span class="op">)</span>, <span class="va">age_focal</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>parity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">stage_kin</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,</span>
<span>         parity <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">parity</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">~</span> <span class="st">"5+"</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">parity</span><span class="op">)</span><span class="op">)</span></span>
<span>         <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age_focal</span>, <span class="va">age_kin</span>, <span class="va">parity</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">living</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age_kin</span>, y <span class="op">=</span> <span class="va">count</span>, fill <span class="op">=</span> <span class="va">parity</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">age_focal</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Age and parity distribution of aunts"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Slovakia, 1980"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age of aunt"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of aunts"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Parity"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">age_focal</span>, nrow <span class="op">=</span> <span class="fl">2</span>, labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span></span>
<span>    age_focal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"20"</span> <span class="op">=</span> <span class="st">"Focal age: 20"</span>, <span class="st">"60"</span> <span class="op">=</span> <span class="st">"Focal age: 60"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_1_OneSex_TimeInvariant_AgeStage_files/figure-html/unnamed-chunk-2-1.png" width="3000" style="display: block; margin: auto;"></p>
<p><strong>Interpretation</strong>: These bar charts show the joint
distribution of age and parity for aunts at two different focal
ages:</p>
<ul>
<li>
<strong>When Focal is 20</strong> (upper panel): Aunts are mostly
middle-aged (30s-50s) and concentrated in parities 2-3, reflecting the
fertility patterns of that generation</li>
<li>
<strong>When Focal is 60</strong> (lower panel): Aunts are much
older (if still alive) and show a similar parity distribution, though
with more high-parity individuals due to the fertility patterns of
earlier cohorts</li>
</ul>
<p>The red vertical line indicates Focal’s age, providing a reference
point for comparing the ages of relatives. This joint distribution
provides richer information than looking at age or parity alone.</p>
</div>
<div class="section level2">
<h2 id="kin-by-parity">Kin Counts by Parity Over the Life Course<a class="anchor" aria-label="anchor" href="#kin-by-parity"></a>
</h2>
<p>Now let’s examine how the parity distribution of different types of
relatives changes over Focal’s life course. We’ll focus on daughters and
mothers:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demokin_svk1980_caswell2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">kin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>,<span class="st">"m"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>parity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">stage_kin</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,</span>
<span>         parity <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">parity</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">~</span> <span class="st">"5+"</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">parity</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age_focal</span>, <span class="va">kin</span>, <span class="va">parity</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">living</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">DemoKin</span><span class="fu">::</span><span class="fu"><a href="../reference/rename_kin.html">rename_kin</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age_focal</span>, y <span class="op">=</span> <span class="va">count</span>, fill <span class="op">=</span> <span class="va">parity</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Parity distribution of mothers and daughters over the life course"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Slovakia, 1980"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age of focal individual"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of relatives"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Parity"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">kin_label</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_1_OneSex_TimeInvariant_AgeStage_files/figure-html/unnamed-chunk-3-1.png" width="3000" style="display: block; margin: auto;"></p>
<p><strong>Interpretation</strong>: These stacked bar charts reveal how
the parity distribution of mothers and daughters evolves across Focal’s
life course:</p>
<ul>
<li>
<strong>Mothers</strong>:
<ul>
<li>Most mothers are in parity 2-3, reflecting the dominant family size
in this population</li>
<li>At Focal’s birth (age 0), mothers are necessarily at parity 1 or
higher (as they must have at least one child - the Focal
individual)</li>
<li>The mothers’ parity distribution shows a gradual shift toward higher
parities when Focal is young, as some mothers continue to have
additional children</li>
<li>The composition is relatively stable after Focal reaches adulthood,
with slight changes due to differential mortality by parity</li>
</ul>
</li>
<li>
<strong>Daughters</strong>:
<ul>
<li>Initially all daughters are in parity 0 (childless)</li>
<li>As Focal ages, daughters transition to higher parity states</li>
<li>By the time Focal reaches old age, the parity distribution of
daughters resembles the overall population pattern</li>
<li>The total number increases until Focal’s reproductive years end,
then remains stable</li>
</ul>
</li>
</ul>
<p>These patterns highlight the intergenerational transmission of
fertility behaviors and how demographic patterns ripple through kinship
networks.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this vignette, we’ve explored how to implement one-sex
time-invariant multi-state kinship models using the <code>DemoKin</code>
package. By incorporating both age and stage (parity) in our analysis,
we’ve gained richer insights into the structure of kinship networks than
would be possible with age alone.</p>
<p>Key insights include:</p>
<ol style="list-style-type: decimal">
<li>Demographic processes vary not only by age but also by other
characteristics like parity</li>
<li>Multi-state models allow us to track the joint distribution of age
and stage among relatives</li>
<li>The parity distribution of relatives evolves in complex ways over
the life course</li>
<li>Stage transitions (e.g., between parity states) are a key component
of kinship dynamics</li>
</ol>
<p>While we focused on parity in this vignette, the
<code>kin_multi_stage</code> function can be used for any state variable
by setting the parameter <code>parity = FALSE</code> (the default). This
flexibility opens up numerous applications:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Health status transitions</strong>: Analyzing how health
conditions affect and are affected by kinship networks</li>
<li>
<strong>Educational attainment</strong>: Exploring how education
levels influence family formation and structure</li>
<li>
<strong>Marital status</strong>: Incorporating marriage, divorce,
and widowhood into kinship dynamics</li>
<li>
<strong>Geographical location</strong>: Modeling proximity and
migration within kinship networks</li>
<li>
<strong>Labor force participation</strong>: Understanding how work
patterns interact with family structures</li>
</ol>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-caswell_formal_2020" class="csl-entry">
Caswell, Hal. 2020. <span>“The Formal Demography of Kinship
<span>II</span>: <span>Multistate</span> Models, Parity, and
Sibship.”</span> <em>Demographic Research</em> 42 (June): 1097–1146. <a href="https://doi.org/10.4054/DemRes.2020.42.38" class="external-link">https://doi.org/10.4054/DemRes.2020.42.38</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Iván Williams, Diego Alburez-Gutierrez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
