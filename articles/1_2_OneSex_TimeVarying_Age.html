<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>One-sex time-varying kinship model specified by age • DemoKin</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="One-sex time-varying kinship model specified by age">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DemoKin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_1_OneSex_TimeInvariant_Age.html">One-sex time-invariant model</a>
    </li>
    <li>
      <a href="../articles/1_2_OneSex_TimeVarying_Age.html">One-sex time-varying model</a>
    </li>
    <li>
      <a href="../articles/1_3_TwoSex_TimeInvariant_Age.html">Two-sex time-invariant model</a>
    </li>
    <li>
      <a href="../articles/1_4_TwoSex_TimeVarying_Age.html">Two-sex time-varying model</a>
    </li>
    <li>
      <a href="../articles/2_1_OneSex_TimeInvariant_AgeStage.html">One-sex time-invariant Age-Stage model</a>
    </li>
    <li>
      <a href="../articles/2_2_TwoSex_TimeVarying_AgeStage.html">Two-sex time-varying Age-Stage model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/0_0_Papers.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/IvanWilli/DemoKin" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>One-sex time-varying kinship model specified by
age</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/IvanWilli/DemoKin/blob/main/vignettes/1_2_OneSex_TimeVarying_Age.Rmd" class="external-link"><code>vignettes/1_2_OneSex_TimeVarying_Age.Rmd</code></a></small>
      <div class="hidden name"><code>1_2_OneSex_TimeVarying_Age.Rmd</code></div>

    </div>

    
    
<style>
/* Make TOC appear on the right side */
.tocify {
  position: fixed;
  top: 50px;
  right: 0;
  width: 240px;
  height: calc(100% - 50px);
  overflow-y: auto;
  margin-left: 0;
  padding-left: 0;
}

/* Adjust main content to make room for right-side TOC */
.main-container {
  max-width: calc(100% - 260px);
  margin-left: 10px;
  margin-right: 250px;
}

/* Limit TOC to only show 2 levels */
.tocify-subheader .tocify-subheader {
  display: none;
}

/* Style for learning objectives box */
.learning-objectives {
  background-color: #e0f7fa;
  border-left: 5px solid #00acc1;
  padding: 15px;
  margin-bottom: 20px;
  border-radius: 3px;
}
</style>
<div class="learning-objectives">
<p><strong>Learning Objectives</strong>: In this vignette, you will
learn how to extend the DemoKin time-invariant model to incorporate
changing demographic rates over time. You will understand how to
implement a time-varying kinship model, examine the impact of
demographic change on kinship networks, and analyze related phenomena
such as kin loss and prevalence of specific conditions among kin.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>While the time-invariant model we explored in the previous vignette
provides valuable insights into kinship structures, it has one
significant limitation: it assumes demographic conditions remain
constant throughout a person’s life. In reality, mortality and fertility
rates evolve dramatically over time due to socioeconomic development,
medical advances, and cultural shifts.</p>
<p>Time-varying kinship models address this limitation by incorporating
historical demographic changes, offering a more nuanced and realistic
picture of family networks. These advanced models allow us to:</p>
<ul>
<li>Track kinship networks for specific birth cohorts across their life
course</li>
<li>Account for the different demographic conditions experienced by each
generation</li>
<li>Provide more accurate estimates of kin availability in specific
historical periods</li>
<li>Better understand how demographic transitions shape family
structures</li>
</ul>
<p>In this vignette, we will implement a <strong>one-sex time-varying
model</strong>, outlined in Caswell and Song <span class="citation">(2021)</span>, using the <code>DemoKin</code> package.
We build on the time-invariant approach but incorporate year-specific
mortality and fertility rates to model the kinship networks of
individuals born in specific years.</p>
<div class="section level3">
<h3 id="preparation">Package Installation<a class="anchor" aria-label="anchor" href="#preparation"></a>
</h3>
<p>If you haven’t already installed the required packages from the
previous vignette, here’s what you’ll need:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install basic data analysis packages</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"dplyr"</span><span class="op">)</span>     <span class="co"># Data manipulation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tidyr"</span><span class="op">)</span>     <span class="co"># Data tidying</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span>   <span class="co"># Data visualization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"knitr"</span><span class="op">)</span>     <span class="co"># Document generation</span></span>
<span></span>
<span><span class="co"># Install DemoKin</span></span>
<span><span class="co"># DemoKin is available on CRAN (https://cran.r-project.org/web/packages/DemoKin/index.html), </span></span>
<span><span class="co"># but we'll use the development version on GitHub (https://github.com/IvanWilli/DemoKin):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"IvanWilli/DemoKin"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/IvanWilli/DemoKin" class="external-link">DemoKin</a></span><span class="op">)</span>  <span class="co"># For kinship analysis</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="load-packages">Setting Up the Analysis Environment<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h2>
<p>Let’s load the necessary packages for our analysis:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>    <span class="co"># For data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>    <span class="co"># For restructuring data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>  <span class="co"># For visualization</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>    <span class="co"># For document generation</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="time-varying-models">Time-Varying Kinship Models<a class="anchor" aria-label="anchor" href="#time-varying-models"></a>
</h2>
<div class="section level3">
<h3 id="the-conceptual-shift">The Conceptual Shift<a class="anchor" aria-label="anchor" href="#the-conceptual-shift"></a>
</h3>
<p>In the time-invariant model, we assumed that everyone experiences the
same mortality and fertility rates throughout their lives (e.g., the
2015 rates). However, this is a simplification of reality. Demographic
rates change over time, often dramatically:</p>
<ul>
<li>A woman born in 1900 would have experienced very different mortality
risks at age 20 (in 1920) than a woman born in 1950 would have at age 20
(in 1970)</li>
<li>Similarly, fertility patterns have shifted substantially over
generations</li>
</ul>
<p>Time-varying models account for these historical changes by using
year-specific demographic rates. They provide a more realistic picture
of kinship dynamics for specific birth cohorts as they age through
changing demographic conditions.</p>
</div>
<div class="section level3">
<h3 id="data-requirements">Data Requirements<a class="anchor" aria-label="anchor" href="#data-requirements"></a>
</h3>
<p>For time-varying models, instead of vectors of rates for a single
year, we need:</p>
<ol style="list-style-type: decimal">
<li>
<p>A matrix of survival probabilities, with:</p>
<ul>
<li>Rows representing ages (0, 1, 2, …, 100+)</li>
<li>Columns representing years (e.g., 1950, 1951, …, 2020)</li>
</ul>
</li>
<li><p>A matrix of fertility rates with the same dimensions</p></li>
<li><p>A matrix of population counts (optional, for certain
calculations)</p></li>
</ol>
<p>The <code>DemoKin</code> package includes Swedish data in this
format, which we’ll use for our example.</p>
</div>
<div class="section level3">
<h3 id="run-the-model-time-varying">Implementing the Time-Varying Model<a class="anchor" aria-label="anchor" href="#run-the-model-time-varying"></a>
</h3>
<p>Let’s implement a time-varying kinship model for women born in 1960
in Sweden. We’ll focus on specific kin types to make interpretation
easier:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">swe_time_varying</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/kin.html">kin</a></span><span class="op">(</span></span>
<span>    p <span class="op">=</span> <span class="va">swe_px</span>,              <span class="co"># Matrix of survival probabilities by age and year</span></span>
<span>    f <span class="op">=</span> <span class="va">swe_asfr</span>,            <span class="co"># Matrix of fertility rates by age and year</span></span>
<span>    n <span class="op">=</span> <span class="va">swe_pop</span>,             <span class="co"># Matrix of population counts by age and year</span></span>
<span>    time_invariant <span class="op">=</span> <span class="cn">FALSE</span>,  <span class="co"># Use time-varying model</span></span>
<span>    output_cohort <span class="op">=</span> <span class="fl">1960</span>,    <span class="co"># Focus on the 1960 birth cohort</span></span>
<span>    output_kin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d"</span>,<span class="st">"gd"</span>,<span class="st">"ggd"</span>,<span class="st">"m"</span>,<span class="st">"gm"</span>,<span class="st">"ggm"</span><span class="op">)</span>  <span class="co"># Select specific kin types</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>In this model: - We use the full matrices of Swedish demographic data
(<code>swe_px</code>, <code>swe_asfr</code>, <code>swe_pop</code>) - We
set <code>time_invariant = FALSE</code> to implement a time-varying
model - We specify <code>output_cohort = 1960</code> to focus on women
born in 1960 - We select specific relatives to analyze (daughters,
granddaughters, great-granddaughters, mothers, grandmothers, and
great-grandmothers)</p>
</div>
<div class="section level3">
<h3 id="living-relatives">Living Relatives Across the Life Course<a class="anchor" aria-label="anchor" href="#living-relatives"></a>
</h3>
<p>Let’s examine how the number of living kin changes throughout the
life course for the 1960 birth cohort:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">swe_time_varying</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age_focal</span>, <span class="va">count_living</span>, color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cohort</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">""</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span>,<span class="fl">.2</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span>,<span class="fl">.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">35</span>, color<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Expected number of living relatives for the 1960 birth cohort"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Swedish demographic rates, time-varying model"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age of focal individual"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Expected number of living relatives"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">kin</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="1_2_OneSex_TimeVarying_Age_files/figure-html/unnamed-chunk-2-1.png" width="2400" style="display: block; margin: auto;"></p>
<p><strong>Interpretation</strong>: These plots show how the expected
number of living relatives changes as the 1960 cohort ages:</p>
<ul>
<li>
<strong>Mothers (m)</strong>: Starts near 1.0 and gradually declines
as mothers die</li>
<li>
<strong>Grandmothers (gm)</strong>: Already well below 1.0 at birth,
reflecting pre-1960 mortality, then declining rapidly</li>
<li>
<strong>Great-grandmothers (ggm)</strong>: Very few at birth,
quickly disappearing</li>
<li>
<strong>Daughters (d)</strong>: Increasing during reproductive
years, reflecting fertility patterns of the 1980s-2000s</li>
<li>
<strong>Granddaughters (gd)</strong>: Appearing as daughters reach
reproductive age, reflecting fertility of the 2000s-2030s</li>
<li>
<strong>Great-granddaughters (ggd)</strong>: Beginning to appear in
later years</li>
</ul>
<p>The red vertical line at age 35 provides a reference point to compare
kin counts at a specific age. Unlike the time-invariant model, these
counts reflect the actual historical demographic conditions experienced
by this cohort and their relatives.</p>
</div>
<div class="section level3">
<h3 id="kin-loss">Analyzing Kin Loss<a class="anchor" aria-label="anchor" href="#kin-loss"></a>
</h3>
<p>Beyond counting living kin, we can also examine patterns of kin
mortality. Understanding kin loss is important because it:</p>
<ul>
<li>Has psychological and social consequences for bereaved
individuals</li>
<li>Affects the availability of support and care across generations</li>
<li>Influences patterns of inheritance and resource transfers</li>
</ul>
<p>Let’s examine the cumulative number of deceased relatives by age for
our 1960 birth cohort:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">swe_time_varying</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age_focal</span>, <span class="va">count_cum_dead</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Cumulative number of deceased relatives by age"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"1960 birth cohort, Sweden"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age of focal individual"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Expected number of deceased relatives"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">kin</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="1_2_OneSex_TimeVarying_Age_files/figure-html/unnamed-chunk-3-1.png" width="2400" style="display: block; margin: auto;"></p>
<p><strong>Interpretation</strong>: These graphs show the cumulative
number of deaths experienced by kin type:</p>
<ul>
<li>
<strong>Ascending relatives</strong>: Deaths accumulate gradually
for mothers, and more rapidly for grandmothers and
great-grandmothers</li>
<li>
<strong>Descending relatives</strong>: Deaths are rare but do occur,
representing the tragedy of losing children, grandchildren, or
great-grandchildren</li>
</ul>
<p>We can also examine the mean age at which relatives die. For a
50-year-old woman born in 1960:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">swe_time_varying</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">age_focal</span> <span class="op">==</span> <span class="fl">50</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">kin</span>, <span class="va">count_cum_dead</span>, <span class="va">mean_age_lost</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">kin</th>
<th align="right">count_cum_dead</th>
<th align="right">mean_age_lost</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">d</td>
<td align="right">0.01</td>
<td align="right">32.59</td>
</tr>
<tr class="even">
<td align="left">gd</td>
<td align="right">0.00</td>
<td align="right">47.13</td>
</tr>
<tr class="odd">
<td align="left">ggd</td>
<td align="right">0.00</td>
<td align="right">49.66</td>
</tr>
<tr class="even">
<td align="left">ggm</td>
<td align="right">0.22</td>
<td align="right">8.94</td>
</tr>
<tr class="odd">
<td align="left">gm</td>
<td align="right">0.84</td>
<td align="right">24.96</td>
</tr>
<tr class="even">
<td align="left">m</td>
<td align="right">0.32</td>
<td align="right">37.83</td>
</tr>
</tbody>
</table>
<p>This table shows both the expected number of deceased relatives and
the mean age at which they died. For example, by age 50, a woman born in
1960 would have lost approximately 0.32 mothers and the age at which
such women lost mother is around 37.83 years-old on average.</p>
</div>
<div class="section level3">
<h3 id="prevelances">Prevalence Calculations<a class="anchor" aria-label="anchor" href="#prevelances"></a>
</h3>
<p>Beyond simple counts, we can combine kinship data with prevalence
rates by age to estimate the number of kin with specific
characteristics. This approach, based on the Sullivan Method, allows us
to:</p>
<ul>
<li>Estimate relatives with specific health conditions</li>
<li>Calculate working-age vs. dependent kin</li>
<li>Project care needs or support capacity within family networks</li>
</ul>
<p>Let’s create a hypothetical prevalence vector that increases
exponentially with age (which might represent a condition like
dementia):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a prevalence vector that increases exponentially with age</span></span>
<span><span class="va">swe_prevalence</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    age_kin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">swe_time_varying</span><span class="op">$</span><span class="va">kin_full</span><span class="op">$</span><span class="va">age_kin</span><span class="op">)</span>,</span>
<span>    prev <span class="op">=</span> <span class="fl">.005</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">.05</span> <span class="op">*</span> <span class="va">age_kin</span><span class="op">)</span>  <span class="co"># Exponential increase with age</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine with kinship data and calculate counts</span></span>
<span><span class="va">swe_time_varying</span><span class="op">$</span><span class="va">kin_full</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">swe_prevalence</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">kin</span>, <span class="va">age_focal</span>, <span class="va">cohort</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    prevalent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">living</span> <span class="op">*</span> <span class="va">prev</span><span class="op">)</span>,        <span class="co"># Kin with the condition</span></span>
<span>    no_prevalent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">living</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">prev</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Kin without the condition</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">prevalent</span><span class="op">:</span><span class="va">no_prevalent</span>, names_to <span class="op">=</span> <span class="st">"prevalence_state"</span>, values_to <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">age_focal</span>, y <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">prevalence_state</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Expected number of relatives with and without the condition"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Based on age-specific prevalence rates"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age of focal individual"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of living relatives"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Condition status"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">kin</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="1_2_OneSex_TimeVarying_Age_files/figure-html/unnamed-chunk-5-1.png" width="3000" style="display: block; margin: auto;"></p>
<p><strong>Interpretation</strong>: The stacked area plots show the
expected number of relatives with and without the hypothetical condition
at each age of Focal:</p>
<ul>
<li>For older relatives (mothers, grandmothers), the proportion with the
condition increases as Focal ages, reflecting the age-related nature of
the condition</li>
<li>For younger relatives (daughters, granddaughters), the prevalence
remains low, consistent with the age pattern of the condition</li>
<li>We can see both the changing total number of relatives and the
changing composition by condition status</li>
</ul>
<p>This approach can be extended to any age-specific prevalence, such
as:</p>
<ul>
<li>Health conditions (disability, chronic disease)</li>
<li>Employment status</li>
<li>Educational attainment</li>
<li>Living arrangements</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this vignette, we’ve explored how to implement time-varying
kinship models using the <code>DemoKin</code> package, expanding our
analytical approach to incorporate historical demographic change.</p>
<p>The time-varying approach offers several advantages over
time-invariant models: 1. <strong>Historical accuracy</strong>: It
incorporates actual demographic changes rather than assuming constant
rates 2. <strong>Cohort specificity</strong>: It can model specific
birth cohorts experiencing their unique demographic conditions 3.
<strong>Period effects</strong>: It captures major demographic events
like wars, pandemics, or baby booms</p>
<p>These methodological improvements allow us to uncover important
substantive insights:</p>
<ul>
<li>How demographic transitions reshape family structures across
generations</li>
<li>The unique kinship experiences of different birth cohorts as they
navigate through changing mortality and fertility regimes</li>
<li>How kin loss and bereavement patterns evolve in response to
mortality improvements</li>
<li>The complex interplay between period and cohort effects in shaping
family networks</li>
</ul>
<p>While time-varying models provide greater realism, time-invariant
models still serve valuable purposes. They offer a simpler baseline for
understanding kinship patterns, can project future kinship structures
based on current demographic conditions, and require less data.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-caswell_formal_2021" class="csl-entry">
Caswell, Hal, and Xi Song. 2021. <span>“The Formal Demography of Kinship
<span>III</span>: <span>Kinship</span> Dynamics with Time-Varying
Demographic Rates.”</span> <em>Demographic Research</em> 45 (August):
517–46. <a href="https://doi.org/10.4054/DemRes.2021.45.16" class="external-link">https://doi.org/10.4054/DemRes.2021.45.16</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Iván Williams, Diego Alburez-Gutierrez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
