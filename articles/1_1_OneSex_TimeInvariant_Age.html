<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>One-sex time-invariant kinship model specified by age • DemoKin</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="One-sex time-invariant kinship model specified by age">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DemoKin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_1_OneSex_TimeInvariant_Age.html">One-sex time-invariant model</a>
    </li>
    <li>
      <a href="../articles/1_2_OneSex_TimeVarying_Age.html">One-sex time-varying model</a>
    </li>
    <li>
      <a href="../articles/1_3_TwoSex_TimeInvariant_Age.html">Two-sex time-invariant model</a>
    </li>
    <li>
      <a href="../articles/1_4_TwoSex_TimeVarying_Age.html">Two-sex time-varying model</a>
    </li>
    <li>
      <a href="../articles/2_1_OneSex_TimeInvariant_AgeStage.html">One-sex time-invariant Age-Stage model</a>
    </li>
    <li>
      <a href="../articles/2_2_TwoSex_TimeVarying_AgeStage.html">Two-sex time-varying Age-Stage model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/IvanWilli/DemoKin" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>One-sex time-invariant kinship model specified
by age</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/IvanWilli/DemoKin/blob/main/vignettes/1_1_OneSex_TimeInvariant_Age.Rmd" class="external-link"><code>vignettes/1_1_OneSex_TimeInvariant_Age.Rmd</code></a></small>
      <div class="hidden name"><code>1_1_OneSex_TimeInvariant_Age.Rmd</code></div>

    </div>

    
    
<style>
/* Make TOC appear on the right side */
.tocify {
  position: fixed;
  top: 50px;
  right: 0;
  width: 240px;
  height: calc(100% - 50px);
  overflow-y: auto;
  margin-left: 0;
  padding-left: 0;
}

/* Adjust main content to make room for right-side TOC */
.main-container {
  max-width: calc(100% - 260px);
  margin-left: 10px;
  margin-right: 250px;
}

/* Limit TOC to only show 2 levels */
.tocify-subheader .tocify-subheader {
  display: none;
}

/* Style for learning objectives box */
.learning-objectives {
  background-color: #e0f7fa;
  border-left: 5px solid #00acc1;
  padding: 15px;
  margin-bottom: 20px;
  border-radius: 3px;
}
</style>
<div class="learning-objectives">
<p><strong>Learning Objectives</strong>: In this tutorial, you will
learn how to use the DemoKin package to analyze kinship networks,
understand the mechanics of one-sex time-invariant models, and visualize
kinship dynamics across the life course.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Kinship is a fundamental property of human populations and a key form
of social structure. Demographers have long been interested in the
interplay between demographic change and family configuration. This has
led to the development of sophisticated methodological and conceptual
approaches for the study of kinship, some of which are explored in this
tutorial.</p>
<p>Kinship analysis can answer a range of important questions:</p>
<ul>
<li>How many relatives might people have at different ages, and what is
the age distribution of these relatives?</li>
<li>How does family structure (both the number and age distribution of
kin) evolve as populations undergo demographic transition?</li>
</ul>
<p>In this tutorial, we will implement matrix kinship models using the
<code>DemoKin</code> package to calculate kin counts and age
distributions. We begin with the simplest model: a
<strong>time-invariant one-sex model</strong>, outlined in Caswell <span class="citation">(2019)</span>. In this model, we assume that everyone
in the population experiences the same mortality and fertility rates
throughout their lives (e.g., the 2015 rates), and we only trace female
kin relationships.</p>
<div class="section level3">
<h3 id="preparation">Preparation<a class="anchor" aria-label="anchor" href="#preparation"></a>
</h3>
<p>Before starting the session, please ensure you complete the following
preparatory steps:</p>
<ol style="list-style-type: decimal">
<li>If you haven’t already, install R and RStudio. This is a useful
tutorial: <a href="https://rstudio-education.github.io/hopr/starting.html" class="external-link uri">https://rstudio-education.github.io/hopr/starting.html</a>
</li>
<li>Install the following packages in R:</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install basic data analysis packages</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"dplyr"</span><span class="op">)</span>     <span class="co"># Data manipulation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tidyr"</span><span class="op">)</span>     <span class="co"># Data tidying</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span>   <span class="co"># Data visualization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"knitr"</span><span class="op">)</span>     <span class="co"># Document generation</span></span>
<span></span>
<span><span class="co"># Install DemoKin</span></span>
<span><span class="co"># DemoKin is available on CRAN (https://cran.r-project.org/web/packages/DemoKin/index.html), </span></span>
<span><span class="co"># but we'll use the development version on GitHub (https://github.com/IvanWilli/DemoKin):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"IvanWilli/DemoKin"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/IvanWilli/DemoKin" class="external-link">DemoKin</a></span><span class="op">)</span>  <span class="co"># For kinship analysis</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="load-packages">Setting Up the Analysis Environment<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h2>
<p>Let’s begin by loading the necessary packages for our analysis:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>    <span class="co"># For data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>    <span class="co"># For restructuring data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>  <span class="co"># For visualization</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span>    <span class="co"># For document generation</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="demographic-data">Understanding the Demographic Data<a class="anchor" aria-label="anchor" href="#demographic-data"></a>
</h2>
<div class="section level3">
<h3 id="data-overview">Data Overview<a class="anchor" aria-label="anchor" href="#data-overview"></a>
</h3>
<p>The <code>DemoKin</code> package includes Swedish demographic data
from the Human Mortality Database (HMD) and Human Fertility Database
(HFD) as an example dataset. This includes:</p>
<ul>
<li>
<strong>swe_px</strong>: Age-by-year matrix of survival
probabilities</li>
<li>
<strong>swe_Sx</strong>: Age-by-year matrix of survival ratios</li>
<li>
<strong>swe_asfr</strong>: Age-by-year matrix of fertility
rates</li>
<li>
<strong>swe_pop</strong>: Age-by-year matrix of population
counts</li>
</ul>
<p>You can view all available data in the package with
<code>data(package="DemoKin")</code>.</p>
</div>
<div class="section level3">
<h3 id="exploring-the-data">Exploring the Data<a class="anchor" aria-label="anchor" href="#exploring-the-data"></a>
</h3>
<p>Let’s examine a subset of the Swedish demographic data to understand
its structure:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First 5 rows and columns of survival probabilities</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">swe_px</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      1900    1901    1902    1903    1904</span></span>
<span><span class="co">## 0 0.91060 0.90673 0.92298 0.91890 0.92357</span></span>
<span><span class="co">## 1 0.97225 0.97293 0.97528 0.97549 0.97847</span></span>
<span><span class="co">## 2 0.98525 0.98579 0.98630 0.98835 0.98921</span></span>
<span><span class="co">## 3 0.98998 0.98947 0.99079 0.99125 0.99226</span></span>
<span><span class="co">## 4 0.99158 0.99133 0.99231 0.99352 0.99272</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fertility rates for ages 25-30</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">swe_asfr</span><span class="op">[</span><span class="fl">26</span><span class="op">:</span><span class="fl">31</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       1900    1901    1902    1903    1904    1905    1906    1907    1908</span></span>
<span><span class="co">## 25 0.18104 0.18322 0.17980 0.17339 0.17595 0.17445 0.17302 0.17246 0.17631</span></span>
<span><span class="co">## 26 0.18762 0.19279 0.19170 0.18754 0.18431 0.18248 0.18763 0.18405 0.18594</span></span>
<span><span class="co">## 27 0.19838 0.20267 0.19365 0.19035 0.19298 0.19016 0.19172 0.18634 0.18591</span></span>
<span><span class="co">## 28 0.20742 0.20543 0.19983 0.19558 0.19680 0.19696 0.19541 0.19489 0.19251</span></span>
<span><span class="co">## 29 0.20192 0.21060 0.20264 0.19938 0.19541 0.19482 0.19236 0.19205 0.19452</span></span>
<span><span class="co">## 30 0.20518 0.20504 0.20148 0.19700 0.19511 0.19698 0.19862 0.19192 0.19245</span></span>
<span><span class="co">##       1909</span></span>
<span><span class="co">## 25 0.17423</span></span>
<span><span class="co">## 26 0.18250</span></span>
<span><span class="co">## 27 0.18912</span></span>
<span><span class="co">## 28 0.19381</span></span>
<span><span class="co">## 29 0.18839</span></span>
<span><span class="co">## 30 0.18975</span></span></code></pre>
<p>For our time-invariant model, we need to extract the demographic
rates for a single year. Let’s use 2015 as our reference year:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract vectors for 2015</span></span>
<span><span class="va">swe_surv_2015</span> <span class="op">&lt;-</span> <span class="va">swe_px</span><span class="op">[</span>,<span class="st">"2015"</span><span class="op">]</span>  <span class="co"># Survival probabilities</span></span>
<span><span class="va">swe_asfr_2015</span> <span class="op">&lt;-</span> <span class="va">swe_asfr</span><span class="op">[</span>,<span class="st">"2015"</span><span class="op">]</span> <span class="co"># Fertility rates</span></span></code></pre></div>
<p>Let’s compare the data between different time periods to understand
demographic changes. Here we compare values from 1950 and 2010:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Survival probabilities</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Survival probabilities (px):\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Survival probabilities (px):</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">swe_px</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1950"</span>,<span class="st">"2010"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      1950    2010</span></span>
<span><span class="co">## 0 0.98237 0.99760</span></span>
<span><span class="co">## 1 0.99833 0.99972</span></span>
<span><span class="co">## 2 0.99885 0.99989</span></span>
<span><span class="co">## 3 0.99904 0.99991</span></span>
<span><span class="co">## 4 0.99938 0.99992</span></span>
<span><span class="co">## 5 0.99920 0.99994</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fertility rates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFertility rates (asfr):\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Fertility rates (asfr):</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">swe_asfr</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1950"</span>,<span class="st">"2010"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   1950 2010</span></span>
<span><span class="co">## 0    0    0</span></span>
<span><span class="co">## 1    0    0</span></span>
<span><span class="co">## 2    0    0</span></span>
<span><span class="co">## 3    0    0</span></span>
<span><span class="co">## 4    0    0</span></span>
<span><span class="co">## 5    0    0</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Population counts</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nPopulation counts:\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Population counts:</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">swe_pop</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1950"</span>,<span class="st">"2010"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    1950  2010</span></span>
<span><span class="co">## 0 57780 54400</span></span>
<span><span class="co">## 1 60451 53714</span></span>
<span><span class="co">## 2 61288 53495</span></span>
<span><span class="co">## 3 62970 53263</span></span>
<span><span class="co">## 4 63089 51524</span></span>
<span><span class="co">## 5 62963 51321</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="visualizing-demographic-trends">Visualizing Demographic Trends<a class="anchor" aria-label="anchor" href="#visualizing-demographic-trends"></a>
</h3>
<div class="section level4">
<h4 id="mortality-trends">Mortality Trends<a class="anchor" aria-label="anchor" href="#mortality-trends"></a>
</h4>
<p>Let’s visualize how mortality has changed over time. We’ll plot the
probability of dying between ages
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x+1</annotation></semantics></math>
(denoted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mi>x</mi></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">q_x = 1-p_x</annotation></semantics></math>)
for different years:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">swe_px</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"year"</span>, values_to <span class="op">=</span> <span class="st">"px"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1950</span>, <span class="fl">2010</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>qx <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="va">px</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">qx</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Age-specific mortality in Sweden (1950-2010)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Probability of dying between ages x and x+1"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Probability of dying (qx, log scale)"</span>, </span>
<span>    col <span class="op">=</span> <span class="st">"Year"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="1_1_OneSex_TimeInvariant_Age_files/figure-html/mortality_viz-1.png" width="2400" style="display: block; margin: auto;"></p>
<p><strong>Interpretation</strong>: This graph reveals how mortality has
declined dramatically across all age groups from 1950 to 2010. The log
scale highlights improvements at all ages, with particularly notable
declines in infant and child mortality. The characteristic “bathtub”
shape of human mortality is clearly visible: high mortality in infancy,
followed by very low mortality through childhood and early adulthood,
then a steady exponential increase with age.</p>
</div>
<div class="section level4">
<h4 id="fertility-trends">Fertility Trends<a class="anchor" aria-label="anchor" href="#fertility-trends"></a>
</h4>
<p>Now, let’s examine how fertility patterns have changed over time:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">swe_asfr</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"year"</span>, values_to <span class="op">=</span> <span class="st">"fx"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1950</span>, <span class="fl">2010</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">fx</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Age-specific fertility in Sweden (1950-2010)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Fertility rates by age of mother"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age of mother"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Age-specific fertility rate (fx)"</span>, </span>
<span>    col <span class="op">=</span> <span class="st">"Year"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="1_1_OneSex_TimeInvariant_Age_files/figure-html/fertility_viz-1.png" width="2400" style="display: block; margin: auto;"></p>
<p><strong>Interpretation</strong>: This visualization shows how
fertility patterns have changed over the decades. The 1950 curve shows
earlier childbearing with higher peak fertility rates. By 2010,
fertility has shifted to later ages, reflecting the postponement of
childbearing in developed countries. We can also observe the declining
total fertility rate (the area under each curve).</p>
</div>
<div class="section level4">
<h4 id="population-structure">Population Structure<a class="anchor" aria-label="anchor" href="#population-structure"></a>
</h4>
<p>Finally, let’s look at how the population structure has evolved:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">swe_pop</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">age</span>, names_to <span class="op">=</span> <span class="st">"year"</span>, values_to <span class="op">=</span> <span class="st">"pop"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">""</span>, <span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1950</span>, <span class="fl">2010</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">pop</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Female population structure in Sweden (1950-2010)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Population counts by age"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Population count (thousands)"</span>, </span>
<span>    col <span class="op">=</span> <span class="st">"Year"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="1_1_OneSex_TimeInvariant_Age_files/figure-html/population_viz-1.png" width="2400" style="display: block; margin: auto;"></p>
<p><strong>Interpretation</strong>: This graph shows how Sweden’s female
population structure has changed over time. The 1950 distribution shows
the effects of baby booms and war years. By 2010, we see population
aging with a more uniform distribution across ages and greater
longevity, with significant numbers of women surviving to very old
ages.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-demokin-package">The DemoKin Package<a class="anchor" aria-label="anchor" href="#the-demokin-package"></a>
</h2>
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p><code>DemoKin</code> is an R package designed to compute the number
and age distribution of relatives (kin) of a focal individual under
various demographic assumptions. It can analyze both living and deceased
kin, and allows for both time-invariant and time-varying demographic
rates.</p>
</div>
<div class="section level3">
<h3 id="kin-function">The <code>kin()</code> Function<a class="anchor" aria-label="anchor" href="#kin-function"></a>
</h3>
<p>The main function in the package is <code><a href="../reference/kin.html">DemoKin::kin()</a></code>,
which implements matrix kinship models to calculate expected kin
counts.</p>
<p>For our first example, we’ll run the simplest model with the
following assumptions:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Time-invariant</strong> rates: The same set of mortality and
fertility rates apply throughout all time periods (we’ll use 2015
rates).</li>
<li>
<strong>One-sex</strong> population: We’ll only use female data and
trace kinship through female lines.</li>
</ol>
<p>Let’s run the basic kinship model:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the time-invariant, one-sex model</span></span>
<span><span class="va">swe_2015</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kin.html">kin</a></span><span class="op">(</span></span>
<span>  p <span class="op">=</span> <span class="va">swe_surv_2015</span>,          <span class="co"># Vector of survival probabilities</span></span>
<span>  f <span class="op">=</span> <span class="va">swe_asfr_2015</span>,          <span class="co"># Vector of fertility rates</span></span>
<span>  time_invariant <span class="op">=</span> <span class="cn">TRUE</span>       <span class="co"># Use time-invariant model</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="kin-arguments">Function Arguments<a class="anchor" aria-label="anchor" href="#kin-arguments"></a>
</h3>
<p>The <code><a href="../reference/kin.html">kin()</a></code> function accepts several important
arguments:</p>
<ul>
<li>
<strong>p</strong>: A vector or matrix of survival probabilities
with rows as ages (and columns as years if a matrix)</li>
<li>
<strong>f</strong>: A vector or matrix of fertility rates with the
same dimensions as p</li>
<li>
<strong>time_invariant</strong>: Logical flag indicating whether to
assume time-invariant rates (default: TRUE)</li>
<li>
<strong>output_kin</strong>: Character vector specifying which kin
types to return (e.g., “m” for mother, “d” for daughter)</li>
</ul>
</div>
<div class="section level3">
<h3 id="relative-types">Relative Types<a class="anchor" aria-label="anchor" href="#relative-types"></a>
</h3>
<p>In <code>DemoKin</code>, each type of relative is identified by a
unique code. These codes differ from those used in Caswell <span class="citation">(2019)</span>. The following table shows the
relationship between these coding systems:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display relationship codes</span></span>
<span><span class="va">demokin_codes</span></span></code></pre></div>
<pre><code><span><span class="co">##    DemoKin Caswell               Labels_female                   Labels_male</span></span>
<span><span class="co">## 1      coa       t    Cousins from older aunts     Cousins from older uncles</span></span>
<span><span class="co">## 2      cya       v  Cousins from younger aunts   Cousins from younger uncles</span></span>
<span><span class="co">## 3        c    &lt;NA&gt;                     Cousins                       Cousins</span></span>
<span><span class="co">## 4        d       a                   Daughters                          Sons</span></span>
<span><span class="co">## 5       gd       b             Grand-daughters                    Grand-sons</span></span>
<span><span class="co">## 6      ggd       c       Great-grand-daughters              Great-grand-sons</span></span>
<span><span class="co">## 7      ggm       h          Great-grandmothers            Great-grandfathers</span></span>
<span><span class="co">## 8       gm       g                Grandmothers                  Grandfathers</span></span>
<span><span class="co">## 9        m       d                      Mother                        Father</span></span>
<span><span class="co">## 10     nos       p   Nieces from older sisters   Nephews from older brothers</span></span>
<span><span class="co">## 11     nys       q Nieces from younger sisters Nephews from younger brothers</span></span>
<span><span class="co">## 12       n    &lt;NA&gt;                      Nieces                       Nephews</span></span>
<span><span class="co">## 13      oa       r     Aunts older than mother     Uncles older than fathers</span></span>
<span><span class="co">## 14      ya       s   Aunts younger than mother    Uncles younger than father</span></span>
<span><span class="co">## 15       a    &lt;NA&gt;                       Aunts                        Uncles</span></span>
<span><span class="co">## 16      os       m               Older sisters                Older brothers</span></span>
<span><span class="co">## 17      ys       n             Younger sisters              Younger brothers</span></span>
<span><span class="co">## 18       s    &lt;NA&gt;                     Sisters                      Brothers</span></span>
<span><span class="co">##                          Labels_2sex</span></span>
<span><span class="co">## 1    Cousins from older aunts/uncles</span></span>
<span><span class="co">## 2  Cousins from younger aunts/uncles</span></span>
<span><span class="co">## 3                            Cousins</span></span>
<span><span class="co">## 4                           Children</span></span>
<span><span class="co">## 5                    Grand-childrens</span></span>
<span><span class="co">## 6              Great-grand-childrens</span></span>
<span><span class="co">## 7                Great-grandfparents</span></span>
<span><span class="co">## 8                       Grandparents</span></span>
<span><span class="co">## 9                            Parents</span></span>
<span><span class="co">## 10      Niblings from older siblings</span></span>
<span><span class="co">## 11    Niblings from younger siblings</span></span>
<span><span class="co">## 12                          Niblings</span></span>
<span><span class="co">## 13   Aunts/Uncles older than parents</span></span>
<span><span class="co">## 14 Aunts/Uncles younger than parents</span></span>
<span><span class="co">## 15                      Aunts/Uncles</span></span>
<span><span class="co">## 16                    Older siblings</span></span>
<span><span class="co">## 17                  Younger siblings</span></span>
<span><span class="co">## 18                          Siblings</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="value">Function Output<a class="anchor" aria-label="anchor" href="#value"></a>
</h3>
<p>The <code><a href="../reference/kin.html">kin()</a></code> function returns a list containing two data
frames:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine the structure of the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">swe_2015</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 2</span></span>
<span><span class="co">##  $ kin_full   : tibble [142,814 × 7] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##   ..$ kin      : chr [1:142814] "d" "d" "d" "d" ...</span></span>
<span><span class="co">##   ..$ age_kin  : int [1:142814] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ age_focal: int [1:142814] 0 1 2 3 4 5 6 7 8 9 ...</span></span>
<span><span class="co">##   ..$ living   : num [1:142814] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ dead     : num [1:142814] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ cohort   : logi [1:142814] NA NA NA NA NA NA ...</span></span>
<span><span class="co">##   ..$ year     : logi [1:142814] NA NA NA NA NA NA ...</span></span>
<span><span class="co">##  $ kin_summary: tibble [1,414 × 10] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##   ..$ age_focal     : int [1:1414] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##   ..$ kin           : chr [1:1414] "coa" "cya" "d" "gd" ...</span></span>
<span><span class="co">##   ..$ year          : logi [1:1414] NA NA NA NA NA NA ...</span></span>
<span><span class="co">##   ..$ cohort        : logi [1:1414] NA NA NA NA NA NA ...</span></span>
<span><span class="co">##   ..$ count_living  : num [1:1414] 0.2752 0.0898 0 0 0 ...</span></span>
<span><span class="co">##   ..$ mean_age      : num [1:1414] 8.32 4.05 NaN NaN NaN ...</span></span>
<span><span class="co">##   ..$ sd_age        : num [1:1414] 6.14 3.68 NaN NaN NaN ...</span></span>
<span><span class="co">##   ..$ count_dead    : num [1:1414] 0.0000633 0.000037 0 0 0 ...</span></span>
<span><span class="co">##   ..$ count_cum_dead: num [1:1414] 0.0000633 0.000037 0 0 0 ...</span></span>
<span><span class="co">##   ..$ mean_age_lost : num [1:1414] 0 0 NaN NaN NaN 0 0 0 0 NaN ...</span></span></code></pre>
<div class="section level4">
<h4 id="kin-full">The <code>kin_full</code> Data Frame<a class="anchor" aria-label="anchor" href="#kin-full"></a>
</h4>
<p>This data frame contains detailed information on expected kin counts
by: - Age of the focal individual - Type of kin - Age of kin -
Living/dead status</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View the first few rows of kin_full</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">swe_2015</span><span class="op">$</span><span class="va">kin_full</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">##   kin   age_kin age_focal living  dead cohort year </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> d           0         0      0     0 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> d           0         1      0     0 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> d           0         2      0     0 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> d           0         3      0     0 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> d           0         4      0     0 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> d           0         5      0     0 <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="kin-summary">The <code>kin_summary</code> Data Frame<a class="anchor" aria-label="anchor" href="#kin-summary"></a>
</h4>
<p>This data frame provides a summary of expected kin counts by: - Age
of the focal individual - Type of kin - Total counts (not broken down by
age of kin)</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View the first few rows of kin_summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">swe_2015</span><span class="op">$</span><span class="va">kin_summary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">##   age_focal kin   year  cohort count_living mean_age sd_age count_dead</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>         0 coa   <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>           0.275      8.32   6.14  0.000<span style="text-decoration: underline;">063</span>3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>         0 cya   <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>           0.089<span style="text-decoration: underline;">8</span>     4.05   3.68  0.000<span style="text-decoration: underline;">037</span>0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>         0 d     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>           0        <span style="color: #BB0000;">NaN</span>    <span style="color: #BB0000;">NaN</span>     0        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>         0 gd    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>           0        <span style="color: #BB0000;">NaN</span>    <span style="color: #BB0000;">NaN</span>     0        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>         0 ggd   <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>           0        <span style="color: #BB0000;">NaN</span>    <span style="color: #BB0000;">NaN</span>     0        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>         0 ggm   <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>           0.320     84.4    6.43  0.028<span style="text-decoration: underline;">7</span>   </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 2 more variables: count_cum_dead &lt;dbl&gt;, mean_age_lost &lt;dbl&gt;</span></span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="kinship-diagrams">Visualizing Kinship Networks<a class="anchor" aria-label="anchor" href="#kinship-diagrams"></a>
</h2>
<div class="section level3">
<h3 id="keyfitz-diagrams">Keyfitz Diagrams<a class="anchor" aria-label="anchor" href="#keyfitz-diagrams"></a>
</h3>
<p>One powerful way to visualize kinship structure is through a network
or ‘Keyfitz’ kinship diagram <span class="citation">(Keyfitz, Caswell,
et al. 2005)</span>. Let’s see the expected number of living female
relatives for a 65-year-old woman according to our model:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">swe_2015</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">age_focal</span> <span class="op">==</span> <span class="fl">65</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">kin</span>, count <span class="op">=</span> <span class="va">count_living</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/plot_diagram.html">plot_diagram</a></span><span class="op">(</span>rounding <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="1_1_OneSex_TimeInvariant_Age_files/figure-html/keyfitz_diagram-1.png" width="3600" style="display: block; margin: auto;"></p>
<p><strong>Interpretation</strong>: This Keyfitz diagram provides a
comprehensive view of the kinship network for a 65-year-old woman in
Sweden (based on 2015 demographic rates). The diagram shows:</p>
<ul>
<li>Vertical relationships: A 65-year-old woman is likely to have around
0.9 daughters and 0.52 granddaughters through daughters, but few
great-granddaughters (nearly 0) as they wouldn’t have been born yet.
Looking upward, she’s unlikely to have a living mother (0.16) and almost
certainly no living grandmother (nearly 0).</li>
<li>Horizontal relationships: She would have about 0.83 living sisters
(0.38 old sisters and 0.45 younger sisters) and 0.8 nieces.</li>
</ul>
<p>This visualization helps us understand the changing composition of
family networks across the life course.</p>
</div>
</div>
<div class="section level2">
<h2 id="number-of-living-kin">Analyzing Living Kin Over the Life Course<a class="anchor" aria-label="anchor" href="#number-of-living-kin"></a>
</h2>
<p>Let’s run the model again, but this time we’ll specify exactly which
kin types we want to analyze:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">swe_2015</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/kin.html">kin</a></span><span class="op">(</span></span>
<span>    p <span class="op">=</span> <span class="va">swe_surv_2015</span>,</span>
<span>    f <span class="op">=</span> <span class="va">swe_asfr_2015</span>,</span>
<span>    output_kin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"gd"</span>, <span class="st">"ggd"</span>, <span class="st">"gm"</span>, <span class="st">"m"</span>, <span class="st">"n"</span>, <span class="st">"a"</span>, <span class="st">"s"</span><span class="op">)</span>,  <span class="co"># Specific kin types</span></span>
<span>    time_invariant <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Now, let’s visualize how the expected number of each type of relative
changes over the life course:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">swe_2015</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rename_kin.html">rename_kin</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="co"># Convert kin codes to readable labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age_focal</span>, <span class="va">count_living</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Expected number of living female relatives over the life course"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Based on Swedish demographic rates from 2015"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age of focal individual"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of living female relatives"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">kin_label</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span>  <span class="co"># Use different y-scales for each panel</span></span></code></pre></div>
<p><img src="1_1_OneSex_TimeInvariant_Age_files/figure-html/kin_over_lifecourse-1.png" width="3000" style="display: block; margin: auto;"></p>
<p><strong>Interpretation</strong>: These plots show how different
kinship relationships evolve over a person’s lifetime:</p>
<ul>
<li>
<strong>Mothers</strong>: Initially 1.0 (everyone has a mother at
birth), then gradually declining as mortality takes its toll</li>
<li>
<strong>Grandmothers</strong>: Start lower (many already deceased at
Focal’s birth) and decline rapidly</li>
<li>
<strong>Daughters</strong>: Increasing during reproductive years,
then stable</li>
<li>
<strong>Granddaughters</strong>: Appearing later and increasing as
daughters have children</li>
<li>
<strong>Great-granddaughters</strong>: Appearing even later as
granddaughters have children</li>
<li>
<strong>Sisters</strong>: Relatively stable then declining due to
mortality</li>
<li>
<strong>Aunts and cousins</strong>: Follow similar patterns of
eventual decline</li>
<li>
<strong>nieces</strong>: similar patterns as daughters.</li>
</ul>
<blockquote>
<p>Note that we are working in a time-invariant framework. You can think
of the results as analogous to life expectancy (i.e., expected years of
life for a synthetic cohort experiencing a given set of period mortality
rates).</p>
</blockquote>
<div class="section level3">
<h3 id="total-family-size-over-the-life-course">Total Family Size Over the Life Course<a class="anchor" aria-label="anchor" href="#total-family-size-over-the-life-course"></a>
</h3>
<p>How does the overall family size (and family composition) vary over
life for an average woman?</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate total kin count at each age</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">swe_2015</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age_focal</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count_living <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">count_living</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot family composition over the life course</span></span>
<span><span class="va">swe_2015</span><span class="op">$</span><span class="va">kin_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">age_focal</span>, <span class="va">kin</span>, <span class="va">count_living</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/rename_kin.html">rename_kin</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age_focal</span>, y <span class="op">=</span> <span class="va">count_living</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">kin_label</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">counts</span>, linewidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Family size and composition over the life course"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Based on Swedish demographic rates from 2015"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age of focal individual"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of living female relatives"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Kin type"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="1_1_OneSex_TimeInvariant_Age_files/figure-html/family_size_composition-1.png" width="2400" style="display: block; margin: auto;"></p>
<p><strong>Interpretation</strong>: This stacked area chart reveals
fascinating patterns in family size and composition throughout life:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Early life</strong>: Family consists primarily of mothers,
grandmothers, aunts, cousins, and sisters</li>
<li>
<strong>Young and middle adulthood (20s-40s)</strong>: Total family
size increases as daughters and nieces are born</li>
<li>
<strong>Late adulthood and Older (50s+)</strong>: Even though
granddaughters and granddaughters are born, while older relatives
(mothers, aunts, grandmothers) begin to disappear. Family composition
shifts dramatically toward descendants (daughters, granddaughters,
great-granddaughters)</li>
</ol>
<p>Therefore, the total family size (black line) shows an interesting
U-shape, first declining as older relatives die, then rising again as
new generations are born.</p>
</div>
</div>
<div class="section level2">
<h2 id="age-distribution-of-living-kin">Age Distribution of Relatives<a class="anchor" aria-label="anchor" href="#age-distribution-of-living-kin"></a>
</h2>
<p>Beyond just counting relatives, we’re often interested in their age
distribution. Using the <code>kin_full</code> data frame, we can examine
the age distribution of Focal’s relatives at a specific age.</p>
<p>Let’s visualize the age distribution of relatives when Focal is 65
years old:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">swe_2015</span><span class="op">$</span><span class="va">kin_full</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rename_kin.html">rename_kin</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">age_focal</span> <span class="op">==</span> <span class="fl">65</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age_kin</span>, <span class="va">living</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">65</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Age distribution of living female relatives when Focal is 65"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Based on Swedish demographic rates from 2015 (red line = Focal's age)"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age of relative"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Expected number of living relatives"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">kin_label</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></code></pre></div>
<p><img src="1_1_OneSex_TimeInvariant_Age_files/figure-html/age_distribution-1.png" width="3000" style="display: block; margin: auto;"></p>
<p><strong>Interpretation</strong>: These distributions provide rich
information about family age structure:</p>
<ul>
<li>
<strong>Mothers</strong>: If still alive, would be concentrated
around age 85-95</li>
<li>
<strong>Daughters</strong>: Mostly in their 30s and 40s</li>
<li>
<strong>Granddaughters</strong>: Predominantly young, between ages
0-15</li>
<li>
<strong>Sisters</strong>: Close to Focal’s own age (65)</li>
<li>
<strong>Nieces</strong>: Mostly in their 30s and 40s, similar to
daughters</li>
<li>
<strong>Cousins</strong>: Close to Focal’s own age (65)</li>
</ul>
<p>Understanding age distributions is crucial for estimating care needs,
support systems, and intergenerational transfers within families.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this tutorial, we’ve explored how to use the <code>DemoKin</code>
package to model kinship dynamics in a time-invariant, one-sex
framework. We’ve seen how different demographic patterns affect family
size and composition, and visualized these relationships across the life
course.</p>
<p>Key insights include:</p>
<ol style="list-style-type: decimal">
<li>Family networks are dynamic, changing dramatically throughout the
life course</li>
<li>Both family size and composition evolve with age</li>
<li>Modern demographic rates lead to “bean pole” families—vertical
extension (multiple generations) but horizontal contraction (fewer
siblings, cousins)</li>
<li>Matrix population models provide a powerful framework for
understanding these dynamics</li>
</ol>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-caswell_formal_2019" class="csl-entry">
Caswell, Hal. 2019. <span>“The Formal Demography of Kinship:
<span>A</span> Matrix Formulation.”</span> <em>Demographic Research</em>
41 (September): 679–712. <a href="https://doi.org/10.4054/DemRes.2019.41.24" class="external-link">https://doi.org/10.4054/DemRes.2019.41.24</a>.
</div>
<div id="ref-Keyfitz2005" class="csl-entry">
Keyfitz, Nathan, Hal Caswell, et al. 2005. <em>Applied Mathematical
Demography</em>. Vol. 47. Springer.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Iván Williams, Diego Alburez-Gutierrez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
