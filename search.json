[{"path":"https://ivanwilli.github.io/DemoKin/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 DemoKin authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"One-sex time-invariant kinship model specified by age","text":"Kinship fundamental property human populations key form social structure. Demographers long interested interplay demographic change family configuration. led development sophisticated methodological conceptual approaches study kinship, explored tutorial. Kinship analysis can answer range important questions: many relatives might people different ages, age distribution relatives? family structure (number age distribution kin) evolve populations undergo demographic transition? tutorial, implement matrix kinship models using DemoKin package calculate kin counts age distributions. begin simplest model: time-invariant one-sex model, outlined Caswell (2019). model, assume everyone population experiences mortality fertility rates throughout lives (e.g., 2015 rates), trace female kin relationships.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"preparation","dir":"Articles","previous_headings":"Introduction","what":"Preparation","title":"One-sex time-invariant kinship model specified by age","text":"starting session, please ensure complete following preparatory steps: haven’t already, install R RStudio. useful tutorial: https://rstudio-education.github.io/hopr/starting.html Install following packages R:","code":"# Install basic data analysis packages rm(list = ls()) install.packages(\"dplyr\")     # Data manipulation install.packages(\"tidyr\")     # Data tidying install.packages(\"ggplot2\")   # Data visualization install.packages(\"knitr\")     # Document generation install.packages(\"data.table\")# Efficient data handling install.packages(\"Matrix\")    # Matrix operations  # Install DemoKin # DemoKin is available on CRAN (https://cran.r-project.org/web/packages/DemoKin/index.html),  # but we'll use the development version on GitHub (https://github.com/IvanWilli/DemoKin): install.packages(\"remotes\") remotes::install_github(\"IvanWilli/DemoKin\") library(DemoKin)  # For kinship analysis"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Setting Up the Analysis Environment","title":"One-sex time-invariant kinship model specified by age","text":"Let’s begin loading necessary packages analysis:","code":"library(dplyr)    # For data manipulation library(tidyr)    # For restructuring data library(ggplot2)  # For visualization library(knitr)    # For document generation"},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"data-overview","dir":"Articles","previous_headings":"Understanding the Demographic Data","what":"Data Overview","title":"One-sex time-invariant kinship model specified by age","text":"DemoKin package includes Swedish demographic data Human Mortality Database (HMD) Human Fertility Database (HFD) example dataset. includes: swe_px: Age--year matrix survival probabilities swe_Sx: Age--year matrix survival ratios swe_asfr: Age--year matrix fertility rates swe_pop: Age--year matrix population counts can view available data package data(package=\"DemoKin\").","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"exploring-the-data","dir":"Articles","previous_headings":"Understanding the Demographic Data","what":"Exploring the Data","title":"One-sex time-invariant kinship model specified by age","text":"Let’s examine subset Swedish demographic data understand structure: time-invariant model, need extract demographic rates single year. Let’s use 2015 reference year: Let’s compare data different time periods understand demographic changes. compare values 1950 2010:","code":"# First 5 rows and columns of survival probabilities head(swe_px[1:5, 1:5]) ##      1900    1901    1902    1903    1904 ## 0 0.91060 0.90673 0.92298 0.91890 0.92357 ## 1 0.97225 0.97293 0.97528 0.97549 0.97847 ## 2 0.98525 0.98579 0.98630 0.98835 0.98921 ## 3 0.98998 0.98947 0.99079 0.99125 0.99226 ## 4 0.99158 0.99133 0.99231 0.99352 0.99272 # Fertility rates for ages 25-30 head(swe_asfr[26:31, 1:10]) ##       1900    1901    1902    1903    1904    1905    1906    1907    1908 ## 25 0.18104 0.18322 0.17980 0.17339 0.17595 0.17445 0.17302 0.17246 0.17631 ## 26 0.18762 0.19279 0.19170 0.18754 0.18431 0.18248 0.18763 0.18405 0.18594 ## 27 0.19838 0.20267 0.19365 0.19035 0.19298 0.19016 0.19172 0.18634 0.18591 ## 28 0.20742 0.20543 0.19983 0.19558 0.19680 0.19696 0.19541 0.19489 0.19251 ## 29 0.20192 0.21060 0.20264 0.19938 0.19541 0.19482 0.19236 0.19205 0.19452 ## 30 0.20518 0.20504 0.20148 0.19700 0.19511 0.19698 0.19862 0.19192 0.19245 ##       1909 ## 25 0.17423 ## 26 0.18250 ## 27 0.18912 ## 28 0.19381 ## 29 0.18839 ## 30 0.18975 # Extract vectors for 2015 swe_surv_2015 <- swe_px[,\"2015\"]  # Survival probabilities swe_asfr_2015 <- swe_asfr[,\"2015\"] # Fertility rates # Survival probabilities cat(\"Survival probabilities (px):\\n\") ## Survival probabilities (px): head(swe_px[,c(\"1950\",\"2010\")]) ##      1950    2010 ## 0 0.98237 0.99760 ## 1 0.99833 0.99972 ## 2 0.99885 0.99989 ## 3 0.99904 0.99991 ## 4 0.99938 0.99992 ## 5 0.99920 0.99994 # Fertility rates cat(\"\\nFertility rates (asfr):\\n\") ##  ## Fertility rates (asfr): head(swe_asfr[,c(\"1950\",\"2010\")]) ##   1950 2010 ## 0    0    0 ## 1    0    0 ## 2    0    0 ## 3    0    0 ## 4    0    0 ## 5    0    0 # Population counts cat(\"\\nPopulation counts:\\n\") ##  ## Population counts: head(swe_pop[,c(\"1950\",\"2010\")]) ##    1950  2010 ## 0 57780 54400 ## 1 60451 53714 ## 2 61288 53495 ## 3 62970 53263 ## 4 63089 51524 ## 5 62963 51321"},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"mortality-trends","dir":"Articles","previous_headings":"Understanding the Demographic Data > Visualizing Demographic Trends","what":"Mortality Trends","title":"One-sex time-invariant kinship model specified by age","text":"Let’s visualize mortality changed time. ’ll plot probability dying ages xx x+1x+1 (denoted qx=1−pxq_x = 1-p_x) different years:  Interpretation: graph reveals mortality declined dramatically across age groups 1950 2010. log scale highlights improvements ages, particularly notable declines infant child mortality. characteristic “bathtub” shape human mortality clearly visible: high mortality infancy, followed low mortality childhood early adulthood, steady exponential increase age.","code":"swe_px %>%   as.data.frame() %>%   mutate(age = c(0:100)) %>%   pivot_longer(cols = -c(age), names_to = \"year\", values_to = \"px\") %>%   filter(year %in% seq(1950, 2010, 30)) %>%    mutate(qx = 1-px) %>%   ggplot() +   geom_line(aes(x = age, y = qx, col = as.character(year)), linewidth = 1) +   scale_y_log10() +   labs(     title = \"Age-specific mortality in Sweden (1950-2010)\",     subtitle = \"Probability of dying between ages x and x+1\",     x = \"Age\",     y = \"Probability of dying (qx, log scale)\",      col = \"Year\"   ) +   theme_bw() +   theme(legend.position = \"bottom\")"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"fertility-trends","dir":"Articles","previous_headings":"Understanding the Demographic Data > Visualizing Demographic Trends","what":"Fertility Trends","title":"One-sex time-invariant kinship model specified by age","text":"Now, let’s examine fertility patterns changed time:  Interpretation: visualization shows fertility patterns changed decades. 1950 curve shows earlier childbearing higher peak fertility rates. 2010, fertility shifted later ages, reflecting postponement childbearing developed countries. can also observe declining total fertility rate (area curve).","code":"swe_asfr %>%   as.data.frame() %>%   mutate(age = c(0:100)) %>%   pivot_longer(cols = -c(age), names_to = \"year\", values_to = \"fx\") %>%   filter(year %in% seq(1950, 2010, 30)) %>%    ggplot() +    geom_line(aes(x = age, y = fx, col = as.character(year)), linewidth = 1) +   labs(     title = \"Age-specific fertility in Sweden (1950-2010)\",     subtitle = \"Fertility rates by age of mother\",     x = \"Age of mother\",     y = \"Age-specific fertility rate (fx)\",      col = \"Year\"   ) +   theme_bw() +   theme(legend.position = \"bottom\")"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"population-structure","dir":"Articles","previous_headings":"Understanding the Demographic Data > Visualizing Demographic Trends","what":"Population Structure","title":"One-sex time-invariant kinship model specified by age","text":"Finally, let’s look population structure evolved:  Interpretation: graph shows Sweden’s female population structure changed time. 1950 distribution shows effects baby booms war years. 2010, see population aging uniform distribution across ages greater longevity, significant numbers women surviving old ages.","code":"swe_pop %>%   as.data.frame() %>%   mutate(age = c(0:100)) %>%   pivot_longer(-age, names_to = \"year\", values_to = \"pop\") %>%    mutate(year = gsub(\"X\", \"\", year)) %>%    filter(year %in% seq(1950, 2010, 30)) %>%    ggplot() +    geom_line(aes(x = age, y = pop, col = as.character(year)), linewidth = 1) +   labs(     title = \"Female population structure in Sweden (1950-2010)\",     subtitle = \"Population counts by age\",     x = \"Age\",     y = \"Population count (thousands)\",      col = \"Year\"   ) +   theme_bw() +   theme(legend.position = \"bottom\")"},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"overview","dir":"Articles","previous_headings":"The DemoKin Package","what":"Overview","title":"One-sex time-invariant kinship model specified by age","text":"DemoKin R package designed compute number age distribution relatives (kin) focal individual various demographic assumptions. can analyze living deceased kin, allows time-invariant time-varying demographic rates.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"kin-function","dir":"Articles","previous_headings":"The DemoKin Package","what":"The kin() Function","title":"One-sex time-invariant kinship model specified by age","text":"main function package DemoKin::kin(), implements matrix kinship models calculate expected kin counts. first example, ’ll run simplest model following assumptions: Time-invariant rates: set mortality fertility rates apply throughout time periods (’ll use 2015 rates). One-sex population: ’ll use female data trace kinship female lines. Let’s run basic kinship model:","code":"# Run the time-invariant, one-sex model swe_2015 <- kin(   p = swe_surv_2015,          # Vector of survival probabilities   f = swe_asfr_2015,          # Vector of fertility rates   time_invariant = TRUE       # Use time-invariant model )"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"kin-arguments","dir":"Articles","previous_headings":"The DemoKin Package","what":"Function Arguments","title":"One-sex time-invariant kinship model specified by age","text":"kin() function accepts several important arguments: p: vector matrix survival probabilities rows ages (columns years matrix) f: vector matrix fertility rates dimensions p time_invariant: Logical flag indicating whether assume time-invariant rates (default: TRUE) output_kin: Character vector specifying kin types return (e.g., “m” mother, “d” daughter)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"relative-types","dir":"Articles","previous_headings":"The DemoKin Package","what":"Relative Types","title":"One-sex time-invariant kinship model specified by age","text":"DemoKin, type relative identified unique code. codes differ used Caswell (2019). following table shows relationship coding systems:","code":"# Display relationship codes demokin_codes ##    DemoKin Caswell               Labels_female                   Labels_male ## 1      coa       t    Cousins from older aunts     Cousins from older uncles ## 2      cya       v  Cousins from younger aunts   Cousins from younger uncles ## 3        c    <NA>                     Cousins                       Cousins ## 4        d       a                   Daughters                          Sons ## 5       gd       b             Grand-daughters                    Grand-sons ## 6      ggd       c       Great-grand-daughters              Great-grand-sons ## 7      ggm       h          Great-grandmothers            Great-grandfathers ## 8       gm       g                Grandmothers                  Grandfathers ## 9        m       d                      Mother                        Father ## 10     nos       p   Nieces from older sisters   Nephews from older brothers ## 11     nys       q Nieces from younger sisters Nephews from younger brothers ## 12       n    <NA>                      Nieces                       Nephews ## 13      oa       r     Aunts older than mother     Uncles older than fathers ## 14      ya       s   Aunts younger than mother    Uncles younger than father ## 15       a    <NA>                       Aunts                        Uncles ## 16      os       m               Older sisters                Older brothers ## 17      ys       n             Younger sisters              Younger brothers ## 18       s    <NA>                     Sisters                      Brothers ##                          Labels_2sex ## 1    Cousins from older aunts/uncles ## 2  Cousins from younger aunts/uncles ## 3                            Cousins ## 4                           Children ## 5                    Grand-childrens ## 6              Great-grand-childrens ## 7                Great-grandfparents ## 8                       Grandparents ## 9                            Parents ## 10      Niblings from older siblings ## 11    Niblings from younger siblings ## 12                          Niblings ## 13   Aunts/Uncles older than parents ## 14 Aunts/Uncles younger than parents ## 15                      Aunts/Uncles ## 16                    Older siblings ## 17                  Younger siblings ## 18                          Siblings"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"value","dir":"Articles","previous_headings":"The DemoKin Package","what":"Function Output","title":"One-sex time-invariant kinship model specified by age","text":"kin() function returns list containing two data frames:","code":"# Examine the structure of the output str(swe_2015) ## List of 2 ##  $ kin_full   : tibble [142,814 × 7] (S3: tbl_df/tbl/data.frame) ##   ..$ kin      : chr [1:142814] \"d\" \"d\" \"d\" \"d\" ... ##   ..$ age_kin  : int [1:142814] 0 0 0 0 0 0 0 0 0 0 ... ##   ..$ age_focal: int [1:142814] 0 1 2 3 4 5 6 7 8 9 ... ##   ..$ living   : num [1:142814] 0 0 0 0 0 0 0 0 0 0 ... ##   ..$ dead     : num [1:142814] 0 0 0 0 0 0 0 0 0 0 ... ##   ..$ cohort   : logi [1:142814] NA NA NA NA NA NA ... ##   ..$ year     : logi [1:142814] NA NA NA NA NA NA ... ##  $ kin_summary: tibble [1,414 × 10] (S3: tbl_df/tbl/data.frame) ##   ..$ age_focal     : int [1:1414] 0 0 0 0 0 0 0 0 0 0 ... ##   ..$ kin           : chr [1:1414] \"coa\" \"cya\" \"d\" \"gd\" ... ##   ..$ year          : logi [1:1414] NA NA NA NA NA NA ... ##   ..$ cohort        : logi [1:1414] NA NA NA NA NA NA ... ##   ..$ count_living  : num [1:1414] 0.2752 0.0898 0 0 0 ... ##   ..$ mean_age      : num [1:1414] 8.32 4.05 NaN NaN NaN ... ##   ..$ sd_age        : num [1:1414] 6.14 3.68 NaN NaN NaN ... ##   ..$ count_dead    : num [1:1414] 0.0000633 0.000037 0 0 0 ... ##   ..$ count_cum_dead: num [1:1414] 0.0000633 0.000037 0 0 0 ... ##   ..$ mean_age_lost : num [1:1414] 0 0 NaN NaN NaN 0 0 0 0 NaN ..."},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"kin-full","dir":"Articles","previous_headings":"The DemoKin Package > Function Output","what":"The kin_full Data Frame","title":"One-sex time-invariant kinship model specified by age","text":"data frame contains detailed information expected kin counts : - Age focal individual - Type kin - Age kin - Living/dead status","code":"# View the first few rows of kin_full head(swe_2015$kin_full) ## # A tibble: 6 × 7 ##   kin   age_kin age_focal living  dead cohort year  ##   <chr>   <int>     <int>  <dbl> <dbl> <lgl>  <lgl> ## 1 d           0         0      0     0 NA     NA    ## 2 d           0         1      0     0 NA     NA    ## 3 d           0         2      0     0 NA     NA    ## 4 d           0         3      0     0 NA     NA    ## 5 d           0         4      0     0 NA     NA    ## 6 d           0         5      0     0 NA     NA"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"kin-summary","dir":"Articles","previous_headings":"The DemoKin Package > Function Output","what":"The kin_summary Data Frame","title":"One-sex time-invariant kinship model specified by age","text":"data frame provides summary expected kin counts : - Age focal individual - Type kin - Total counts (broken age kin)","code":"# View the first few rows of kin_summary head(swe_2015$kin_summary) ## # A tibble: 6 × 10 ##   age_focal kin   year  cohort count_living mean_age sd_age count_dead ##       <int> <chr> <lgl> <lgl>         <dbl>    <dbl>  <dbl>      <dbl> ## 1         0 coa   NA    NA           0.275      8.32   6.14  0.0000633 ## 2         0 cya   NA    NA           0.0898     4.05   3.68  0.0000370 ## 3         0 d     NA    NA           0        NaN    NaN     0         ## 4         0 gd    NA    NA           0        NaN    NaN     0         ## 5         0 ggd   NA    NA           0        NaN    NaN     0         ## 6         0 ggm   NA    NA           0.320     84.4    6.43  0.0287    ## # ℹ 2 more variables: count_cum_dead <dbl>, mean_age_lost <dbl>"},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"keyfitz-diagrams","dir":"Articles","previous_headings":"Visualizing Kinship Networks","what":"Keyfitz Diagrams","title":"One-sex time-invariant kinship model specified by age","text":"One powerful way visualize kinship structure network ‘Keyfitz’ kinship diagram (Keyfitz, Caswell, et al. 2005). Let’s see expected number living female relatives 65-year-old woman according model:  Interpretation: Keyfitz diagram provides comprehensive view kinship network 65-year-old woman Sweden (based 2015 demographic rates). diagram shows: Vertical relationships: 65-year-old woman likely around 0.9 daughters 0.52 granddaughters daughters, great-granddaughters (nearly 0) wouldn’t born yet. Looking upward, ’s unlikely living mother (0.16) almost certainly living grandmother (nearly 0). Horizontal relationships: 0.83 living sisters (0.38 old sisters 0.45 younger sisters) 0.8 nieces. visualization helps us understand changing composition family networks across life course.","code":"swe_2015$kin_summary %>%    filter(age_focal == 65) %>%    select(kin, count = count_living) %>%    plot_diagram(rounding = 2)"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"number-of-living-kin","dir":"Articles","previous_headings":"","what":"Analyzing Living Kin Over the Life Course","title":"One-sex time-invariant kinship model specified by age","text":"Let’s run model , time ’ll specify exactly kin types want analyze: Now, let’s visualize expected number type relative changes life course:  Interpretation: plots show different kinship relationships evolve person’s lifetime: Mothers: Initially 1.0 (everyone mother birth), gradually declining mortality takes toll Grandmothers: Start lower (many already deceased Focal’s birth) decline rapidly Daughters: Increasing reproductive years, stable Granddaughters: Appearing later increasing daughters children Great-granddaughters: Appearing even later granddaughters children Sisters: Relatively stable declining due mortality Aunts cousins: Follow similar patterns eventual decline nieces: similar patterns daughters. Note working time-invariant framework. can think results analogous life expectancy (.e., expected years life synthetic cohort experiencing given set period mortality rates).","code":"swe_2015 <-    kin(     p = swe_surv_2015,     f = swe_asfr_2015,     output_kin = c(\"c\", \"d\", \"gd\", \"ggd\", \"gm\", \"m\", \"n\", \"a\", \"s\"),  # Specific kin types     time_invariant = TRUE   ) swe_2015$kin_summary %>%   rename_kin() %>%  # Convert kin codes to readable labels   ggplot() +   geom_line(aes(age_focal, count_living), linewidth = 1)  +   theme_bw() +   labs(     title = \"Expected number of living female relatives over the life course\",     subtitle = \"Based on Swedish demographic rates from 2015\",     x = \"Age of focal individual\",     y = \"Number of living female relatives\"   ) +   facet_wrap(~kin_label, scales = \"free_y\")  # Use different y-scales for each panel"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"total-family-size-over-the-life-course","dir":"Articles","previous_headings":"Analyzing Living Kin Over the Life Course","what":"Total Family Size Over the Life Course","title":"One-sex time-invariant kinship model specified by age","text":"overall family size (family composition) vary life average woman?  Interpretation: stacked area chart reveals fascinating patterns family size composition throughout life: Early life: Family consists primarily mothers, grandmothers, aunts, cousins, sisters Young middle adulthood (20s-40s): Total family size increases daughters nieces born Late adulthood Older (50s+): Even though granddaughters granddaughters born, older relatives (mothers, aunts, grandmothers) begin disappear. Family composition shifts dramatically toward descendants (daughters, granddaughters, great-granddaughters) Therefore, total family size (black line) shows interesting U-shape, first declining older relatives die, rising new generations born.","code":"# Calculate total kin count at each age counts <-    swe_2015$kin_summary %>%   group_by(age_focal) %>%    summarise(count_living = sum(count_living)) %>%    ungroup()  # Plot family composition over the life course swe_2015$kin_summary %>%   select(age_focal, kin, count_living) %>%    rename_kin() %>%    ggplot(aes(x = age_focal, y = count_living)) +   geom_area(aes(fill = kin_label), color = \"black\", alpha = 0.8) +   geom_line(data = counts, linewidth = 1.5) +   labs(     title = \"Family size and composition over the life course\",     subtitle = \"Based on Swedish demographic rates from 2015\",     x = \"Age of focal individual\",     y = \"Number of living female relatives\",     fill = \"Kin type\"   ) +   theme_bw() +   theme(legend.position = \"bottom\")"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"age-distribution-of-living-kin","dir":"Articles","previous_headings":"","what":"Age Distribution of Relatives","title":"One-sex time-invariant kinship model specified by age","text":"Beyond just counting relatives, ’re often interested age distribution. Using kin_full data frame, can examine age distribution Focal’s relatives specific age. Let’s visualize age distribution relatives Focal 65 years old:  Interpretation: distributions provide rich information family age structure: Mothers: still alive, concentrated around age 85-95 Daughters: Mostly 30s 40s Granddaughters: Predominantly young, ages 0-15 Sisters: Close Focal’s age (65) Nieces: Mostly 30s 40s, similar daughters Cousins: Close Focal’s age (65) Understanding age distributions crucial estimating care needs, support systems, intergenerational transfers within families.","code":"swe_2015$kin_full %>%   rename_kin() %>%   filter(age_focal == 65) %>%   ggplot(aes(age_kin, living)) +   geom_line(linewidth = 1) +   geom_vline(xintercept = 65, color = \"red\", linetype = \"dashed\") +   labs(     title = \"Age distribution of living female relatives when Focal is 65\",     subtitle = \"Based on Swedish demographic rates from 2015 (red line = Focal's age)\",     x = \"Age of relative\",     y = \"Expected number of living relatives\"   ) +   theme_bw() +   facet_wrap(~kin_label, scales = \"free_y\")"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_1_OneSex_TimeInvariant_Age.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"One-sex time-invariant kinship model specified by age","text":"tutorial, ’ve explored use DemoKin package model kinship dynamics time-invariant, one-sex framework. ’ve seen different demographic patterns affect family size composition, visualized relationships across life course. Key insights include: Family networks dynamic, changing dramatically throughout life course family size composition evolve age Modern demographic rates lead “bean pole” families—vertical extension (multiple generations) horizontal contraction (fewer siblings, cousins) Matrix population models provide powerful framework understanding dynamics","code":""},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_2_OneSex_TimeVarying_Age.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"One-sex time-varying kinship model specified by age","text":"time-invariant model explored previous vignette provides valuable insights kinship structures, one significant limitation: assumes demographic conditions remain constant throughout person’s life. reality, mortality fertility rates evolve dramatically time due socioeconomic development, medical advances, cultural shifts. Time-varying kinship models address limitation incorporating historical demographic changes, offering nuanced realistic picture family networks. advanced models allow us : Track kinship networks specific birth cohorts across life course Account different demographic conditions experienced generation Provide accurate estimates kin availability specific historical periods Better understand demographic transitions shape family structures vignette, implement one-sex time-varying model, outlined Caswell Song (2021), using DemoKin package. build time-invariant approach incorporate year-specific mortality fertility rates model kinship networks individuals born specific years.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_2_OneSex_TimeVarying_Age.html","id":"preparation","dir":"Articles","previous_headings":"Introduction","what":"Package Installation","title":"One-sex time-varying kinship model specified by age","text":"haven’t already installed required packages previous vignette, ’s ’ll need:","code":"# Install basic data analysis packages rm(list = ls()) install.packages(\"dplyr\")     # Data manipulation install.packages(\"tidyr\")     # Data tidying install.packages(\"ggplot2\")   # Data visualization install.packages(\"knitr\")     # Document generation install.packages(\"data.table\")# Efficient data handling install.packages(\"Matrix\")    # Matrix operations  # Install DemoKin # DemoKin is available on CRAN (https://cran.r-project.org/web/packages/DemoKin/index.html),  # but we'll use the development version on GitHub (https://github.com/IvanWilli/DemoKin): install.packages(\"remotes\") remotes::install_github(\"IvanWilli/DemoKin\") library(DemoKin)  # For kinship analysis"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_2_OneSex_TimeVarying_Age.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Setting Up the Analysis Environment","title":"One-sex time-varying kinship model specified by age","text":"Let’s load necessary packages analysis:","code":"library(dplyr)    # For data manipulation library(tidyr)    # For restructuring data library(ggplot2)  # For visualization library(knitr)    # For document generation"},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_2_OneSex_TimeVarying_Age.html","id":"the-conceptual-shift","dir":"Articles","previous_headings":"Time-Varying Kinship Models","what":"The Conceptual Shift","title":"One-sex time-varying kinship model specified by age","text":"time-invariant model, assumed everyone experiences mortality fertility rates throughout lives (e.g., 2015 rates). However, simplification reality. Demographic rates change time, often dramatically: woman born 1900 experienced different mortality risks age 20 (1920) woman born 1950 age 20 (1970) Similarly, fertility patterns shifted substantially generations Time-varying models account historical changes using year-specific demographic rates. provide realistic picture kinship dynamics specific birth cohorts age changing demographic conditions.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_2_OneSex_TimeVarying_Age.html","id":"data-requirements","dir":"Articles","previous_headings":"Time-Varying Kinship Models","what":"Data Requirements","title":"One-sex time-varying kinship model specified by age","text":"time-varying models, instead vectors rates single year, need: matrix survival probabilities, : Rows representing ages (0, 1, 2, …, 100+) Columns representing years (e.g., 1950, 1951, …, 2020) matrix fertility rates dimensions matrix population counts (optional, certain calculations) DemoKin package includes Swedish data format, ’ll use example.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_2_OneSex_TimeVarying_Age.html","id":"run-the-model-time-varying","dir":"Articles","previous_headings":"Time-Varying Kinship Models","what":"Implementing the Time-Varying Model","title":"One-sex time-varying kinship model specified by age","text":"Let’s implement time-varying kinship model women born 1960 Sweden. ’ll focus specific kin types make interpretation easier: model: - use full matrices Swedish demographic data (swe_px, swe_asfr, swe_pop) - set time_invariant = FALSE implement time-varying model - specify output_cohort = 1960 focus women born 1960 - select specific relatives analyze (daughters, granddaughters, great-granddaughters, mothers, grandmothers, great-grandmothers)","code":"swe_time_varying <-    kin(     p = swe_px,              # Matrix of survival probabilities by age and year     f = swe_asfr,            # Matrix of fertility rates by age and year     n = swe_pop,             # Matrix of population counts by age and year     time_invariant = FALSE,  # Use time-varying model     output_cohort = 1960,    # Focus on the 1960 birth cohort     output_kin = c(\"d\",\"gd\",\"ggd\",\"m\",\"gm\",\"ggm\")  # Select specific kin types     )"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_2_OneSex_TimeVarying_Age.html","id":"living-relatives","dir":"Articles","previous_headings":"Time-Varying Kinship Models","what":"Living Relatives Across the Life Course","title":"One-sex time-varying kinship model specified by age","text":"Let’s examine number living kin changes throughout life course 1960 birth cohort:  Interpretation: plots show expected number living relatives changes 1960 cohort ages: Mothers (m): Starts near 1.0 gradually declines mothers die Grandmothers (gm): Already well 1.0 birth, reflecting pre-1960 mortality, declining rapidly Great-grandmothers (ggm): birth, quickly disappearing Daughters (d): Increasing reproductive years, reflecting fertility patterns 1980s-2000s Granddaughters (gd): Appearing daughters reach reproductive age, reflecting fertility 2000s-2030s Great-granddaughters (ggd): Beginning appear later years red vertical line age 35 provides reference point compare kin counts specific age. Unlike time-invariant model, counts reflect actual historical demographic conditions experienced cohort relatives.","code":"swe_time_varying$kin_summary %>%   ggplot(aes(age_focal, count_living, color=factor(cohort))) +   scale_y_continuous(name = \"\", labels = seq(0,3,.2), breaks = seq(0,3,.2)) +   geom_line(color = 1) +   geom_vline(xintercept = 35, color=2) +   labs(     title = \"Expected number of living relatives for the 1960 birth cohort\",     subtitle = \"Swedish demographic rates, time-varying model\",     x = \"Age of focal individual\",     y = \"Expected number of living relatives\"   ) +   facet_wrap(~kin, scales = \"free\") +   theme_bw()"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_2_OneSex_TimeVarying_Age.html","id":"kin-loss","dir":"Articles","previous_headings":"Time-Varying Kinship Models","what":"Analyzing Kin Loss","title":"One-sex time-varying kinship model specified by age","text":"Beyond counting living kin, can also examine patterns kin mortality. Understanding kin loss important : psychological social consequences bereaved individuals Affects availability support care across generations Influences patterns inheritance resource transfers Let’s examine cumulative number deceased relatives age 1960 birth cohort:  Interpretation: graphs show cumulative number deaths experienced kin type: Ascending relatives: Deaths accumulate gradually mothers, rapidly grandmothers great-grandmothers Descending relatives: Deaths rare occur, representing tragedy losing children, grandchildren, great-grandchildren can also examine mean age relatives die. 50-year-old woman born 1960: table shows expected number deceased relatives mean age died. example, age 50, woman born 1960 lost approximately 0.32 mothers age women lost mother around 37.83 years-old average.","code":"swe_time_varying$kin_summary %>%   ggplot() +   geom_line(aes(age_focal, count_cum_dead)) +   labs(     title = \"Cumulative number of deceased relatives by age\",     subtitle = \"1960 birth cohort, Sweden\",     x = \"Age of focal individual\",     y = \"Expected number of deceased relatives\"   ) +   theme_bw() +   facet_wrap(~kin, scales=\"free\") swe_time_varying$kin_summary %>%    filter(age_focal == 50) %>%    select(kin, count_cum_dead, mean_age_lost) %>%    mutate_if(is.numeric, round, 2) %>%    kable()"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_2_OneSex_TimeVarying_Age.html","id":"prevelances","dir":"Articles","previous_headings":"Time-Varying Kinship Models","what":"Prevalence Calculations","title":"One-sex time-varying kinship model specified by age","text":"Beyond simple counts, can combine kinship data prevalence rates age estimate number kin specific characteristics. approach, based Sullivan Method, allows us : Estimate relatives specific health conditions Calculate working-age vs. dependent kin Project care needs support capacity within family networks Let’s create hypothetical prevalence vector increases exponentially age (might represent condition like dementia):  Interpretation: stacked area plots show expected number relatives without hypothetical condition age Focal: older relatives (mothers, grandmothers), proportion condition increases Focal ages, reflecting age-related nature condition younger relatives (daughters, granddaughters), prevalence remains low, consistent age pattern condition can see changing total number relatives changing composition condition status approach can extended age-specific prevalence, : Health conditions (disability, chronic disease) Employment status Educational attainment Living arrangements","code":"# Create a prevalence vector that increases exponentially with age swe_prevalence <-    tibble(     age_kin = unique(swe_time_varying$kin_full$age_kin),     prev = .005 * exp(.05 * age_kin)  # Exponential increase with age     )  # Combine with kinship data and calculate counts swe_time_varying$kin_full %>%    left_join(swe_prevalence) %>%    group_by(kin, age_focal, cohort) %>%    summarise(     prevalent = sum(living * prev),        # Kin with the condition     no_prevalent = sum(living * (1-prev))  # Kin without the condition     ) %>%    pivot_longer(cols = prevalent:no_prevalent, names_to = \"prevalence_state\", values_to = \"count\") %>%    ggplot(aes(x=age_focal, y = count)) +    geom_area(aes(fill=prevalence_state)) +   labs(     title = \"Expected number of relatives with and without the condition\",     subtitle = \"Based on age-specific prevalence rates\",     x = \"Age of focal individual\",     y = \"Number of living relatives\",     fill = \"Condition status\"   ) +   facet_wrap(~kin) +   theme_bw()"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_2_OneSex_TimeVarying_Age.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"One-sex time-varying kinship model specified by age","text":"vignette, ’ve explored implement time-varying kinship models using DemoKin package, expanding analytical approach incorporate historical demographic change. time-varying approach offers several advantages time-invariant models: 1. Historical accuracy: incorporates actual demographic changes rather assuming constant rates 2. Cohort specificity: can model specific birth cohorts experiencing unique demographic conditions 3. Period effects: captures major demographic events like wars, pandemics, baby booms methodological improvements allow us uncover important substantive insights: demographic transitions reshape family structures across generations unique kinship experiences different birth cohorts navigate changing mortality fertility regimes kin loss bereavement patterns evolve response mortality improvements complex interplay period cohort effects shaping family networks time-varying models provide greater realism, time-invariant models still serve valuable purposes. offer simpler baseline understanding kinship patterns, can project future kinship structures based current demographic conditions, require less data.","code":""},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_3_TwoSex_TimeInvariant_Age.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Two-sex time-invariant kinship model specified by age","text":"Demographic processes fundamental kinship formation vary significantly males females. one-sex models offer valuable insights family structures, overlook sex differences, can lead incomplete understanding kinship dynamics. Two-sex kinship models address limitation incorporating sex-specific demographic rates tracing male female lineages. Key advantages two-sex models include: Accounting sex differences mortality Incorporating sex-specific fertility patterns Enabling analysis kin availability sex Allowing exploration sex ratios within kinship networks Providing realistic estimates kin availability across life course vignette, implement two-sex time-invariant kinship model, outlined Caswell (2022), using DemoKin package understand sex-specific demographic patterns shape family structures.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_3_TwoSex_TimeInvariant_Age.html","id":"preparation","dir":"Articles","previous_headings":"Introduction","what":"Package Installation","title":"Two-sex time-invariant kinship model specified by age","text":"haven’t already installed required packages previous vignettes, ’s ’ll need:","code":"# Install basic data analysis packages install.packages(\"dplyr\")     # Data manipulation install.packages(\"tidyr\")     # Data tidying install.packages(\"ggplot2\")   # Data visualization install.packages(\"knitr\")     # Document generation install.packages(\"data.table\")# Efficient data handling install.packages(\"Matrix\")    # Matrix operations  # Install DemoKin # DemoKin is available on CRAN (https://cran.r-project.org/web/packages/DemoKin/index.html),  # but we'll use the development version on GitHub (https://github.com/IvanWilli/DemoKin): install.packages(\"remotes\") remotes::install_github(\"IvanWilli/DemoKin\") library(DemoKin)  # For kinship analysis"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_3_TwoSex_TimeInvariant_Age.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Setting Up the Analysis Environment","title":"Two-sex time-invariant kinship model specified by age","text":"Let’s load necessary packages analysis:","code":"rm(list = ls()) library(dplyr)    # For data manipulation library(tidyr)    # For restructuring data library(ggplot2)  # For visualization library(knitr)    # For document generation"},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_3_TwoSex_TimeInvariant_Age.html","id":"model-input-2sex","dir":"Articles","previous_headings":"Two-Sex Kinship Modeling","what":"Understanding Sex Differences in Demographic Rates","title":"Two-sex time-invariant kinship model specified by age","text":"first step implementing two-sex kinship model understand sex differences demographic rates. Human males females exhibit distinct mortality fertility patterns: Mortality differences: Males generally experience higher mortality rates ages, resulting shorter life expectancy Fertility differences: Males often begin reproduction later can continue reproducing older ages differences affect kinship structures several important ways: availability male versus female relatives (especially older ages) timing kin loss experiences (e.g., fathers versus mothers die) number descendants male versus female individuals example, ’ll use data France (2012), included DemoKin package. Let’s examine sex-specific mortality fertility rates:  Interpretation: graphs reveal important sex differences demographic rates: Fertility patterns: total fertility rates nearly identical males females (difference 0.01), age patterns differ substantially. Male fertility occurs later ages wider distribution, reflecting tendency men father children older ages compared women. Survival probabilities: Females higher survival probabilities adult old ages. pattern leads sex imbalances older populations affects availability different types relatives. sex differences demographic rates shape kinship networks ways one-sex models capture.","code":"# Extract sex-specific rates fra_fert_f <- fra_asfr_sex[,\"ff\"]    # Female fertility rates fra_fert_m <- fra_asfr_sex[,\"fm\"]    # Male fertility rates fra_surv_f <- fra_surv_sex[,\"pf\"]    # Female survival probabilities fra_surv_m <- fra_surv_sex[,\"pm\"]    # Male survival probabilities  # Compare total fertility rates by sex cat(\"Difference in TFR (male - female):\", sum(fra_fert_m) - sum(fra_fert_f)) ## Difference in TFR (male - female): -0.0115 # Visualize sex differences in demographic rates data.frame(value = c(fra_fert_f, fra_fert_m, fra_surv_f, fra_surv_m),            age = rep(0:100, 4),            sex = rep(c(rep(\"f\", 101), rep(\"m\", 101)), 2),            risk = c(rep(\"fertility rate\", 101 * 2), rep(\"survival probability\", 101 * 2))) %>%   ggplot(aes(age, value, col=sex)) +    geom_line(linewidth = 1) +    labs(     title = \"Sex-specific demographic rates in France (2012)\",     x = \"Age\",     y = \"Rate\",     color = \"Sex\"   ) +   facet_wrap(~ risk, scales = \"free_y\") +    theme_bw()"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_3_TwoSex_TimeInvariant_Age.html","id":"run-model-2sex","dir":"Articles","previous_headings":"Two-Sex Kinship Modeling","what":"Implementing the Two-Sex Model","title":"Two-sex time-invariant kinship model specified by age","text":"now introduce function kin2sex, extends one-sex function kin incorporate sex-specific rates. key differences : need provide female male demographic rates must specify sex focal individual need indicate sex ratio birth (proportion births female) Let’s implement two-sex time-varying model France: output kin2sex similar kin, additional column sex_kin specifies sex relative.","code":"kin_result <- kin2sex(   pf = fra_surv_f,        # Female survival probabilities   pm = fra_surv_m,        # Male survival probabilities   ff = fra_fert_f,        # Female fertility rates   fm = fra_fert_m,        # Male fertility rates   time_invariant = TRUE,  # Use time-invariant model   sex_focal = \"f\",        # Focus on female focal individuals   birth_female = .5       # Proportion of births that are female )"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_3_TwoSex_TimeInvariant_Age.html","id":"living-relatives-by-sex","dir":"Articles","previous_headings":"Two-Sex Kinship Modeling","what":"Living Relatives by Sex","title":"Two-sex time-invariant kinship model specified by age","text":"Let’s examine number living relatives differs sex across life course female focal individual:  Interpretation: stacked area plots reveal sex composition living relatives changes across life course: Parents (m): Fathers (blue) die earlier mothers (red), leading predominance mothers older ages Grandparents (gm): Even birth, grandmothers outnumber grandfathers due mortality grandparental generation Great-grandparents (ggm): Shows even stronger female predominance due compounded mortality differences across generations Siblings (s): Brothers die earlier sisters, leading higher proportion sisters older ages Children (d): Starts even sex ratio, slight female predominance older ages due higher male mortality patterns highlight importance accounting sex differences kinship models, especially studying older populations.","code":"# Group specific kin types and filter for key relationships kin_out <- kin_result$kin_summary %>%    mutate(kin = case_when(kin %in% c(\"ys\", \"os\") ~ \"s\",      # Siblings                          kin %in% c(\"ya\", \"oa\") ~ \"a\",    # Aunts/uncles                          TRUE ~ kin)) %>%   filter(kin %in% c(\"d\", \"m\", \"gm\", \"ggm\", \"s\", \"a\"))     # Select key relationships  # Visualize living kin by sex kin_out %>%    group_by(kin, age_focal, sex_kin) %>%   summarise(count = sum(count_living)) %>%   ggplot(aes(age_focal, count, fill = sex_kin)) +   geom_area() +   labs(     title = \"Expected number of living relatives by sex\",     subtitle = \"Female focal individual, France 2012\",     x = \"Age of focal individual\",     y = \"Number of living relatives\",     fill = \"Sex of relative\"   ) +   theme_bw() +   facet_wrap(~kin, labeller = labeller(     kin = c(\"a\" = \"Aunts/Uncles\", \"d\" = \"Children\",              \"gm\" = \"Grandparents\", \"ggm\" = \"Great-grandparents\",             \"m\" = \"Parents\", \"s\" = \"Siblings\")   ))"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_3_TwoSex_TimeInvariant_Age.html","id":"kinship-terminology","dir":"Articles","previous_headings":"Two-Sex Kinship Modeling","what":"Understanding Kinship Terminology in Two-Sex Models","title":"Two-sex time-invariant kinship model specified by age","text":"using kin2sex function, ’s important understand relationship codes work: function uses relationship codes one-sex model (see demokin_codes()), now relative specified sex. example: kin = \"d\", sex_kin = \"f\" refers daughters kin = \"d\", sex_kin = \"m\" refers sons kin = \"m\", sex_kin = \"f\" refers mothers kin = \"m\", sex_kin = \"m\" refers fathers coding system allows flexible analysis specific relative types maintaining compatibility one-sex model.","code":"# Example of how to identify specific relatives by sex kin_result$kin_summary %>%    filter(kin == \"d\", sex_kin == \"m\") %>%  # This selects sons (male children)   head() ## # A tibble: 6 × 11 ##   age_focal kin   sex_kin year  cohort count_living mean_age sd_age count_dead ##       <int> <chr> <chr>   <lgl> <lgl>         <dbl>    <dbl>  <dbl>      <dbl> ## 1         0 d     m       NA    NA                0      NaN    NaN          0 ## 2         1 d     m       NA    NA                0      NaN    NaN          0 ## 3         2 d     m       NA    NA                0      NaN    NaN          0 ## 4         3 d     m       NA    NA                0      NaN    NaN          0 ## 5         4 d     m       NA    NA                0      NaN    NaN          0 ## 6         5 d     m       NA    NA                0      NaN    NaN          0 ## # ℹ 2 more variables: count_cum_dead <dbl>, mean_age_lost <dbl>"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_3_TwoSex_TimeInvariant_Age.html","id":"sex-ratios","dir":"Articles","previous_headings":"Two-Sex Kinship Modeling","what":"Sex Ratios in Kinship Networks","title":"Two-sex time-invariant kinship model specified by age","text":"Sex ratios (males per female) traditional measure demography can provide insights kinship structures. Let’s examine sex ratios vary across different types relatives:  Interpretation: sex ratio plots reveal several important patterns: Parents: sex ratio starts 1 (equal numbers mothers fathers) declines rapidly age, reflecting higher male mortality Grandparents: Even birth, sex ratio 1, 25-year-old 0.5 grandfathers per grandmother Great-grandparents: Shows even extreme female predominance Children: Maintains sex ratio close 1 throughout life, slight declines older ages Siblings: Shows gradual decline sex ratio age due higher male mortality sex ratios important implications care relationships support networks, particularly older populations female relatives predominate.","code":"# Calculate sex ratios (males per female) by kin type and age kin_out %>%    group_by(kin, age_focal) %>%   summarise(sex_ratio = sum(count_living[sex_kin == \"m\"], na.rm = TRUE) /                          sum(count_living[sex_kin == \"f\"], na.rm = TRUE)) %>%   ggplot(aes(age_focal, sex_ratio)) +   geom_line(linewidth = 1) +   geom_hline(yintercept = 1, linetype = \"dashed\", color = \"gray50\") +   labs(     title = \"Sex ratios of living relatives across the life course\",     subtitle = \"Males per female, France 2012\",     x = \"Age of focal individual\",     y = \"Sex ratio (m/f)\"   ) +   theme_bw() +   facet_wrap(~kin, scales = \"free\", labeller = labeller(     kin = c(\"a\" = \"Aunts/Uncles\", \"d\" = \"Children\",              \"gm\" = \"Grandparents\", \"ggm\" = \"Great-grandparents\",             \"m\" = \"Parents\", \"s\" = \"Siblings\")   ))"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_3_TwoSex_TimeInvariant_Age.html","id":"kin-loss-by-sex","dir":"Articles","previous_headings":"Two-Sex Kinship Modeling","what":"Timing of Kin Loss by Sex","title":"Two-sex time-invariant kinship model specified by age","text":"experience losing relatives differs sex relatives. Let’s examine timing kin loss varies sex:  Interpretation: curves show experience losing relatives differs sex: Parents: loss fathers (blue) occurs earlier loss mothers (red) Grandparents: Grandfather often lost birth early life, grandmothers tend lost later Siblings: Brothers lost higher rates sisters old ages (75+) Children: rare, loss sons occurs higher rates daughters Understanding patterns important studying bereavement experiences impacts across life course.","code":"# Visualize dead kin by sex kin_out %>%   group_by(kin, sex_kin, age_focal) %>%   summarise(count = sum(count_dead)) %>%   ggplot(aes(age_focal, count, color = sex_kin)) +   geom_line(linewidth = 1) +   labs(     title = \"Number of deceased relatives by sex\",     subtitle = \"Female focal individual, France 2012\",     x = \"Age of focal individual\",     y = \"Number of deceased relatives\",     color = \"Sex of relative\"   ) +   theme_bw() +   facet_wrap(~kin, scales = \"free\", labeller = labeller(     kin = c(\"a\" = \"Aunts/Uncles\", \"d\" = \"Children\",              \"gm\" = \"Grandparents\", \"ggm\" = \"Great-grandparents\",             \"m\" = \"Parents\", \"s\" = \"Siblings\")   ))"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_3_TwoSex_TimeInvariant_Age.html","id":"applications-of-two-sex-kinship-models","dir":"Articles","previous_headings":"","what":"Applications of Two-Sex Kinship Models","title":"Two-sex time-invariant kinship model specified by age","text":"Two-sex kinship models numerous applications demographic social research: Gender care: Women typically provide informal care relatives men. Two-sex models can help quantify potential care burdens examining availability different types relatives sex. Kinship networks aging societies: populations age, sex composition available kin changes dramatically. Two-sex models allow us project changes implications social support. Intergenerational transfers: Resources often flow differently male female relatives. Two-sex models provide demographic foundation studying gendered patterns. Demographic transitions: Sex differences mortality fertility change demographic transitions, reshaping kinship networks ways one-sex models capture. Demographic shocks: Events like wars often affect males females differently, long-lasting impacts kinship structures. Two-sex models can capture effects.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_3_TwoSex_TimeInvariant_Age.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Two-sex time-invariant kinship model specified by age","text":"vignette, ’ve explored implement two-sex kinship models using DemoKin package. incorporating sex-specific mortality fertility rates, models reveal important patterns one-sex models capture: Female predominance among older relatives due sex differences mortality Systematic differences timing kin loss sex, male kin typically lost earlier Varying sex ratios within kinship networks relationship type age Distinct age distributions relatives sex insights significant implications understanding care relationships, intergenerational transfers, support systems aging societies. two-sex approach substantially enhances understanding gender shapes family structures across life course, providing realistic foundation research policy development.","code":""},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_4_TwoSex_TimeVarying_Age.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Two-sex time-varying kinship model specified by age","text":"Family networks shaped simultaneously two fundamental forces: demographic differences males females, historical changes demographic rates time. previous vignettes explored dimensions separately, vignette integrates comprehensive framework: two-sex time-varying kinship model, outlined Caswell (2022), using kin2sex function time_invariant = FALSE.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_4_TwoSex_TimeVarying_Age.html","id":"preparation","dir":"Articles","previous_headings":"Introduction","what":"Package Installation","title":"Two-sex time-varying kinship model specified by age","text":"haven’t already installed required packages previous vignettes, ’s ’ll need:","code":"# Install basic data analysis packages install.packages(\"dplyr\")     # Data manipulation install.packages(\"tidyr\")     # Data tidying install.packages(\"ggplot2\")   # Data visualization install.packages(\"knitr\")     # Document generation install.packages(\"data.table\")# Efficient data handling install.packages(\"Matrix\")    # Matrix operations  # Install DemoKin # DemoKin is available on CRAN (https://cran.r-project.org/web/packages/DemoKin/index.html),  # but we'll use the development version on GitHub (https://github.com/IvanWilli/DemoKin): install.packages(\"remotes\") remotes::install_github(\"IvanWilli/DemoKin\") library(DemoKin)  # For kinship analysis"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_4_TwoSex_TimeVarying_Age.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Setting Up the Analysis Environment","title":"Two-sex time-varying kinship model specified by age","text":"Let’s load necessary packages analysis:","code":"rm(list = ls()) library(dplyr)    # For data manipulation library(tidyr)    # For restructuring data library(ggplot2)  # For visualization library(knitr)    # For document generation"},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_4_TwoSex_TimeVarying_Age.html","id":"model-structure-and-components","dir":"Articles","previous_headings":"Two-Sex Time-Varying Kinship Models","what":"Model Structure and Components","title":"Two-sex time-varying kinship model specified by age","text":"combined two-sex time-varying kinship model expands previous models requiring: Sex-specific mortality rates time: survival differs males females across historical periods Sex-specific fertility rates time: fertility patterns differ males females across historical periods Sex ratio birth: proportion births female Sex focal individual: Whether ’re analyzing male female kinship networks","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_4_TwoSex_TimeVarying_Age.html","id":"model-input-2sex-time-varying","dir":"Articles","previous_headings":"","what":"Data Preparation","title":"Two-sex time-varying kinship model specified by age","text":"vignette, ’ll use Swedish demographic data DemoKin package. However, since package includes female fertility mortality data time, ’ll create synthetic male rates illustration purposes. real-world application, ideally use actual male rates. , ’ll create male rates applying transformations female rates: Let’s examine resulting rates specific year (1900) verify follow expected patterns:  Interpretation: plot confirms synthetic rates follow expected patterns: Fertility: Male fertility shifted slightly older ages compared female fertility Survival: Male survival probabilities lower female survival ages rates show characteristic age patterns: fertility concentrated reproductive ages, survival declining age","code":"# Extract dimensions of the data years <- ncol(swe_px) ages <- nrow(swe_px)  # Use female rates directly from the package swe_surv_f_matrix <- swe_px swe_fert_f_matrix <- swe_asfr  # Create synthetic male rates # Male survival: Lower than female (raising to power 1.5 reduces values) swe_surv_m_matrix <- swe_px ^ 1.5 # artificial perturbation for this example  # Male fertility: Shifted to slightly older ages and slightly higher swe_fert_m_matrix <- rbind(matrix(0, 5, years),                             swe_asfr[-((ages-4):ages),]) * 1.05 # artificial perturbation for this example bind_rows(   data.frame(age = 0:100, sex = \"Female\", component = \"Fertility rate\", value = swe_fert_f_matrix[,\"1900\"]),   data.frame(age = 0:100, sex = \"Male\", component = \"Fertility rate\", value = swe_fert_m_matrix[,\"1900\"]),   data.frame(age = 0:100, sex = \"Female\", component = \"Survival probability\", value = swe_surv_f_matrix[,\"1900\"]),   data.frame(age = 0:100, sex = \"Male\", component = \"Survival probability\", value = swe_surv_m_matrix[,\"1900\"])) %>%    ggplot(aes(age, value, col = sex)) +   geom_line() +   theme_bw() +   facet_wrap(~component, scales = \"free\") +   labs(     title = \"Sex-specific demographic rates in Sweden (1900)\",     x = \"Age\",     y = \"Rate\",     color = \"Sex\"   )"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_4_TwoSex_TimeVarying_Age.html","id":"run-model-2sex-time-varying","dir":"Articles","previous_headings":"","what":"Running the Two-Sex Time-Varying Model","title":"Two-sex time-varying kinship model specified by age","text":"Now, let’s implement two-sex time-varying kinship model using kin2sex function time_invariant = FALSE: resulting output provides detailed information kinship network 1900 female birth cohort, relatives classified age sex.","code":"kin_out_time_varying <- kin2sex(   pf = swe_surv_f_matrix,       # Female survival matrix (age x year)   pm = swe_surv_m_matrix,       # Male survival matrix (age x year)   ff = swe_fert_f_matrix,       # Female fertility matrix (age x year)   fm = swe_fert_m_matrix,       # Male fertility matrix (age x year)   sex_focal = \"f\",              # Focal individual is female   time_invariant = FALSE,       # Use time-varying model   birth_female = .5,            # Sex ratio at birth (50% female)   output_cohort = 1900          # Focus on the 1900 birth cohort )"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_4_TwoSex_TimeVarying_Age.html","id":"kin-availability-2sex-time-varying","dir":"Articles","previous_headings":"","what":"Comparing Time-Varying and Time-Invariant Models","title":"Two-sex time-varying kinship model specified by age","text":"understand impact incorporating historical demographic change, let’s compare time-varying model time-invariant model uses 1900 rates:  Interpretation: comparison reveals important differences time-varying time-invariant models: Relatives sex: differences pronounced male kin (bottom row) female kin (top row), mortality improvements time led greater availability predicted time-invariant model Ascending generations: parents (m), grandparents (gm), great-grandparents (ggm), time-varying model shows higher kin availability older ages, reflecting mortality improvements captured time-invariant model Descendants: children (d), time-varying model shows fewer kin, reflecting fertility decline time Kin generation: siblings (s), fertility decline time limited impact numbers fertility events either already occurred occur shortly. Instead, mortality improvements play critical role, leading time-varying model predict higher number surviving siblings older ages. time-varying model captures demographic transition occurred 20th century, including declining fertility mortality rates. produces accurate representation kinship dynamics historical cohorts.","code":"# Run a time-invariant model using only 1900 rates kin_out_time_invariant <- kin2sex(   pf = swe_surv_f_matrix[,\"1900\"],    # Female survival (1900)   pm = swe_surv_m_matrix[,\"1900\"],    # Male survival (1900)   ff = swe_fert_f_matrix[,\"1900\"],    # Female fertility (1900)    fm = swe_fert_m_matrix[,\"1900\"],    # Male fertility (1900)   sex_focal = \"f\",                    # Focal individual is female   birth_female = .5                   # Sex ratio at birth (50% female) )  # Combine and plot the results kin_out_time_varying$kin_summary %>%   filter(cohort == 1900) %>%    mutate(type = \"variant\") %>%   bind_rows(kin_out_time_invariant$kin_summary %>% mutate(type = \"invariant\")) %>%    # Combine siblings and aunts/uncles for simplicity   mutate(kin = case_when(kin %in% c(\"ys\", \"os\") ~ \"s\",                          kin %in% c(\"ya\", \"oa\") ~ \"a\",                          TRUE ~ kin)) %>%   # Select key relationships   filter(kin %in% c(\"d\", \"m\", \"gm\", \"ggm\", \"s\", \"a\")) %>%   # Group by relationship type, age, sex, and model type   group_by(type, kin, age_focal, sex_kin) %>%   summarise(count = sum(count_living)) %>%   # Create plot   ggplot(aes(age_focal, count, linetype = type)) +   geom_line() +    theme_bw() +   facet_grid(cols = vars(kin), rows = vars(sex_kin), scales = \"free\") +   labs(     title = \"Time-varying vs. time-invariant kinship models by sex\",     subtitle = \"Female 1900 birth cohort, Sweden\",     x = \"Age of focal individual\",     y = \"Number of living relatives\",     linetype = \"Model type\"   )"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_4_TwoSex_TimeVarying_Age.html","id":"approximations","dir":"Articles","previous_headings":"","what":"Approximation Methods for Limited Data","title":"Two-sex time-varying kinship model specified by age","text":"practice, demographic data often limited, particularly male fertility rates can difficult obtain. Caswell (2022) introduced two approximation methods estimate two-sex kinship networks male demographic rates unavailable: Androgynous approximation: Assumes equal fertility survival males females GKP factors: Applies multipliers one-sex kin counts based theoretical considerations Goodman, Keyfitz Pullum (2022) Let’s evaluate approximations using French data DemoKin package:","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_4_TwoSex_TimeVarying_Age.html","id":"androgynous","dir":"Articles","previous_headings":"Approximation Methods for Limited Data","what":"Androgynous Approximation","title":"Two-sex time-varying kinship model specified by age","text":"androgynous approximation uses female rates sexes. Let’s compare full two-sex model:  Interpretation: androgynous approximation performs well kin types, particularly female relatives. However, shows noticeable discrepancies types male relatives, ignoring male-specific mortality leads overestimation.","code":"# Load data of France again fra_fert_f <- fra_asfr_sex[,\"ff\"]    # Female fertility rates fra_fert_m <- fra_asfr_sex[,\"fm\"]    # Male fertility rates fra_surv_f <- fra_surv_sex[,\"pf\"]    # Female survival probabilities fra_surv_m <- fra_surv_sex[,\"pm\"]    # Male survival probabilities  # Full two-sex model kin_out <- kin2sex(fra_surv_f, fra_surv_m, fra_fert_f, fra_fert_m,                    sex_focal = \"f\", birth_female = .5)  # Androgynous approximation kin_out_androgynous <- kin2sex(fra_surv_f, fra_surv_f, fra_fert_f, fra_fert_f,                                sex_focal = \"f\", birth_female = .5)  # Compare the results bind_rows(   kin_out$kin_summary %>% mutate(type = \"full\"),   kin_out_androgynous$kin_summary %>% mutate(type = \"androgynous\")) %>%   group_by(kin, age_focal, sex_kin, type) %>%   summarise(count = sum(count_living)) %>%   ggplot(aes(age_focal, count, linetype = type)) +   geom_line() +   theme_bw() +   theme(legend.position = \"bottom\", axis.text.x = element_blank()) +   facet_grid(row = vars(sex_kin), col = vars(kin), scales = \"free\") +   labs(     title = \"Androgynous approximation vs. full two-sex model\",     subtitle = \"France, 2012\",     x = \"Age of focal individual\",     y = \"Number of living relatives\",     linetype = \"Model type\"   )"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_4_TwoSex_TimeVarying_Age.html","id":"gkp","dir":"Articles","previous_headings":"Approximation Methods for Limited Data","what":"GKP Factors Approximation","title":"Two-sex time-varying kinship model specified by age","text":"GKP factors approach applies theoretical multipliers one-sex kin counts. Let’s implement evaluate approach:  Interpretation: comparison shows approximation methods produce reasonable estimates kin types. Overall, approximations offer practical alternatives sex-specific data limited, though used caution limitations understood.","code":"# One-sex model kin_out_1sex <- kin(fra_surv_f, fra_fert_f, birth_female = .5)  # Apply GKP factors kin_out_GKP <- kin_out_1sex$kin_summary %>%   mutate(count_living = case_when(     kin == \"m\" ~ count_living * 2,          # Parents: multiply by 2     kin == \"gm\" ~ count_living * 4,         # Grandparents: multiply by 4     kin == \"ggm\" ~ count_living * 8,        # Great-grandparents: multiply by 8     kin == \"d\" ~ count_living * 2,          # Children: multiply by 2     kin == \"gd\" ~ count_living * 4,         # Grandchildren: multiply by 4     kin == \"ggd\" ~ count_living * 4,        # Great-grandchildren: multiply by 4     kin == \"oa\" ~ count_living * 4,         # Older aunts/uncles: multiply by 4     kin == \"ya\" ~ count_living * 4,         # Younger aunts/uncles: multiply by 4     kin == \"os\" ~ count_living * 2,         # Older siblings: multiply by 2     kin == \"ys\" ~ count_living * 2,         # Younger siblings: multiply by 2     kin == \"coa\" ~ count_living * 8,        # Cousins (older): multiply by 8     kin == \"cya\" ~ count_living * 8,        # Cousins (younger): multiply by 8     kin == \"nos\" ~ count_living * 4,        # Nieces/nephews (older): multiply by 4     kin == \"nys\" ~ count_living * 4         # Nieces/nephews (younger): multiply by 4   ))  # Compare approaches at selected ages bind_rows(   kin_out$kin_summary %>% mutate(type = \"full\"),   kin_out_androgynous$kin_summary %>% mutate(type = \"androgynous\"),   kin_out_GKP %>% mutate(type = \"gkp\")) %>%   # Combine siblings, aunts/uncles, cousins, and nieces/nephews   mutate(kin = case_when(     kin %in% c(\"ys\", \"os\") ~ \"s\",           # All siblings     kin %in% c(\"ya\", \"oa\") ~ \"a\",           # All aunts/uncles     kin %in% c(\"coa\", \"cya\") ~ \"c\",         # All cousins     kin %in% c(\"nys\", \"nos\") ~ \"n\",         # All nieces/nephews     TRUE ~ kin)) %>%   # Select specific ages for comparison   filter(age_focal %in% c(5, 15, 30, 60, 80)) %>%   # Sum across sex for total kin counts   group_by(kin, age_focal, type) %>%   summarise(count = sum(count_living)) %>%   # Create bar chart   ggplot(aes(type, count)) +   geom_bar(aes(fill = type), stat = \"identity\") +   theme_bw() +   theme(axis.text.x = element_text(angle = 90), legend.position = \"bottom\") +   facet_grid(col = vars(kin), row = vars(age_focal), scales = \"free\") +   labs(     title = \"Comparison of approximation methods with full two-sex model\",     subtitle = \"France, 2012, at selected ages\",     x = \"Approximation method\",     y = \"Total number of living relatives\",     fill = \"Method\"   )"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_4_TwoSex_TimeVarying_Age.html","id":"prevalance-2sex-time-varying","dir":"Articles","previous_headings":"","what":"Incorporating Causes of Death","title":"Two-sex time-varying kinship model specified by age","text":"kin2sex function also allows analysis kinship networks cause death, providing insights different mortality causes affect kin availability. details kin bereavement methodology can found Caswell, Margolis Verdery (2023). Let’s implement simple cause--death model two competing causes. Now assume two causes death (COD). females, risk first COD half risk second COD ages greater 50. males, risk first COD 2/3 second COD ages greater 50. operationalize using two matrices dimension 2 101 (number causes number ages). Now ’ll run two-sex model cause death information: Let’s examine structure output: output now includes additional columns cause death. Let’s visualize distribution parental deaths cause, sex, age 30-year-old Focal:  Interpretation: visualization shows distribution parental deaths cause: Timing: simplified example, parental deaths occur age 50 Sex differences: Male parents (fathers) show higher death counts earlier ages, reflecting higher mortality Cause differences: relative importance different causes varies sex, males showing different distribution females approach can extended include causes death incorporate time-varying cause-specific mortality, though require complex data inputs.","code":"# Create matrices of relative risks by cause, sex, and age Hf <- matrix(c(.5, 1), nrow = 2, ncol = length(fra_surv_f))  # Female risk factors Hm <- matrix(c(.33, 1), nrow = 2, ncol = length(fra_surv_f)) # Male risk factors  # Set equal risks for ages below 50 Hf[,1:50] <- Hm[,1:50] <- 1 kin_out_cod_invariant <- kin2sex(   pf = fra_surv_f,           # Female survival   pm = fra_surv_m,           # Male survival   ff = fra_fert_f,           # Female fertility   fm = fra_fert_m,           # Male fertility   Hf = Hf,                   # Female cause-specific risk factors   Hm = Hm,                   # Male cause-specific risk factors   time_invariant = TRUE      # Using time-invariant model for simplicity ) head(kin_out_cod_invariant) ## # A tibble: 6 × 9 ##   year  cohort age_focal sex_kin kin   age_kin living deadcause1 deadcause2 ##   <lgl> <lgl>      <int> <chr>   <chr>   <int>  <dbl>      <dbl>      <dbl> ## 1 NA    NA             0 f       d           0      0          0          0 ## 2 NA    NA             1 f       d           0      0          0          0 ## 3 NA    NA             2 f       d           0      0          0          0 ## 4 NA    NA             3 f       d           0      0          0          0 ## 5 NA    NA             4 f       d           0      0          0          0 ## 6 NA    NA             5 f       d           0      0          0          0 kin_out_cod_invariant %>%    filter(kin == \"m\", age_focal == 30) %>%    summarise(deadcause1 = sum(deadcause1),             deadcause2 = sum(deadcause2), .by = c(age_kin, sex_kin)) %>%   pivot_longer(deadcause1:deadcause2) %>%    ggplot(aes(age_kin, value, col = sex_kin, linetype = name)) +   geom_line() +    labs(     title = \"Distribution of parental deaths by cause, sex, and age\",     subtitle = \"For a 30-year-old focal individual\",     x = \"Age of parent at death\",     y = \"Expected number of parental deaths\",     color = \"Sex of parent\",     linetype = \"Cause of death\"   ) +   theme_bw()"},{"path":"https://ivanwilli.github.io/DemoKin/articles/1_4_TwoSex_TimeVarying_Age.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Two-sex time-varying kinship model specified by age","text":"vignette, ’ve explored implement two-sex time-varying kinship models using DemoKin package. models provide comprehensive framework understanding kinship dynamics incorporating sex differences historical demographic change. Key insights include: Time-varying models capture effects demographic transition kinship networks Sex-specific models reveal important differences availability male versus female relatives Approximation methods offer practical alternatives data limited Cause--death extensions provide insights different mortality causes shape kinship structures advanced models enhance understanding gender family dynamics across demographic transitions, offering valuable tools demographic analysis, care planning, social policy development aging societies.","code":""},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_1_OneSex_TimeInvariant_AgeStage.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"One-sex time-invariant kinship model specified by age and stage","text":"previous vignettes, explored kinship models individuals classified age. However, demographic processes often influenced characteristics beyond age. example, mortality fertility rates may vary marital status, education level, health condition, parity (number children already born), socioeconomic factors. Multi-state kinship models address limitation incorporating age stage (additional states) analysis. models allow us : Account heterogeneity mortality fertility stage Track changes stage life course (e.g., transitions parity states) Analyze kin availability age stage Understand stage-specific demographic patterns shape family structures Provide nuanced estimates kinship dynamics vignette, start simple model, one-sex time-invariant multi-state kinship model, outlined Caswell (2020), using DemoKin package. ’ll focus specifically parity stage variable, allows us analyze fertility history affects kinship networks.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_1_OneSex_TimeInvariant_AgeStage.html","id":"preparation","dir":"Articles","previous_headings":"Introduction","what":"Package Installation","title":"One-sex time-invariant kinship model specified by age and stage","text":"haven’t already installed required packages previous vignettes, ’s ’ll need:","code":"# Install basic data analysis packages install.packages(\"dplyr\")     # Data manipulation install.packages(\"tidyr\")     # Data tidying install.packages(\"ggplot2\")   # Data visualization install.packages(\"knitr\")     # Document generation install.packages(\"data.table\")# Efficient data handling install.packages(\"Matrix\")    # Matrix operations  # Install DemoKin # DemoKin is available on CRAN (https://cran.r-project.org/web/packages/DemoKin/index.html),  # but we'll use the development version on GitHub (https://github.com/IvanWilli/DemoKin): install.packages(\"remotes\") remotes::install_github(\"IvanWilli/DemoKin\") library(DemoKin)  # For kinship analysis"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_1_OneSex_TimeInvariant_AgeStage.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Setting Up the Analysis Environment","title":"One-sex time-invariant kinship model specified by age and stage","text":"Let’s load necessary packages analysis:","code":"rm(list = ls()) library(dplyr)    # For data manipulation library(tidyr)    # For restructuring data library(ggplot2)  # For visualization library(knitr)    # For document generation"},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_1_OneSex_TimeInvariant_AgeStage.html","id":"understanding-stage-models","dir":"Articles","previous_headings":"Multi-State Kinship Models","what":"Understanding Stage-Structured Models","title":"One-sex time-invariant kinship model specified by age and stage","text":"traditional age-structured models, individual’s demographic rates depend age. multi-state models, expand framework consider age stage, “stage” represents another characteristic influences demographic processes. Key components multi-state models include: Age--stage-specific mortality rates: survival probabilities vary age stage Age--stage-specific fertility rates: fertility varies age stage Age-specific transition probabilities: individuals move stages age components allow us build realistic models population dynamics kinship networks accounting heterogeneity beyond age.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_1_OneSex_TimeInvariant_AgeStage.html","id":"parity-models","dir":"Articles","previous_headings":"Multi-State Kinship Models","what":"Parity as a Stage Variable","title":"One-sex time-invariant kinship model specified by age and stage","text":"vignette, ’ll focus parity (number children already born woman) stage variable. Parity particularly relevant kinship studies : Fertility rates often vary substantially parity woman’s ultimate family size affects kinship network Parity transitions follow clear rules (can increase integer values) Parity status can influence demographic processes like mortality DemoKin package includes data Slovakia 1980, ’ll use implement parity-based kinship model.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_1_OneSex_TimeInvariant_AgeStage.html","id":"data-structure","dir":"Articles","previous_headings":"Multi-State Kinship Models","what":"Understanding the Data Structure","title":"One-sex time-invariant kinship model specified by age and stage","text":"multi-state models, need several matrices specify demographic rates vary age stage. Let’s examine structure Slovakia data included DemoKin package: dataset: svk_fxs data frame fertility rates age (rows) parity stage (columns) svk_pxs contains survival probabilities age parity svk_Hxs specifies newborns enter population (case, parity 0) svk_Uxs list matrices, one age, containing probabilities transitioning parity states conditional survival parity, stages represent: Stage 1: Parity 0 (children) Stage 2: Parity 1 (one child) Stage 3: Parity 2 (two children) Stage 4: Parity 3 (three children) Stage 5: Parity 4 (four children) Stage 6: Parity 5+ (five children) Let’s examine transition matrix woman reproductive age understand women move parity states: matrix shows probabilities moving one parity state (columns) another (rows) 25-year-old woman, conditional survival. key observations: matrix shows transitions column j (starting parity) row (ending parity) diagonal elements represent probability remaining parity state Non-zero values appear lower-triangular portion parity can increase (women can’t “un-” children) Women higher parities generally lower probabilities another child","code":"# Examine fertility rates by age and parity head(svk_fxs[1:5, ]) ##     1 2 3 4 5 6 ## out 0 0 0 0 0 0 ## elt 0 0 0 0 0 0 ## elt 0 0 0 0 0 0 ## elt 0 0 0 0 0 0 ## elt 0 0 0 0 0 0 # Examine survival probabilities by age and parity head(svk_pxs[1:5, ]) ##            1       2       3       4       5       6 ## [1,] 0.98267 0.98267 0.98267 0.98267 0.98267 0.98267 ## [2,] 0.99858 0.99858 0.99858 0.99858 0.99858 0.99858 ## [3,] 0.99928 0.99928 0.99928 0.99928 0.99928 0.99928 ## [4,] 0.99962 0.99962 0.99962 0.99962 0.99962 0.99962 ## [5,] 0.99979 0.99979 0.99979 0.99979 0.99979 0.99979 # Examine birth matrix (where newborns enter the population) head(svk_Hxs[1:5, ]) ##     1 2 3 4 5 6 ## out 1 1 1 1 1 1 ## elt 0 0 0 0 0 0 ## elt 0 0 0 0 0 0 ## elt 0 0 0 0 0 0 ## elt 0 0 0 0 0 0 # Look at the structure of the transition matrices typeof(svk_Uxs) ## [1] \"list\" length(svk_Uxs) ## [1] 110 svk_Uxs[[20]]  # Transition matrix for age 20 ##           [,1]      [,2]      [,3]      [,4]      [,5] [,6] ## [1,] 0.8263006 0.0000000 0.0000000 0.0000000 0.0000000    0 ## [2,] 0.1736994 0.8050297 0.0000000 0.0000000 0.0000000    0 ## [3,] 0.0000000 0.1949703 0.8794961 0.0000000 0.0000000    0 ## [4,] 0.0000000 0.0000000 0.1205039 0.8455037 0.0000000    0 ## [5,] 0.0000000 0.0000000 0.0000000 0.1544963 0.8157141    0 ## [6,] 0.0000000 0.0000000 0.0000000 0.0000000 0.1842859    1 # Display the transition matrix for age 25 # This shows probabilities of moving between parity states svk_Uxs[[25]] ##           [,1]      [,2]       [,3]       [,4]      [,5] [,6] ## [1,] 0.8180248 0.0000000 0.00000000 0.00000000 0.0000000    0 ## [2,] 0.1819752 0.7593786 0.00000000 0.00000000 0.0000000    0 ## [3,] 0.0000000 0.2406214 0.91107756 0.00000000 0.0000000    0 ## [4,] 0.0000000 0.0000000 0.08892244 0.92006759 0.0000000    0 ## [5,] 0.0000000 0.0000000 0.00000000 0.07993241 0.8674747    0 ## [6,] 0.0000000 0.0000000 0.00000000 0.00000000 0.1325253    1"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_1_OneSex_TimeInvariant_AgeStage.html","id":"run-model-multi-state","dir":"Articles","previous_headings":"","what":"Implementing the Multi-State Model","title":"One-sex time-invariant kinship model specified by age and stage","text":"Now let’s implement multi-state kinship model using kin_multi_stage function: function computes joint age-parity distribution kin focal individual specified demographic conditions. output includes information age parity state relative.","code":"# Use birth_female=1 because fertility is for females only demokin_svk1980_caswell2020 <-    kin_multi_stage(     U = svk_Uxs,            # List of transition matrices     f = svk_fxs,            # Fertility rates by age and parity     D = svk_pxs,            # Survival probabilities by age and parity     H = svk_Hxs,            # Birth matrix     birth_female = 1,       # All births are female (one-sex model)     parity = TRUE           # Stages represent parity states   )"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_1_OneSex_TimeInvariant_AgeStage.html","id":"age-and-parity-distribution","dir":"Articles","previous_headings":"","what":"Analyzing Age and Parity Distributions","title":"One-sex time-invariant kinship model specified by age and stage","text":"Let’s examine age parity distributed among relatives. First, ’ll look age-parity distribution aunts focal individual 20 60 years old:  Interpretation: bar charts show joint distribution age parity aunts two different focal ages: Focal 20 (upper panel): Aunts mostly middle-aged (30s-50s) concentrated parities 2-3, reflecting fertility patterns generation Focal 60 (lower panel): Aunts much older (still alive) show similar parity distribution, though high-parity individuals due fertility patterns earlier cohorts red vertical line indicates Focal’s age, providing reference point comparing ages relatives. joint distribution provides richer information looking age parity alone.","code":"demokin_svk1980_caswell2020 %>%    filter(kin %in% c(\"oa\",\"ya\"), age_focal %in% c(20,60)) %>%    mutate(parity = as.integer(stage_kin)-1,          parity = case_when(parity == 5 ~ \"5+\", TRUE ~ as.character(parity))          ) %>%    group_by(age_focal, age_kin, parity) %>%    summarise(count = sum(living)) %>%    ggplot() +   geom_bar(aes(x = age_kin, y = count, fill = parity), stat = \"identity\") +   geom_vline(aes(xintercept = age_focal), col = 2) +   labs(     title = \"Age and parity distribution of aunts\",     subtitle = \"Slovakia, 1980\",     x = \"Age of aunt\",     y = \"Number of aunts\",     fill = \"Parity\"   ) +   theme_bw() +   facet_wrap(~age_focal, nrow = 2, labeller = labeller(     age_focal = c(\"20\" = \"Focal age: 20\", \"60\" = \"Focal age: 60\")   ))"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_1_OneSex_TimeInvariant_AgeStage.html","id":"kin-by-parity","dir":"Articles","previous_headings":"","what":"Kin Counts by Parity Over the Life Course","title":"One-sex time-invariant kinship model specified by age and stage","text":"Now let’s examine parity distribution different types relatives changes Focal’s life course. ’ll focus daughters mothers:  Interpretation: stacked bar charts reveal parity distribution mothers daughters evolves across Focal’s life course: mothers parity 2-3, reflecting dominant family size population Focal’s birth (age 0), mothers necessarily parity 1 higher (must least one child - Focal individual) mothers’ parity distribution shows gradual shift toward higher parities Focal young, mothers continue additional children composition relatively stable Focal reaches adulthood, slight changes due differential mortality parity Initially daughters parity 0 (childless) Focal ages, daughters transition higher parity states time Focal reaches old age, parity distribution daughters resembles overall population pattern total number increases Focal’s reproductive years end, remains stable patterns highlight intergenerational transmission fertility behaviors demographic patterns ripple kinship networks.","code":"demokin_svk1980_caswell2020 %>%    filter(kin %in% c(\"d\",\"m\")) %>%    mutate(parity = as.integer(stage_kin)-1,          parity = case_when(parity == 5 ~ \"5+\", TRUE ~ as.character(parity))) %>%    group_by(age_focal, kin, parity) %>%    summarise(count = sum(living)) %>%    DemoKin::rename_kin() %>%    ggplot() +   geom_bar(aes(x = age_focal, y = count, fill = parity), stat = \"identity\") +   labs(     title = \"Parity distribution of mothers and daughters over the life course\",     subtitle = \"Slovakia, 1980\",     x = \"Age of focal individual\",     y = \"Number of relatives\",     fill = \"Parity\"   ) +   theme_bw() +   facet_wrap(~kin_label, nrow = 2)"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_1_OneSex_TimeInvariant_AgeStage.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"One-sex time-invariant kinship model specified by age and stage","text":"vignette, ’ve explored implement one-sex time-invariant multi-state kinship models using DemoKin package. incorporating age stage (parity) analysis, ’ve gained richer insights structure kinship networks possible age alone. Key insights include: Demographic processes vary age also characteristics like parity Multi-state models allow us track joint distribution age stage among relatives parity distribution relatives evolves complex ways life course Stage transitions (e.g., parity states) key component kinship dynamics focused parity vignette, kin_multi_stage function can used state variable setting parameter parity = FALSE (default). flexibility opens numerous applications: Health status transitions: Analyzing health conditions affect affected kinship networks Educational attainment: Exploring education levels influence family formation structure Marital status: Incorporating marriage, divorce, widowhood kinship dynamics Geographical location: Modeling proximity migration within kinship networks Labor force participation: Understanding work patterns interact family structures","code":""},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Two-sex time-varying kinship model specified by age and stage","text":"final vignette, integrate elements previous tutorials comprehensive kinship model available: two-sex time-varying multi-state model. framework simultaneously accounts : Sex differences demographic rates Historical changes time Stage-based transitions (like parity education) Joint distributions age, sex, stage among relatives Building Caswell colleagues’ theoretical developments (2019, 2020, 2022; 2021), approach provides unprecedented analytical power understanding complex family structures. ’ll implement comprehensive model using kin_multi_stage_time_variant_2sex function, exploring two examples: one using parity another using educational attainment demonstrate models illuminate contemporary family dynamics ways simpler models .","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"preparation","dir":"Articles","previous_headings":"Introduction","what":"Package Installation","title":"Two-sex time-varying kinship model specified by age and stage","text":"haven’t already installed required packages previous vignettes, ’s ’ll need:","code":"# Install basic data analysis packages install.packages(\"dplyr\")     # Data manipulation install.packages(\"tidyr\")     # Data tidying install.packages(\"ggplot2\")   # Data visualization install.packages(\"knitr\")     # Document generation install.packages(\"data.table\")# Efficient data handling install.packages(\"Matrix\")    # Matrix operations  # Install DemoKin # DemoKin is available on CRAN (https://cran.r-project.org/web/packages/DemoKin/index.html),  # but we'll use the development version on GitHub (https://github.com/IvanWilli/DemoKin): install.packages(\"remotes\") remotes::install_github(\"IvanWilli/DemoKin\") library(DemoKin)"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Setting Up the Analysis Environment","title":"Two-sex time-varying kinship model specified by age and stage","text":"Let’s load necessary packages analysis:","code":"rm(list = ls()) library(dplyr)    # For data manipulation library(tidyr)    # For restructuring data library(ggplot2)  # For visualization library(knitr)    # For document generation library(Matrix)   # For matrix operations library(tictoc)   # For timing operations options(dplyr.summarise.inform = FALSE) # hide summarise output # source(\"kin_multi_stage_time_variant_2sex.R\")"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"two-sex-time-varying-multi-state","dir":"Articles","previous_headings":"","what":"Two-Sex Time-Varying Multi-State Models","title":"Two-sex time-varying kinship model specified by age and stage","text":"kin_multi_stage_time_variant_2sex function DemoKin package allows us implement comprehensive kinship model accounts sex, time, stage simultaneously. function computes stage-specific kinship networks across sexes average member population (focal) time-varying demographic rates. model estimates: number relatives type age distribution relatives sex distribution relatives stage distribution relatives distributions change life course Focal vary Focal’s birth cohort","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"model-requirements","dir":"Articles","previous_headings":"Two-Sex Time-Varying Multi-State Models","what":"Model Components and Requirements","title":"Two-sex time-varying kinship model specified by age and stage","text":"two-sex time-varying multi-state model requires several inputs: Sex-specific mortality rates stage time: survival probabilities differ males females different stages across historical periods Sex-specific fertility rates stage time: fertility patterns differ males females different stages across historical periods Sex-specific transition rates stages time: individuals move stages age, potentially differing sex Sex ratio birth: proportion births female Birth redistribution matrices: newborns distributed across stages Sex initial stage focal individual: characteristics person whose kin network ’re analyzing following sections, ’ll explore two examples model using different stage variables: parity education.","code":""},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"parity-data-preparation","dir":"Articles","previous_headings":"Example 1: Parity as the Stage Variable","what":"Data Preparation","title":"Two-sex time-varying kinship model specified by age and stage","text":"first example, ’ll use parity (number children already born) stage variable. ’ll use data United Kingdom ranging 1965 2022, sourced Human Mortality Database Office National Statistics. Due data limitations, make simplifying assumptions: Fertility rates vary time parity across sexes (“androgynous approximation”) Mortality rates vary time sex across parity classes Parity progression probabilities vary time across sexes Let’s load pre-processed UK data: lists contain period-specific demographic rates: U_mat_fem/U_mat_male: Lists matrices containing survival probabilities age (rows) parity (columns) 1965-2022 F_mat_fem/F_mat_male: Lists matrices containing fertility rates age parity T_mat_fem/T_mat_male: Lists transition matrices showing probabilities moving parity states H_mat: List matrices redistribute newborns age-class 1 parity 0","code":"# Load pre-processed data for UK F_mat_fem <- Female_parity_fert_list_UK       # Female fertility by parity F_mat_male <- Female_parity_fert_list_UK      # Male fertility (same as female due to androgynous approximation) T_mat_fem <- Parity_transfers_by_age_list_UK  # Female parity transitions T_mat_male <- Parity_transfers_by_age_list_UK # Male parity transitions (same as female) U_mat_fem <- Female_parity_mortality_list_UK  # Female survival U_mat_male <- Male_parity_mortality_list_UK   # Male survival H_mat <- Redistribution_by_parity_list_UK     # Birth redistribution matrices"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"parity-model-running","dir":"Articles","previous_headings":"Example 1: Parity as the Stage Variable","what":"Running the Parity Model","title":"Two-sex time-varying kinship model specified by age and stage","text":"Now let’s implement two-sex time-varying multi-state model parity stage variable: Note: model run takes approximately 30 minutes complete. Now need recode stage variables show meaningful parity labels:","code":"# Define time period and parameters no_years <- 40  # Run the model for 40 years (1965-2005)  # Run the model kin_out_1965_2005 <-   kin_multi_stage_time_variant_2sex(     U_list_females = U_mat_fem[1:(1+no_years)],        # Female survival matrices     U_list_males = U_mat_male[1:(1+no_years)],         # Male survival matrices     F_list_females = F_mat_fem[1:(1+no_years)],        # Female fertility matrices     F_list_males = F_mat_male[1:(1+no_years)],         # Male fertility matrices     T_list_females = T_mat_fem[1:(1+no_years)],        # Female transition matrices     T_list_males = T_mat_fem[1:(1+no_years)],          # Male transition matrices     H_list = H_mat[1:(1+no_years)],                    # Birth redistribution matrices     birth_female = 1 - 0.51,                           # UK sex ratio (49% female)     parity = TRUE,                                      # Stages represent parity     output_kin = c(\"d\", \"oa\", \"ys\", \"os\"),             # Selected kin types     summary_kin = TRUE,                                 # Produce summary statistics     sex_Focal = \"Female\",                               # Focal is female     initial_stage_Focal = 1,                            # Focal starts at parity 0     # model_years <- seq(1965, 2005, 5),                     # the sequence of years we model     output_years = c(1965, 1975, 1985, 1995, 2005)     # Selected output years   ) # After running the model, recode the parity stage values kin_out_1965_2005$kin_summary <-    kin_out_1965_2005$kin_summary %>%   mutate(stage_kin = factor(as.numeric(stage_kin) - 1,                             levels = c(0, 1, 2, 3, 4, 5),                            labels = c(\"0\", \"1\", \"2\", \"3\", \"4\", \"5+\")))  # Do the same for the kin_full dataframe if you're using it kin_out_1965_2005$kin_full <-    kin_out_1965_2005$kin_full %>%   mutate(stage_kin = factor(as.numeric(stage_kin) - 1,                             levels = c(0, 1, 2, 3, 4, 5),                            labels = c(\"0\", \"1\", \"2\", \"3\", \"4\", \"5+\")))"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"parity-kin-counts","dir":"Articles","previous_headings":"Example 1: Parity as the Stage Variable","what":"Analyzing Kin Counts by Parity","title":"Two-sex time-varying kinship model specified by age and stage","text":"Let’s examine structure output: output includes: age_focal: Age focal individual kin_stage: Stage (parity) relatives sex_kin: Sex relatives year: Calendar year observation group: Type relative (d = children, oa = older aunts/uncles, etc.) count: Expected number living relatives cohort: Birth cohort focal individual","code":"head(kin_out_1965_2005$kin_summary)"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"parity-period-analysis","dir":"Articles","previous_headings":"Example 1: Parity as the Stage Variable > Analyzing Kin Counts by Parity","what":"Period Analysis of Kin by Parity","title":"Two-sex time-varying kinship model specified by age and stage","text":"Let’s visualize distribution older aunts uncles parity different ages Focal across different calendar years. first restrict Focal’s kinship network aunts uncles older Focal’s mother setting group == “oa”. visualize marginal parity distributions kin: stage_kin, age Focal age_focal, using different color schemes. Implicit plot really plot Focal’s born different cohort – .e., 2005 panel show 50 year old Focal born 1955, 40 year old Focal born 1965. also consider kin Focal’s network, instance, offspring using group == “d”:","code":"kin_out_1965_2005$kin_summary %>%   filter(group == \"oa\") %>%   ggplot(aes(x = age_focal, y = count, color = stage_kin, fill = stage_kin)) +   geom_bar(position = \"stack\", stat = \"identity\") +   facet_grid(sex_kin ~ year) +   scale_x_continuous(breaks = c(0,10,20,30,40,50,60,70,80,90,100)) +   theme_bw() +   theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +   labs(     title = \"Parity distribution of older aunts and uncles by Focal's age\",     subtitle = \"United Kingdom, 1965-2005\",     x = \"Age of focal individual\",     y = \"Number of older aunts and uncles\",     fill = \"Parity\",     color = \"Parity\"   ) kin_out_1965_2005$kin_summary %>%   filter(group == \"d\") %>%   ggplot(aes(x = age_focal, y = count, color = stage_kin, fill = stage_kin)) +   geom_bar(position = \"stack\", stat = \"identity\") +   facet_grid(sex_kin ~ year) +   scale_x_continuous(breaks = c(0,10,20,30,40,50,60,70,80,90,100)) +   theme_bw() +   theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +   labs(     title = \"Parity distribution of children by Focal's age\",     subtitle = \"United Kingdom, 1965-2005\",     x = \"Age of focal individual\",     y = \"Number of children\",     fill = \"Parity\",     color = \"Parity\"   )"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"parity-cohort-analysis","dir":"Articles","previous_headings":"Example 1: Parity as the Stage Variable > Analyzing Kin Counts by Parity","what":"Cohort Analysis of Kin by Parity","title":"Two-sex time-varying kinship model specified by age and stage","text":"Since ran model 40 years (1965-2005), little scope view kinship cohort-specific. can however compare cohorts 40-year segments Focal’s life. , following example, consider offspring show Focals born cohort 1910, 1925, 1965: Interpretation: 1910 cohort (observed ages 55-95): offspring already completed childbearing, showing mix parity states 1925 cohort (observed ages 40-80): Offspring observed reproductive years 1965 cohort (observed ages 0-40): Initially, offspring parity 0, gradually transitioning higher parities age","code":"kin_out_1965_2005$kin_summary %>%   filter(group == \"d\", cohort %in% c(1910, 1925, 1965)) %>%   ggplot(aes(x = age_focal, y = count, color = stage_kin, fill = stage_kin)) +   geom_bar(position = \"stack\", stat = \"identity\") +   facet_grid(sex_kin ~ cohort) +   theme_bw() +   theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +   labs(     title = \"Parity distribution of offspring by birth cohort\",     subtitle = \"United Kingdom, ages observed between 1965-2005\",     x = \"Age of focal individual\",     y = \"Number of offspring\",     fill = \"Parity\",     color = \"Parity\"   )"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"parity-age-distribution","dir":"Articles","previous_headings":"Example 1: Parity as the Stage Variable","what":"Age Distribution of Kin by Parity","title":"Two-sex time-varying kinship model specified by age and stage","text":"detailed analysis, can examine age parity distribution specific relatives. Let’s look younger siblings 50-year-old Focal across different years: Notice discontinuity along x-axis age 50. reflects fact younger siblings older Focal (definition). Similarly, examine older siblings, ’ll see younger Focal. simple manipulation output data frame, can also plot age parity distribution siblings combined:","code":"kin_out_1965_2005$kin_full %>%   filter(group == \"ys\",          age_focal == 50) %>%   ggplot(aes(x = age_kin, y = count, color = stage_kin, fill = stage_kin)) +   geom_bar(position = \"stack\", stat = \"identity\") +   facet_grid(sex_kin ~ year) +   scale_x_continuous(breaks = c(0,10,20,30,40,50,60,70,80,90,100)) +   theme_bw() +   theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +   labs(     title = \"Age and parity distribution of younger siblings\",     subtitle = \"For a 50-year-old focal individual, United Kingdom, 1965-2005\",     x = \"Age of sibling\",     y = \"Number of younger siblings\",     fill = \"Parity\",     color = \"Parity\"   ) kin_out_1965_2005$kin_full %>%   filter((group == \"ys\" | group == \"os\"),          age_focal == 50) %>%   pivot_wider(names_from = group, values_from = count) %>%   mutate(count = `ys` + `os`) %>%   ggplot(aes(x = age_kin, y = count, color = stage_kin, fill = stage_kin)) +   geom_bar(position = \"stack\", stat = \"identity\") +   facet_grid(sex_kin ~ year) +   scale_x_continuous(breaks = c(0,10,20,30,40,50,60,70,80,90,100)) +   theme_bw() +   theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +   labs(     title = \"Age and parity distribution of all siblings\",     subtitle = \"For a 50-year-old focal individual, United Kingdom, 1965-2005\",     x = \"Age of sibling\",     y = \"Number of siblings\",     fill = \"Parity\",     color = \"Parity\"   )"},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"education-data-preparation","dir":"Articles","previous_headings":"Example 2: Education as the Stage Variable","what":"Data Preparation","title":"Two-sex time-varying kinship model specified by age and stage","text":"second example, ’ll use educational attainment stage variable. data Singapore ranging 2020 2090, sourced Wittgenstein Center. data aggregated 5-year age groups 5-year time intervals. simplifying assumptions make due data availability: Fertility rates vary time education identical sexes (androgynous approximation) Age-specific education transition probabilities vary time sex Educational transitions young children follow Singapore’s Compulsory Education Act Demographic rates 2020 assumed stable (time-invariant) Let’s load pre-processed Singapore data: data includes: U_mat_fem_edu/U_mat_male_edu: Lists matrices containing survival probabilities age (rows) education (columns) 2020-2090 F_mat_fem_edu/F_mat_male_edu: Lists matrices containing fertility rates age education T_mat_fem_edu/T_mat_male_edu: Lists transition matrices showing probabilities moving education states H_mat_edu: List matrices redistribute newborns age-class 1 “education” category running model, let’s examine trends data:","code":"# Calculate and plot Total Fertility Rate by education level over time tfr_data <- lapply(seq_along(F_mat_fem_edu), function(i) {   col_sums <- colSums(F_mat_fem_edu[[i]])   data.frame(     year = 2020 + (i - 1) * 5,     education = factor(colnames(F_mat_fem_edu[[i]]),                        levels = c(\"e1\", \"e2\", \"e3\", \"e4\", \"e5\", \"e6\"),                       labels = c(\"no education\", \"incomplete primary\",                                  \"primary\", \"lower secondary\",                                  \"upper secondary\", \"post-secondary\")),     tfr = col_sums   ) })  tfr_df <- do.call(rbind, tfr_data)  # Plot TFR trends ggplot(tfr_df, aes(x = year, y = tfr, color = education, group = education)) +   geom_line(size = 1) +   geom_point() +   theme_minimal() +   labs(     title = \"Total Fertility Rate by Education Over Time\",     x = \"Year\",     y = \"TFR\",     color = \"Education\"   )"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"education-model-running","dir":"Articles","previous_headings":"Example 2: Education as the Stage Variable","what":"Running the Education Model","title":"Two-sex time-varying kinship model specified by age and stage","text":"Now let’s implement two-sex time-varying multi-state model education stage variable: Note: model run takes approximately 3 minutes complete. Now need recode stage variables show meaningful educational labels convert years/ages real values (since used 5-year intervals):","code":"# Define time period and parameters time_range <- seq(2020, 2090, 5) no_years <- length(time_range) - 1 output_year <- seq(1, no_years + 1, 1)  # Run the model kin_out_2020_2090 <-   kin_multi_stage_time_variant_2sex(     U_list_females = U_mat_fem_edu[1:(1+no_years)],     # Female survival matrices     U_list_males = U_mat_male_edu[1:(1+no_years)],      # Male survival matrices     F_list_females = F_mat_fem_edu[1:(1+no_years)],     # Female fertility matrices     F_list_males = F_mat_male_edu[1:(1+no_years)],      # Male fertility matrices     T_list_females = T_mat_fem_edu[1:(1+no_years)],     # Female transition matrices     T_list_males = T_mat_fem_edu[1:(1+no_years)],       # Male transition matrices     H_list = H_mat_edu[1:(1+no_years)],                 # Birth redistribution matrices     birth_female = 1/(1.06+1),                          # Singapore sex ratio (48.5% female)     parity = FALSE,                                      # Stages represent education     summary_kin = TRUE,                                  # Produce summary statistics     sex_Focal = \"Female\",                                # Focal is female     initial_stage_Focal = 1,                             # Focal starts with no education     # model_years = output_year,                            # the sequence of years we model     output_years = output_year                           # All years   ) ## 46.554 sec elapsed # Recode year and age variables to show correct values kin_out_2020_2090$kin_summary <-    kin_out_2020_2090$kin_summary %>%   mutate(year = (year-1)*5+min(time_range),          age_focal = age_focal*5,          cohort = year - age_focal,          stage_kin = factor(stage_kin, levels = c(1, 2, 3, 4, 5, 6),                        labels = c(                          \"no education\",                          \"incomplete primary\",                          \"primary\",                          \"lower secondary\",                          \"upper secondary\",                          \"post-secondary\"                        )))  kin_out_2020_2090$kin_full <-    kin_out_2020_2090$kin_full %>%   mutate(year = (year-1)*5+min(time_range),          age_focal = age_focal*5,          age_kin = age_kin*5,          cohort = year - age_focal,          stage_kin = factor(stage_kin, levels = c(1, 2, 3, 4, 5, 6),                        labels = c(                          \"no education\",                          \"incomplete primary\",                          \"primary\",                          \"lower secondary\",                          \"upper secondary\",                          \"post-secondary\"                        )))"},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"education-cohort-analysis","dir":"Articles","previous_headings":"Example 2: Education as the Stage Variable > Analyzing Kin by Educational Attainment","what":"Cohort Analysis of Kin by Education","title":"Two-sex time-varying kinship model specified by age and stage","text":"First, let’s visualize total number living kin educational attainment woman born 2020 Singapore:  Now let’s look specific types relatives:  Interpretation visualization captures educational expansion transforms family networks, showing increasing educational diversity across generations Singapore: total number living relatives peaks around age 40-50 Relatives upper secondary education (blue) constitute largest proportion kinship network educational composition relatives changes dynamically across life course younger ages, relatives lower educational attainment. Focal ages, proportion higher-educated relatives (green, yellow, red categories) increases Let’s examine age educational distribution key relatives focal individual 60 years old:  Interpretation: visualization reveals evolving educational composition different types relatives across life course woman born 2020 Singapore: Children (d): Educational attainment increases Focal’s age, showing shift towards higher education levels Grandchildren (gd): Emerge later life diverse educational profile Grandparents (gm): Predominantly upper secondary (blue) lower secondary (teal) education Parents (m): Similar grandparents, concentration upper secondary education","code":"kin_out_2020_2090$kin_summary %>%   # Exclude Focal from the analysis   filter(group != \"Focal\") %>%    filter(cohort == 2020) %>%   rename(kin = group) %>%    # rename_kin(sex = \"2sex\") %>%    summarise(count = sum(count), .by = c(stage_kin, age_focal)) %>%   ggplot(aes(x = age_focal, y = count, fill = stage_kin)) +   geom_area(colour = \"black\") +   labs(     title = \"Total living kin by educational attainment over the life course\",     subtitle = \"For a woman born in 2020, Singapore\",     y = \"Expected number of living kin\",     x = \"Age of focal individual\",     fill = \"Educational attainment\"   ) +   theme_bw() +   theme(legend.position = \"bottom\") kin_out_2020_2090$kin_summary %>%   filter(group %in% c(\"d\", \"gd\", \"m\", \"gm\")) %>%    filter(cohort == 2020) %>%   rename(kin = group) %>%    # rename_kin(sex = \"2sex\") %>%    summarise(count = sum(count), .by = c(kin, stage_kin, age_focal)) %>%   ggplot(aes(x = age_focal, y = count, fill = stage_kin)) +   geom_area(colour = \"black\") +   labs(     title = \"Living kin by educational attainment over the life course\",     subtitle = \"For a woman born in 2020, Singapore\",     y = \"Expected number of living kin\",     x = \"Age of focal individual\",     fill = \"Educational attainment\"   ) +   facet_wrap(. ~ kin) +   theme_bw() +   theme(legend.position = \"bottom\") kin_out_2020_2090$kin_full %>%   filter(     group %in%  c(\"d\", \"gd\", \"m\", \"gm\"),     age_focal == 60,     cohort == 2020   ) %>%   rename(kin = group) %>%    # rename_kin(\"2sex\") %>%    ggplot(aes(x = age_kin, y = count, color = stage_kin, fill = stage_kin)) +   geom_bar(position = \"stack\", stat = \"identity\") +   scale_x_continuous(breaks = c(0,10,20,30,40,50,60,70,80,90,100)) +   labs(     title = \"Age and educational distribution of key relatives\",     subtitle = \"For a 60-year-old woman born in 2020, Singapore\",     x = \"Age of relative\",     y = \"Number of relatives\",     fill = \"Educational attainment\",     color = \"Educational attainment\"   ) +   facet_wrap(. ~ kin) +   theme_bw() +   theme(     axis.text.x = element_text(angle = 90, vjust = 0.5),     legend.position = \"bottom\"   )"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"education-period-analysis","dir":"Articles","previous_headings":"Example 2: Education as the Stage Variable > Analyzing Kin by Educational Attainment","what":"Period Analysis of Kin by Education","title":"Two-sex time-varying kinship model specified by age and stage","text":"Now let’s examine educational composition specific relatives changes time. First, let’s look educational attainment descendants (children grandchildren) 60-year-old women across different calendar years:  Interpretation: Children (d): Concentrated ages 30-50, upper secondary education (blue) prevalent Grandchildren (gd): Mostly young (20), emerging educational diversity Grandparents (gm): longer living point Parents (m): Clustered around ages 80-90, upper secondary lower secondary education dominating","code":"kin_out_2020_2090$kin_summary %>%   filter(     group %in% c(\"d\", \"gd\"),     age_focal == 60   ) %>%    rename(kin = group) %>%    # rename_kin(sex = \"2sex\") %>%    summarise(count = sum(count), .by = c(stage_kin, kin, year)) %>%   ggplot(aes(x = year, y = count, fill = stage_kin)) +   geom_area(colour = \"black\") +   labs(     title = \"Educational attainment of descendants over time\",     subtitle = \"For women aged 60, Singapore, 2020-2090\",     y = \"Expected number of descendants\",     x = \"Year\",     fill = \"Educational attainment\"   ) +   facet_grid(. ~ kin) +   theme_bw() +   theme(legend.position = \"bottom\")"},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"limitations","dir":"Articles","previous_headings":"","what":"Limitations and Assumptions","title":"Two-sex time-varying kinship model specified by age and stage","text":"implementing models, ’ve made several simplifying assumptions due data limitations: UK parity model: Fertility rates vary time parity across sexes Mortality rates vary time sex across parity classes Parity progression probabilities vary time across sexes Singapore education model: Fertility rates vary time education identical sexes Age-specific education transition probabilities vary time sex Educational transitions young children follow Singapore’s Compulsory Education Act Demographic rates 2020 assumed stable (time-invariant) assumptions kept mind interpreting results.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/articles/2_2_TwoSex_TimeVarying_AgeStage.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Two-sex time-varying kinship model specified by age and stage","text":"vignette, ’ve implemented two-sex time-varying multi-state kinship models—comprehensive demographic kinship framework currently available. integrating age, sex, time, stage dimensions, models provide unprecedented insights family structures evolution. two examples demonstrated analytical power integrated approach: parity example revealed reproductive patterns shape family structures differently males females across historical periods education example showed educational expansion transforms kinship networks, creating increasingly educated family systems time comprehensive models numerous applications across disciplines: Understanding intergenerational transmission socioeconomic status Analyzing care needs support networks diverse populations Projecting family structures might evolve different demographic scenarios Exploring education, health, marriage, characteristics intersect kinship","code":""},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Iván Williams. Maintainer. Diego Alburez-Gutierrez. Author. Xi Song. Contributor. Caswell Hal. Contributor.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Alburez-Gutierrez D (2025). DemoKin: Estimate Population Kin Distribution. R package version 1.0.3, https://github.com/IvanWilli/DemoKin.","code":"@Manual{,   title = {DemoKin: Estimate Population Kin Distribution},   author = {Diego Alburez-Gutierrez},   year = {2025},   note = {R package version 1.0.3},   url = {https://github.com/IvanWilli/DemoKin}, }"},{"path":"https://ivanwilli.github.io/DemoKin/index.html","id":"demokin","dir":"","previous_headings":"","what":"Estimate Population Kin Distribution","title":"Estimate Population Kin Distribution","text":"DemoKin R package demographic analysis kinship networks using matrix-based models. implements methods developed Caswell colleagues estimating number age distribution relatives various demographic assumptions.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Estimate Population Kin Distribution","text":"Estimate kin counts age distributions various types relatives Support one-sex two-sex models Time-invariant time-varying approaches Multi-state models incorporating additional variables like parity education Visualization tools kinship networks","code":""},{"path":"https://ivanwilli.github.io/DemoKin/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Estimate Population Kin Distribution","text":"can install development version DemoKin GitHub:","code":"# install.packages(\"remotes\") remotes::install_github(\"IvanWilli/DemoKin\") library(DemoKin)"},{"path":"https://ivanwilli.github.io/DemoKin/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Estimate Population Kin Distribution","text":"’s basic example use DemoKin:","code":"# Run a one-sex time-invariant kinship model using Swedish data from 2015 kin_results <- kin(   p = swe_px[,\"2015\"],        # Survival probabilities   f = swe_asfr[,\"2015\"],      # Fertility rates   time_invariant = TRUE       # Use time-invariant model )  # Visualize the expected number of living relatives by age kin_results$kin_summary %>%   rename_kin() %>%   ggplot2::ggplot(ggplot2::aes(age_focal, count_living)) +   ggplot2::geom_line() +   ggplot2::facet_wrap(~kin_label, scales = \"free_y\") +   ggplot2::labs(     title = \"Expected number of living relatives by age\",     x = \"Age of focal individual\",     y = \"Number of relatives\"   ) #> Joining with `by = join_by(kin)`"},{"path":"https://ivanwilli.github.io/DemoKin/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Estimate Population Kin Distribution","text":"detailed documentation, please visit DemoKin website. site includes several vignettes demonstrating different types kinship models:","code":""},{"path":"https://ivanwilli.github.io/DemoKin/index.html","id":"models-stratified-by-age","dir":"","previous_headings":"Documentation","what":"Models stratified by age","title":"Estimate Population Kin Distribution","text":"One-sex time-invariant kinship model One-sex time-varying kinship model Two-sex time-invariant kinship model Two-sex time-varying kinship model","code":""},{"path":"https://ivanwilli.github.io/DemoKin/index.html","id":"models-stratified-by-age-and-stage","dir":"","previous_headings":"Documentation","what":"Models stratified by age and stage","title":"Estimate Population Kin Distribution","text":"One-sex time-invariant multi-state model Two-sex time-varying multi-state model","code":""},{"path":"https://ivanwilli.github.io/DemoKin/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Estimate Population Kin Distribution","text":"Williams, Iván; Alburez-Gutierrez, Diego; DemoKin team. (2021) DemoKin: R package implement demographic matrix kinship models. URL: https://github.com/IvanWilli/DemoKin.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/index.html","id":"acknowledgments","dir":"","previous_headings":"","what":"Acknowledgments","title":"Estimate Population Kin Distribution","text":"thank Silvia Leek Max Planck Institute Demographic Research designing DemoKin logo. logo includes elements taken adapted file, originally Ansunando, CC -SA 4.0 via Wikimedia Commons. Sha Jiang provided useful comments improving package.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/index.html","id":"get-involved","dir":"","previous_headings":"","what":"Get involved!","title":"Estimate Population Kin Distribution","text":"DemoKin constant development. ’re interested contributing, please get touch, create issue, submit pull request. look forward hearing !","code":""},{"path":"https://ivanwilli.github.io/DemoKin/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Estimate Population Kin Distribution","text":"Caswell, H. (2019). formal demography kinship: matrix formulation. Demographic Research, 41, 679-712. Caswell, H. (2020). formal demography kinship II: Multistate models, parity, sibship. Demographic Research, 42, 1097-1144. Caswell, H. & Song, X. (2021). formal demography kinship III: Kinship dynamics time-varying demographic rates. Demographic Research, 45, 517-546. Caswell, H. & Song, X. (2022). formal demography kinship IV: Two-sex models approximations. Demographic Research, 47, 359-396.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Estimate Population Kin Distribution","text":"project licensed MIT License - see LICENSE file details.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/F_mat_fem_edu.html","id":null,"dir":"Reference","previous_headings":"","what":"Singapore: Lists of matrices containing fertility rates by age and education. Females — F_mat_fem_edu","title":"Singapore: Lists of matrices containing fertility rates by age and education. Females — F_mat_fem_edu","text":"Singapore: Lists matrices containing fertility rates age education. Females","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/F_mat_fem_edu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Singapore: Lists of matrices containing fertility rates by age and education. Females — F_mat_fem_edu","text":"","code":"F_mat_fem_edu"},{"path":"https://ivanwilli.github.io/DemoKin/reference/F_mat_fem_edu.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Singapore: Lists of matrices containing fertility rates by age and education. Females — F_mat_fem_edu","text":"data aggregated 5-year age groups 5-year time intervals","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/F_mat_fem_edu.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Singapore: Lists of matrices containing fertility rates by age and education. Females — F_mat_fem_edu","text":"Wittgenstein Center","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/F_mat_male_edu.html","id":null,"dir":"Reference","previous_headings":"","what":"Singapore: Lists of matrices containing fertility rates by age and education. Males — F_mat_male_edu","title":"Singapore: Lists of matrices containing fertility rates by age and education. Males — F_mat_male_edu","text":"Singapore: Lists matrices containing fertility rates age education. Males","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/F_mat_male_edu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Singapore: Lists of matrices containing fertility rates by age and education. Males — F_mat_male_edu","text":"","code":"F_mat_male_edu"},{"path":"https://ivanwilli.github.io/DemoKin/reference/F_mat_male_edu.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Singapore: Lists of matrices containing fertility rates by age and education. Males — F_mat_male_edu","text":"data aggregated 5-year age groups 5-year time intervals","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/F_mat_male_edu.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Singapore: Lists of matrices containing fertility rates by age and education. Males — F_mat_male_edu","text":"Wittgenstein Center","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Female_parity_fert_list_UK.html","id":null,"dir":"Reference","previous_headings":"","what":"UK female fertility from 1965 to 2022 — Female_parity_fert_list_UK","title":"UK female fertility from 1965 to 2022 — Female_parity_fert_list_UK","text":"UK female fertility 1965 2022","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Female_parity_fert_list_UK.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"UK female fertility from 1965 to 2022 — Female_parity_fert_list_UK","text":"","code":"Female_parity_fert_list_UK"},{"path":"https://ivanwilli.github.io/DemoKin/reference/Female_parity_fert_list_UK.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"UK female fertility from 1965 to 2022 — Female_parity_fert_list_UK","text":"list age stage matrices, entries give female fert. List starting 1965 ending 2022.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Female_parity_fert_list_UK.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"UK female fertility from 1965 to 2022 — Female_parity_fert_list_UK","text":"HFD ONS","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Female_parity_mortality_list_UK.html","id":null,"dir":"Reference","previous_headings":"","what":"UK female parity mortality from 1965 to 2022 — Female_parity_mortality_list_UK","title":"UK female parity mortality from 1965 to 2022 — Female_parity_mortality_list_UK","text":"UK female parity mortality 1965 2022","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Female_parity_mortality_list_UK.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"UK female parity mortality from 1965 to 2022 — Female_parity_mortality_list_UK","text":"","code":"Female_parity_mortality_list_UK"},{"path":"https://ivanwilli.github.io/DemoKin/reference/Female_parity_mortality_list_UK.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"UK female parity mortality from 1965 to 2022 — Female_parity_mortality_list_UK","text":"list age stage matrices, entries give female parity mortality List starting 1965 ending 2022.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Female_parity_mortality_list_UK.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"UK female parity mortality from 1965 to 2022 — Female_parity_mortality_list_UK","text":"HFD ONS","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/H_mat_edu.html","id":null,"dir":"Reference","previous_headings":"","what":"Singapore: List of matrices that redistribute newborns to age-class 1 and ","title":"Singapore: List of matrices that redistribute newborns to age-class 1 and ","text":"Singapore: List matrices redistribute newborns age-class 1 \"education\" category","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/H_mat_edu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Singapore: List of matrices that redistribute newborns to age-class 1 and ","text":"","code":"H_mat_edu"},{"path":"https://ivanwilli.github.io/DemoKin/reference/H_mat_edu.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Singapore: List of matrices that redistribute newborns to age-class 1 and ","text":"data aggregated 5-year age groups 5-year time intervals","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/H_mat_edu.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Singapore: List of matrices that redistribute newborns to age-class 1 and ","text":"Wittgenstein Center","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Male_parity_mortality_list_UK.html","id":null,"dir":"Reference","previous_headings":"","what":"UK male parity mortality from 1965 to 2022 — Male_parity_mortality_list_UK","title":"UK male parity mortality from 1965 to 2022 — Male_parity_mortality_list_UK","text":"UK male parity mortality 1965 2022","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Male_parity_mortality_list_UK.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"UK male parity mortality from 1965 to 2022 — Male_parity_mortality_list_UK","text":"","code":"Male_parity_mortality_list_UK"},{"path":"https://ivanwilli.github.io/DemoKin/reference/Male_parity_mortality_list_UK.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"UK male parity mortality from 1965 to 2022 — Male_parity_mortality_list_UK","text":"list age stage matrices, entries give male parity mortality List starting 1965 ending 2022.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Male_parity_mortality_list_UK.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"UK male parity mortality from 1965 to 2022 — Male_parity_mortality_list_UK","text":"HFD ONS","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Parity_transfers_by_age_list_UK.html","id":null,"dir":"Reference","previous_headings":"","what":"UK female parity transitions from 1965 to 2022 — Parity_transfers_by_age_list_UK","title":"UK female parity transitions from 1965 to 2022 — Parity_transfers_by_age_list_UK","text":"UK female parity transitions 1965 2022","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Parity_transfers_by_age_list_UK.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"UK female parity transitions from 1965 to 2022 — Parity_transfers_by_age_list_UK","text":"","code":"Parity_transfers_by_age_list_UK"},{"path":"https://ivanwilli.github.io/DemoKin/reference/Parity_transfers_by_age_list_UK.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"UK female parity transitions from 1965 to 2022 — Parity_transfers_by_age_list_UK","text":"list age stage matrices, entries give female parity transitions. List starting 1965 ending 2022.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Parity_transfers_by_age_list_UK.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"UK female parity transitions from 1965 to 2022 — Parity_transfers_by_age_list_UK","text":"HFD ONS","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Redistribution_by_parity_list_UK.html","id":null,"dir":"Reference","previous_headings":"","what":"UK parity assign parity at birth — Redistribution_by_parity_list_UK","title":"UK parity assign parity at birth — Redistribution_by_parity_list_UK","text":"UK parity assign parity birth","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Redistribution_by_parity_list_UK.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"UK parity assign parity at birth — Redistribution_by_parity_list_UK","text":"","code":"Redistribution_by_parity_list_UK"},{"path":"https://ivanwilli.github.io/DemoKin/reference/Redistribution_by_parity_list_UK.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"UK parity assign parity at birth — Redistribution_by_parity_list_UK","text":"list matrices redistributes newborns age-class 1 parity 0. time-variation.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/Redistribution_by_parity_list_UK.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"UK parity assign parity at birth — Redistribution_by_parity_list_UK","text":"None","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/T_mat_fem_edu.html","id":null,"dir":"Reference","previous_headings":"","what":"Singapore: Lists of transition matrices showing probabilities of moving between education states. Females — T_mat_fem_edu","title":"Singapore: Lists of transition matrices showing probabilities of moving between education states. Females — T_mat_fem_edu","text":"Singapore: Lists transition matrices showing probabilities moving education states. Females","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/T_mat_fem_edu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Singapore: Lists of transition matrices showing probabilities of moving between education states. Females — T_mat_fem_edu","text":"","code":"T_mat_fem_edu"},{"path":"https://ivanwilli.github.io/DemoKin/reference/T_mat_fem_edu.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Singapore: Lists of transition matrices showing probabilities of moving between education states. Females — T_mat_fem_edu","text":"data aggregated 5-year age groups 5-year time intervals","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/T_mat_fem_edu.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Singapore: Lists of transition matrices showing probabilities of moving between education states. Females — T_mat_fem_edu","text":"Wittgenstein Center","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/T_mat_male_edu.html","id":null,"dir":"Reference","previous_headings":"","what":"Singapore: Lists of transition matrices showing probabilities of moving between education states. Males — T_mat_male_edu","title":"Singapore: Lists of transition matrices showing probabilities of moving between education states. Males — T_mat_male_edu","text":"Singapore: Lists transition matrices showing probabilities moving education states. Males","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/T_mat_male_edu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Singapore: Lists of transition matrices showing probabilities of moving between education states. Males — T_mat_male_edu","text":"","code":"T_mat_male_edu"},{"path":"https://ivanwilli.github.io/DemoKin/reference/T_mat_male_edu.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Singapore: Lists of transition matrices showing probabilities of moving between education states. Males — T_mat_male_edu","text":"data aggregated 5-year age groups 5-year time intervals","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/T_mat_male_edu.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Singapore: Lists of transition matrices showing probabilities of moving between education states. Males — T_mat_male_edu","text":"Wittgenstein Center","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/U_caswell_2021.html","id":null,"dir":"Reference","previous_headings":"","what":"Historic and projected survival ratios from Sweden used in Caswell (2021) — U_caswell_2021","title":"Historic and projected survival ratios from Sweden used in Caswell (2021) — U_caswell_2021","text":"Historic projected survival ratios Sweden used Caswell (2021)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/U_caswell_2021.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Historic and projected survival ratios from Sweden used in Caswell (2021) — U_caswell_2021","text":"","code":"U_caswell_2021"},{"path":"https://ivanwilli.github.io/DemoKin/reference/U_caswell_2021.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Historic and projected survival ratios from Sweden used in Caswell (2021) — U_caswell_2021","text":"matrix U years cols ages rows.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/U_caswell_2021.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Historic and projected survival ratios from Sweden used in Caswell (2021) — U_caswell_2021","text":"Caswell (2019)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/U_mat_fem_edu.html","id":null,"dir":"Reference","previous_headings":"","what":"Singapore: Lists of matrices containing survival probabilities by age (rows) and education (columns) from 2020-2090. Females — U_mat_fem_edu","title":"Singapore: Lists of matrices containing survival probabilities by age (rows) and education (columns) from 2020-2090. Females — U_mat_fem_edu","text":"Singapore: Lists matrices containing survival probabilities age (rows) education (columns) 2020-2090. Females","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/U_mat_fem_edu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Singapore: Lists of matrices containing survival probabilities by age (rows) and education (columns) from 2020-2090. Females — U_mat_fem_edu","text":"","code":"U_mat_fem_edu"},{"path":"https://ivanwilli.github.io/DemoKin/reference/U_mat_fem_edu.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Singapore: Lists of matrices containing survival probabilities by age (rows) and education (columns) from 2020-2090. Females — U_mat_fem_edu","text":"data aggregated 5-year age groups 5-year time intervals","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/U_mat_fem_edu.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Singapore: Lists of matrices containing survival probabilities by age (rows) and education (columns) from 2020-2090. Females — U_mat_fem_edu","text":"Wittgenstein Center","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/U_mat_male_edu.html","id":null,"dir":"Reference","previous_headings":"","what":"Singapore: Lists of matrices containing survival probabilities by age (rows) and education (columns) from 2020-2090. Males — U_mat_male_edu","title":"Singapore: Lists of matrices containing survival probabilities by age (rows) and education (columns) from 2020-2090. Males — U_mat_male_edu","text":"Singapore: Lists matrices containing survival probabilities age (rows) education (columns) 2020-2090. Males","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/U_mat_male_edu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Singapore: Lists of matrices containing survival probabilities by age (rows) and education (columns) from 2020-2090. Males — U_mat_male_edu","text":"","code":"U_mat_male_edu"},{"path":"https://ivanwilli.github.io/DemoKin/reference/U_mat_male_edu.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Singapore: Lists of matrices containing survival probabilities by age (rows) and education (columns) from 2020-2090. Males — U_mat_male_edu","text":"data aggregated 5-year age groups 5-year time intervals","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/U_mat_male_edu.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Singapore: Lists of matrices containing survival probabilities by age (rows) and education (columns) from 2020-2090. Males — U_mat_male_edu","text":"Wittgenstein Center","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/all_kin_dy.html","id":null,"dir":"Reference","previous_headings":"","what":"Title time invariant two-sex multi-state kin projections — all_kin_dy","title":"Title time invariant two-sex multi-state kin projections — all_kin_dy","text":"Title time invariant two-sex multi-state kin projections","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/all_kin_dy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title time invariant two-sex multi-state kin projections — all_kin_dy","text":"","code":"all_kin_dy(   Uf,   Um,   Ff,   Fm,   alpha,   na,   ns,   Parity,   sex_Focal,   Initial_stage_Focal )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/all_kin_dy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title time invariant two-sex multi-state kin projections — all_kin_dy","text":"Uf matrix (block structured). transfers female individuals across stages advances age (conditional survial) Um matrix (block structured). transfers male individuals across stages advances age (conditional survial) Ff matrix (block structured). accounts female reproduction, assigns newborns given age*stage Fm matrix (block structured). accounts male reproduction; assigns newborns age-class, stage alpha scalar. birth ratio (male:female) na scalar. number ages. ns scalar. number stages. Parity logical. true omit mothers parity 0, re-scale mother's age*stage parenting sex_Focal logical. Female Male Initial_stage_Focal numeric. natural number 1,2,3,4,...","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/all_kin_dy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title time invariant two-sex multi-state kin projections — all_kin_dy","text":"list matrices. list entry represents particular kin. kin chacacterised matrix dimension: nrow = 2* na * ns (2-sex age-stage structured) ncol = na (Focal's age) yielding age*stage distribution kin age Focal","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/all_kin_dy_TV.html","id":null,"dir":"Reference","previous_headings":"","what":"Title time-variant two-sex multi-state kin projections — all_kin_dy_TV","title":"Title time-variant two-sex multi-state kin projections — all_kin_dy_TV","text":"Title time-variant two-sex multi-state kin projections","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/all_kin_dy_TV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title time-variant two-sex multi-state kin projections — all_kin_dy_TV","text":"","code":"all_kin_dy_TV(   Uf,   Um,   Ff,   Fm,   alpha,   na,   ns,   Parity,   sex_Focal,   Initial_stage_Focal,   previous_kin_Focal,   prev_kin_children,   prev_kin_grandchildren,   prev_kin_greatgrandchildren,   prev_kin_parents,   prev_kin_grand_parents,   prev_kin_great_grand_parents,   prev_kin_older_sibs,   prev_kin_younger_sibs,   prev_kin_older_niece_nephew,   prev_kin_younger_niece_nephew,   prev_kin_older_aunts_uncles,   prev_kin_younger_aunts_uncles,   prev_kin_older_cousins,   prev_kin_younger_cousins,   previous_population_age_stage_structure )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/all_kin_dy_TV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title time-variant two-sex multi-state kin projections — all_kin_dy_TV","text":"Uf matrix (block structured). transfers female individuals across stages advances age (conditional survial) Um matrix (block structured). transfers male individuals across stages advances age (conditional survial) Ff matrix (block structured). accounts female reproduction, assigns newborns given age*stage Fm matrix (block structured). accounts male reproduction; assigns newborns age-class, stage alpha scalar. birth ratio (male:female) na scalar. number ages. ns scalar. number stages. Parity logical. true omit mothers parity 0, re-scale mother's age*stage parenting sex_Focal logical. Female Male Initial_stage_Focal numeric. natural number 1,2,3,4,... previous_kin_Focal matrix. last years kinship output. prev_kin_children matrix. last years kinship output. prev_kin_grandchildren matrix. last years kinship output. prev_kin_greatgrandchildren matrix. last years kinship output. prev_kin_parents matrix. last years kinship output. prev_kin_grand_parents matrix. last years kinship output. prev_kin_older_sibs matrix. last years kinship output. prev_kin_younger_sibs matrix. last years kinship output. prev_kin_older_niece_nephew matrix. last years kinship output. prev_kin_younger_niece_nephew matrix. last years kinship output. prev_kin_older_aunts_uncles matrix. last years kinship output. prev_kin_younger_aunts_uncles matrix. last years kinship output. prev_kin_older_cousins matrix. last years kinship output. prev_kin_younger_cousins matrix. last years kinship output. previous_population_age_stage_structure vector. transient \"population structure\" (age*stage distributed)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/all_kin_dy_TV.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title time-variant two-sex multi-state kin projections — all_kin_dy_TV","text":"list matrices. list entry represents particular kin. kin chacacterised matrix dimension: nrow = 2* na * ns (2-sex age-stage structured) ncol = na (Focal's age) yielding age*stage distribution kin age Focal","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/create_cumsum_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Title Accumulated kin by each age of Focal, for each time period, and cohort of birth — create_cumsum_df","title":"Title Accumulated kin by each age of Focal, for each time period, and cohort of birth — create_cumsum_df","text":"Title Accumulated kin age Focal, time period, cohort birth","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/create_cumsum_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title Accumulated kin by each age of Focal, for each time period, and cohort of birth — create_cumsum_df","text":"","code":"create_cumsum_df(   kin_matrix_lists,   kin_names,   years,   start_year,   na,   ns,   specific_kin = NULL )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/create_cumsum_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title Accumulated kin by each age of Focal, for each time period, and cohort of birth — create_cumsum_df","text":"kin_matrix_lists list lists kin matrices: list( list(X_focal), list(X_parents), ... ). Outer list length 14  = number kin. Inner lists lenght = timescale list(X_focal) = list(X_focalyear1,X_focalyear2,...,X_focalyearlast) kin_names list characters. Corresponding lists: list(\"F\",\"m\",....) years vector. timescale implement kinship model. start_year . First year varying vital rates (e.g., years = 1990:2000 start_year = 1990) na numeric. Number ages. ns numeric. Number stages. specific_kin character. names kin wish analyse, e.g., list(\"os\",\"ys\"). null returns 14.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/create_cumsum_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title Accumulated kin by each age of Focal, for each time period, and cohort of birth — create_cumsum_df","text":"data frame gives age Focal year timescale, Focal's experienced number kin demarcated stages (summed ages)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/create_full_dists_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Title joint age*stage distributions of kin by each age of Focal, for each time period, and cohort of birth — create_full_dists_df","title":"Title joint age*stage distributions of kin by each age of Focal, for each time period, and cohort of birth — create_full_dists_df","text":"Title joint age*stage distributions kin age Focal, time period, cohort birth","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/create_full_dists_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title joint age*stage distributions of kin by each age of Focal, for each time period, and cohort of birth — create_full_dists_df","text":"","code":"create_full_dists_df(   kin_matrix_lists,   kin_names,   years,   start_year,   na,   ns,   specific_kin = NULL )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/create_full_dists_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title joint age*stage distributions of kin by each age of Focal, for each time period, and cohort of birth — create_full_dists_df","text":"kin_matrix_lists list lists kin matrices: list( list(X_focal), list(X_parents), ... ). Outer list length 14  = number kin. Inner lists lenght = timescale list(X_focal) = list(X_focalyear1,X_focalyear2,...,X_focalyearlast) kin_names list characters. Corresponding lists: list(\"F\",\"m\",....) years vector. timescale implement kinship model. start_year . First year varying vital rates (e.g., years = 1990:2000 start_year = 1990) na numeric. Number ages. ns numeric. Number stages. specific_kin character. names kin wish analyse, e.g., list(\"os\",\"ys\"). null returns 14.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/create_full_dists_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title joint age*stage distributions of kin by each age of Focal, for each time period, and cohort of birth — create_full_dists_df","text":"data frame gives age Focal year timescale, full age*stage dist kin","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/demokin_codes.html","id":null,"dir":"Reference","previous_headings":"","what":"DemoKin codes, Caswell (2020) codes, and useful labels. — demokin_codes","title":"DemoKin codes, Caswell (2020) codes, and useful labels. — demokin_codes","text":"DemoKin codes, Caswell (2020) codes, useful labels.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/demokin_codes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DemoKin codes, Caswell (2020) codes, and useful labels. — demokin_codes","text":"","code":"demokin_codes"},{"path":"https://ivanwilli.github.io/DemoKin/reference/demokin_codes.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"DemoKin codes, Caswell (2020) codes, and useful labels. — demokin_codes","text":"data.frame codes labels distinction kin types.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/f_caswell_2021.html","id":null,"dir":"Reference","previous_headings":"","what":"Historic and projected fertility ratios from Sweden used in Caswell (2021) — f_caswell_2021","title":"Historic and projected fertility ratios from Sweden used in Caswell (2021) — f_caswell_2021","text":"Historic projected fertility ratios Sweden used Caswell (2021)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/f_caswell_2021.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Historic and projected fertility ratios from Sweden used in Caswell (2021) — f_caswell_2021","text":"","code":"f_caswell_2021"},{"path":"https://ivanwilli.github.io/DemoKin/reference/f_caswell_2021.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Historic and projected fertility ratios from Sweden used in Caswell (2021) — f_caswell_2021","text":"matrix f years cols ages rows.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/f_caswell_2021.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Historic and projected fertility ratios from Sweden used in Caswell (2021) — f_caswell_2021","text":"Caswell (2019)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/fra_asfr_sex.html","id":null,"dir":"Reference","previous_headings":"","what":"Fertility for France (2012) by sex in Caswell (2022). — fra_asfr_sex","title":"Fertility for France (2012) by sex in Caswell (2022). — fra_asfr_sex","text":"Fertility France (2012) sex Caswell (2022).","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/fra_asfr_sex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fertility for France (2012) by sex in Caswell (2022). — fra_asfr_sex","text":"","code":"fra_asfr_sex"},{"path":"https://ivanwilli.github.io/DemoKin/reference/fra_asfr_sex.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Fertility for France (2012) by sex in Caswell (2022). — fra_asfr_sex","text":"data.frame age specific fertility rates age sex.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/fra_asfr_sex.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Fertility for France (2012) by sex in Caswell (2022). — fra_asfr_sex","text":"Caswell (2022)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/fra_surv_sex.html","id":null,"dir":"Reference","previous_headings":"","what":"Survival probability for France (2012) by sex in Caswell (2022). — fra_surv_sex","title":"Survival probability for France (2012) by sex in Caswell (2022). — fra_surv_sex","text":"Survival probability France (2012) sex Caswell (2022).","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/fra_surv_sex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Survival probability for France (2012) by sex in Caswell (2022). — fra_surv_sex","text":"","code":"fra_surv_sex"},{"path":"https://ivanwilli.github.io/DemoKin/reference/fra_surv_sex.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Survival probability for France (2012) by sex in Caswell (2022). — fra_surv_sex","text":"data.frame survival probabilities age sex.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/fra_surv_sex.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Survival probability for France (2012) by sex in Caswell (2022). — fra_surv_sex","text":"Caswell (2022)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate kin counts in a one-sex framework. — kin","title":"Estimate kin counts in a one-sex framework. — kin","text":"Implementation Goodman-Keyfitz-Pullum equations matrix framework. produce matrilineal (patrilineal) kin count distribution kin age.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate kin counts in a one-sex framework. — kin","text":"","code":"kin(   p = NULL,   f = NULL,   time_invariant = TRUE,   pi = NULL,   n = NULL,   output_cohort = NULL,   output_period = NULL,   output_kin = NULL,   output_age_focal = NULL,   birth_female = 1/2.04,   summary_kin = TRUE )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate kin counts in a one-sex framework. — kin","text":"p numeric. vector (atomic)  matrix probabilities (survival ratios, transition age class general perspective) rows ages (columns years case matrix, name col year). f numeric. p fertility rates. time_invariant logical. Constant assumption given year rates. Default TRUE. pi numeric. U childbearing distribution (sum 1). Optional. n numeric. time_invariant = FALSE. p population distribution (counts %). Optional. output_cohort integer. Vector year cohorts returning results. within input data years range. output_period integer. Vector period years returning results. within input data years range. output_kin character. kin types return: \"m\" mother, \"d\" daughter,... output_age_focal integer. Vector ages select (make faster run). birth_female numeric. Female portion birth. multiplies f argument. f already female offspring, summary_kin logical. Whether include kin_summary table (see output details). Default TRUE. needs set 1.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate kin counts in a one-sex framework. — kin","text":"list : kin_full data frame year, cohort, Focal´s age, related ages type kin (example d daughter, oa older aunts, etc.), including living dead kin age. kin_summary data frame Focal´s age, related ages type kin, indicators obtained processing kin_full, grouping cohort period (depending given arguments): count_living: count living kin actual age Focal mean_age: mean age type living kin. sd_age: standard deviation age type living kin. count_death: count dead kin specific age Focal. count_cum_death: cumulated count dead kin specific age Focal. mean_age_lost: mean age Focal lost relative.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate kin counts in a one-sex framework. — kin","text":"See Caswell (2019) Caswell (2021) details formulas. One sex (female default).","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate kin counts in a one-sex framework. — kin","text":"","code":"# Kin expected matrilineal count for a Swedish female based on 2015 rates. swe_surv_2015 <- swe_px[,\"2015\"] swe_asfr_2015 <- swe_asfr[,\"2015\"] # Run kinship models swe_2015 <- kin(p = swe_surv_2015, f = swe_asfr_2015) head(swe_2015$kin_summary) #> # A tibble: 6 × 10 #>   age_focal kin   year  cohort count_living mean_age sd_age count_dead #>       <int> <chr> <lgl> <lgl>         <dbl>    <dbl>  <dbl>      <dbl> #> 1         0 coa   NA    NA           0.275      8.32   6.14  0.0000633 #> 2         0 cya   NA    NA           0.0898     4.05   3.68  0.0000370 #> 3         0 d     NA    NA           0        NaN    NaN     0         #> 4         0 gd    NA    NA           0        NaN    NaN     0         #> 5         0 ggd   NA    NA           0        NaN    NaN     0         #> 6         0 ggm   NA    NA           0.320     84.4    6.43  0.0287    #> # ℹ 2 more variables: count_cum_dead <dbl>, mean_age_lost <dbl>"},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin2sex.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate kin counts in a two-sex framework — kin2sex","title":"Estimate kin counts in a two-sex framework — kin2sex","text":"Implementation two-sex matrix kinship model. produces kin counts grouped kin, age sex relatives Focal´s age. example, male cousins aunts uncles different sibling's parents grouped one male count cousins. Note output labels relative following female notation: label m refers either mothers fathers, column sex_kin determine sex relative.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin2sex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate kin counts in a two-sex framework — kin2sex","text":"","code":"kin2sex(   pf = NULL,   pm = NULL,   ff = NULL,   fm = NULL,   time_invariant = TRUE,   sex_focal = \"f\",   birth_female = 1/2.04,   pif = NULL,   pim = NULL,   nf = NULL,   nm = NULL,   Hf = NULL,   Hm = NULL,   output_cohort = NULL,   output_period = NULL,   output_kin = NULL,   output_age_focal = NULL,   summary_kin = TRUE )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin2sex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate kin counts in a two-sex framework — kin2sex","text":"pf numeric. vector (atomic)  matrix female probabilities (survival ratios, transition age class general perspective) rows ages (columns years case matrix, name col year). pm numeric. vector (atomic)  matrix male probabilities (survival ratios, transition age class general perspective) rows ages (columns years case matrix, name col year). ff numeric. pf fertility rates. fm numeric. pm fertility rates. time_invariant logical. Constant assumption given year rates. Default TRUE. sex_focal character. \"f\" female \"m\" male. birth_female numeric. Female portion birth. multiplies f argument. f already female offspring, needs set 1. pif numeric. using specific age distribution childbearing mothers (length ages). Default NULL. pim numeric. using specific age distribution childbearing fathers (length ages). Default NULL. nf numeric. time_invariant = FALSE. pf population distribution (counts %). Optional. nm numeric. time_invariant = FALSE. pm population distribution (counts %). Optional. Hf numeric. list list element (name list element year) contains matrix cause-specific hazards females rows causes columns ages, name col age. Hm numeric. list list element (name list element year) contains matrix cause-specific hazards males rows causes columns ages, name col age. output_cohort integer. Vector year cohorts returning results. within input data years range. output_period integer. Vector period years returning results. within input data years range. output_kin character. kin types return: \"m\" mother, \"d\" daughter,... output_age_focal integer. Vector ages select (make faster run). summary_kin logical. Whether include kin_summary table (see output details). Default TRUE.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin2sex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate kin counts in a two-sex framework — kin2sex","text":"list : kin_full data frame year, cohort, Focal´s age, related ages type kin (example d daughter son depending sex_kin, oa older aunts uncles also depending sex_kin value, etc.), including living dead kin age. kin_summary data frame Focal´s age, related ages, sex type kin, indicators obtained processing kin_full, grouping cohort period (depending given arguments): count_living: count living kin actual age Focal mean_age: mean age type living kin. sd_age: standard deviation age type living kin. count_death: count dead kin specific age Focal. count_cum_death: cumulated count dead kin specific age Focal. mean_age_lost: mean age Focal lost relative.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin2sex.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate kin counts in a two-sex framework — kin2sex","text":"See Caswell (2022) details formulas.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin2sex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate kin counts in a two-sex framework — kin2sex","text":"","code":"# Kin expected count by relative sex for a French female based on 2012 rates. fra_fert_f <- fra_asfr_sex[,\"ff\"] fra_fert_m <- fra_asfr_sex[,\"fm\"] fra_surv_f <- fra_surv_sex[,\"pf\"] fra_surv_m <- fra_surv_sex[,\"pm\"] fra_2012 <- kin2sex(fra_surv_f, fra_surv_m, fra_fert_f, fra_fert_m) head(fra_2012$kin_summary) #> # A tibble: 6 × 11 #>   age_focal kin   sex_kin year  cohort count_living mean_age sd_age count_dead #>       <int> <chr> <chr>   <lgl> <lgl>         <dbl>    <dbl>  <dbl>      <dbl> #> 1         0 coa   f       NA    NA            1.27      9.55   7.18   0.000236 #> 2         0 coa   m       NA    NA            1.32      9.54   7.17   0.000408 #> 3         0 cya   f       NA    NA            0.455     5.19   4.84   0.000109 #> 4         0 cya   m       NA    NA            0.473     5.19   4.84   0.000143 #> 5         0 d     f       NA    NA            0       NaN    NaN      0        #> 6         0 d     m       NA    NA            0       NaN    NaN      0        #> # ℹ 2 more variables: count_cum_dead <dbl>, mean_age_lost <dbl>"},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_multi_stage.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate kin counts by age and stage in a time invariant framework — kin_multi_stage","title":"Estimate kin counts by age and stage in a time invariant framework — kin_multi_stage","text":"Implementation age-stage kin estimates (multi-state) Caswell (2020). Stages implied length input lists.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_multi_stage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate kin counts by age and stage in a time invariant framework — kin_multi_stage","text":"","code":"kin_multi_stage(   U = NULL,   f = NULL,   D = NULL,   H = NULL,   birth_female = 1/2.04,   output_kin = NULL,   parity = FALSE,   list_output = FALSE )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_multi_stage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate kin counts by age and stage in a time invariant framework — kin_multi_stage","text":"U list. age elements column-stochastic transition matrix dimension state space, conditional survival. f matrix. state-specific fertility (age rows states columns). accepted also list age-class. D matrix. survival probabilities state (age rows states columns). accepted also list state survival matrices. H matrix. assigns offspring individuals stage appropriate age class (age rows states columns). accepted also list matrix state. birth_female numeric. Female portion birth. output_kin character. kin return. example \"m\" mother, \"d\" daughter. See vignette kin types. parity logical. parity states imply age distribution mothers re-scaled parity 0 Focal born. Default TRUE. list_output logical. Results list. Default FALSE.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_multi_stage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate kin counts by age and stage in a time invariant framework — kin_multi_stage","text":"data frame focal´s age, related ages type kin (example d daughter, oa older aunts, etc.), living death kin counts, specific stage. list_output = TRUE list elements kin types.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_multi_stage_time_variant_2sex.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate kin counts by age, stage, and sex, in a time variant framework — kin_multi_stage_time_variant_2sex","title":"Estimate kin counts by age, stage, and sex, in a time variant framework — kin_multi_stage_time_variant_2sex","text":"Implementation combined formal demographic models: Caswell II,III,IV.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_multi_stage_time_variant_2sex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate kin counts by age, stage, and sex, in a time variant framework — kin_multi_stage_time_variant_2sex","text":"","code":"kin_multi_stage_time_variant_2sex(   U_list_females = NULL,   U_list_males = NULL,   F_list_females = NULL,   F_list_males = NULL,   T_list_females = NULL,   T_list_males = NULL,   H_list = NULL,   birth_female = 0.49,   parity = FALSE,   output_kin = NULL,   summary_kin = TRUE,   sex_Focal = \"Female\",   initial_stage_Focal = NULL,   output_years )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_multi_stage_time_variant_2sex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate kin counts by age, stage, and sex, in a time variant framework — kin_multi_stage_time_variant_2sex","text":"U_list_females list matrix entries: period-specific female survival probabilities. Age rows states columns. U_list_males list matrix entries: period-specific male survival probabilities. Age rows states columns. F_list_females list matrix elements: period-specific female fertility (age rows states columns). F_list_males list matrix entries: period-specific male fertility (age rows states columns). T_list_females list lists matrix entries: outer list entry period-specific, composed list stochastic matrices describe age-specific female probabilities transferring stage T_list_males list lists matrix entries: outer list entry period-specific, composed list stochastic matrices describe age-specific male probabilities transferring stage H_list list matrix entries: redistribution newborns across stage specific age-class birth_female numeric. birth ratio females males population parity logical. parity states imply age distribution mothers re-scaled parity 0 Focal born. Default TRUE. output_kin vector. vector particular kin one wishes obtain results , e.g., c(\"m\",\"d\",\"oa\"). Default kin types. summary_kin logical. Results data frame accumulated kin age Focal TRUE, kin age*stage distribution age Focal FALSE. sex_Focal character. Female Male user requests. initial_stage_Focal Numeric Natural number set 1,2,...,. stage Focal born (e.g., 1 parity 0) output_years vector. times wish count kin: start year = output_years1, end year = output_yearslength.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_multi_stage_time_variant_2sex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate kin counts by age, stage, and sex, in a time variant framework — kin_multi_stage_time_variant_2sex","text":"data frame focal age, kin age, kin stage, kin sex, year, cohort, expected number kin given restrictions.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_svk1990_caswell2020.html","id":null,"dir":"Reference","previous_headings":"","what":"Output for Slovakia 1990 in Caswell (2020). — kin_svk1990_caswell2020","title":"Output for Slovakia 1990 in Caswell (2020). — kin_svk1990_caswell2020","text":"Output Slovakia 1990 Caswell (2020).","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_svk1990_caswell2020.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Output for Slovakia 1990 in Caswell (2020). — kin_svk1990_caswell2020","text":"","code":"kin_svk1990_caswell2020"},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_svk1990_caswell2020.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Output for Slovakia 1990 in Caswell (2020). — kin_svk1990_caswell2020","text":"list specific kin types age-stage matrix","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_svk1990_caswell2020.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Output for Slovakia 1990 in Caswell (2020). — kin_svk1990_caswell2020","text":"Caswell (2021)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate kin counts in a time invariant framework for one-sex model (matrilineal/patrilineal) — kin_time_invariant","title":"Estimate kin counts in a time invariant framework for one-sex model (matrilineal/patrilineal) — kin_time_invariant","text":"Mtrix implementation Goodman-Keyfitz-Pullum equations adapted Caswell (2019).","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate kin counts in a time invariant framework for one-sex model (matrilineal/patrilineal) — kin_time_invariant","text":"","code":"kin_time_invariant(   p = NULL,   f = NULL,   birth_female = 1/2.04,   pi = NULL,   output_kin = NULL,   list_output = FALSE )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate kin counts in a time invariant framework for one-sex model (matrilineal/patrilineal) — kin_time_invariant","text":"p numeric. vector survival probabilities length ages. f numeric. vector age-specific fertility rates length ages. birth_female numeric. Female portion birth. pi numeric. using specific non-stable age distribution childbearing (length ages). Default NULL. output_kin character. kin return. example \"m\" mother, \"d\" daughter. See vignette kin types. list_output logical. Results list output_kin elements, focal´s age columns kin ages rows (2 * ages, last chunk ages death experience). Default FALSE","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate kin counts in a time invariant framework for one-sex model (matrilineal/patrilineal) — kin_time_invariant","text":"data frame focal´s age, related ages type kin (example d daughter, oa older aunts, etc.), alive death. list_output = TRUE list.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant_2sex.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate kin counts in a time invariant framework for two-sex model. — kin_time_invariant_2sex","title":"Estimate kin counts in a time invariant framework for two-sex model. — kin_time_invariant_2sex","text":"Two-sex matrix framework kin count estimates.produces kin counts grouped kin, age sex relatives Focal´s age. example, male cousins aunts uncles different sibling's parents grouped one male count cousins.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant_2sex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate kin counts in a time invariant framework for two-sex model. — kin_time_invariant_2sex","text":"","code":"kin_time_invariant_2sex(   pf = NULL,   pm = NULL,   ff = NULL,   fm = NULL,   sex_focal = \"f\",   birth_female = 1/2.04,   pif = NULL,   pim = NULL,   output_kin = NULL,   list_output = FALSE )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant_2sex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate kin counts in a time invariant framework for two-sex model. — kin_time_invariant_2sex","text":"pf numeric. vector survival probabilities females length ages. pm numeric. vector survival probabilities males length ages. ff numeric. vector age-specific fertility rates females length ages. fm numeric. vector age-specific fertility rates males length ages. sex_focal character. \"f\" female \"m\" male. birth_female numeric. Female portion birth. pif numeric. using specific non-stable age distribution childbearing mothers (length ages). Default NULL. pim numeric. using specific non-stable age distribution childbearing fathers (length ages). Default NULL. output_kin character. kin return, considering matrilineal names. example \"m\" parents, \"d\" children, etc. See vignette kin types. list_output logical. Results list output_kin elements, focal´s age columns kin ages rows (2 * ages, last chunk ages death experience). Default FALSE","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant_2sex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate kin counts in a time invariant framework for two-sex model. — kin_time_invariant_2sex","text":"data frame focal´s age, related ages type kin (example d children, oa older aunts/uncles, etc.), sex, alive death. list_output = TRUE list.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant_2sex.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate kin counts in a time invariant framework for two-sex model. — kin_time_invariant_2sex","text":"See Caswell (2022) details formulas.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant_2sex_cod.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate kin counts in a time invariant framework for two-sex model. — kin_time_invariant_2sex_cod","title":"Estimate kin counts in a time invariant framework for two-sex model. — kin_time_invariant_2sex_cod","text":"Two-sex matrix framework kin count death estimates.produces kin counts grouped kin, age sex relatives Focal´s age. example, male cousins aunts uncles different sibling's parents grouped one male count cousins. also produces kin deaths grouped kin, age, sex relatives Focal´s age, cause death.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant_2sex_cod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate kin counts in a time invariant framework for two-sex model. — kin_time_invariant_2sex_cod","text":"","code":"kin_time_invariant_2sex_cod(   pf = NULL,   pm = NULL,   ff = NULL,   fm = NULL,   Hf = NULL,   Hm = NULL,   sex_focal = \"f\",   birth_female = 1/2.04,   pif = NULL,   pim = NULL,   output_kin = NULL,   list_output = FALSE )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant_2sex_cod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate kin counts in a time invariant framework for two-sex model. — kin_time_invariant_2sex_cod","text":"pf numeric. vector survival probabilities females length ages. pm numeric. vector survival probabilities males length ages. ff numeric. vector age-specific fertility rates females length ages. fm numeric. vector age-specific fertility rates males length ages. Hf numeric. matrix cause-specific hazards females rows causes columns ages, name col age. Hm numeric. matrix cause-specific hazards males rows causes columns ages, name col age. sex_focal character. \"f\" female \"m\" male. birth_female numeric. Female portion birth. pif numeric. using specific non-stable age distribution childbearing mothers (length ages). Default NULL. pim numeric. using specific non-stable age distribution childbearing fathers (length ages). Default NULL. output_kin character. kin return, considering matrilineal names. example \"m\" parents, \"d\" children, etc. See vignette kin types. list_output logical. Results list output_kin elements, focal´s age columns kin ages rows (2 * ages, last chunk ages death experience). Default FALSE","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant_2sex_cod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate kin counts in a time invariant framework for two-sex model. — kin_time_invariant_2sex_cod","text":"data frame focal´s age, related ages type kin (example d children, oa older aunts/uncles, etc.), sex, alive death. list_output = TRUE list.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_invariant_2sex_cod.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate kin counts in a time invariant framework for two-sex model. — kin_time_invariant_2sex_cod","text":"See Caswell (2022) details formulas.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate kin counts in a time variant framework (dynamic rates) for one-sex model (matrilineal/patrilineal) — kin_time_variant","title":"Estimate kin counts in a time variant framework (dynamic rates) for one-sex model (matrilineal/patrilineal) — kin_time_variant","text":"Matrix implementation time variant Goodman-Keyfitz-Pullum equations matrix framework.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate kin counts in a time variant framework (dynamic rates) for one-sex model (matrilineal/patrilineal) — kin_time_variant","text":"","code":"kin_time_variant(   p = NULL,   f = NULL,   pi = NULL,   n = NULL,   output_cohort = NULL,   output_period = NULL,   output_kin = NULL,   birth_female = 1/2.04,   list_output = FALSE )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate kin counts in a time variant framework (dynamic rates) for one-sex model (matrilineal/patrilineal) — kin_time_variant","text":"p numeric. matrix survival ratios rows ages columns years. Column names must equal interval. f numeric. matrix age-specific fertility rates rows ages columns years. Coincident U. pi numeric. matrix distribution childbearing rows ages columns years. Coincident U. n numeric. matrix population rows ages columns years. Coincident U. output_cohort integer. Year birth focal return output. vector. within input data years range. output_period integer. Year return kinship structure. vector. within input data years range. output_kin character. kin return output: \"m\" mother, \"d\" daughter,... See vignette exahustive kin. birth_female numeric. Female portion birth. list_output logical. Results list years elements (result output_cohort output_period combination), second list output_kin elements, focal´s age columns kin ages rows (2 * ages, last chunk ages death experience). Default FALSE","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate kin counts in a time variant framework (dynamic rates) for one-sex model (matrilineal/patrilineal) — kin_time_variant","text":"data frame population kinship structure, Focal's cohort, focal´s age, period year, type relatives (example d daughter, oa older aunts, etc.), living death kin counts, age (living time deceased) relatives. list_output = TRUE list.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate kin counts in a time variant framework (dynamic rates) for one-sex model (matrilineal/patrilineal) — kin_time_variant","text":"See Caswell (2021) details formulas.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant_2sex.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate kin counts in a time variant framework (dynamic rates) in a two-sex framework (Caswell, 2022) — kin_time_variant_2sex","title":"Estimate kin counts in a time variant framework (dynamic rates) in a two-sex framework (Caswell, 2022) — kin_time_variant_2sex","text":"Two-sex matrix framework kin count estimates varying rates. produces kin counts grouped kin, age sex relatives Focal´s age. example, male cousins aunts uncles different sibling's parents grouped one male count cousins.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant_2sex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate kin counts in a time variant framework (dynamic rates) in a two-sex framework (Caswell, 2022) — kin_time_variant_2sex","text":"","code":"kin_time_variant_2sex(   pf = NULL,   pm = NULL,   ff = NULL,   fm = NULL,   sex_focal = \"f\",   birth_female = 1/2.04,   pif = NULL,   pim = NULL,   nf = NULL,   nm = NULL,   output_cohort = NULL,   output_period = NULL,   output_kin = NULL,   list_output = FALSE )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant_2sex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate kin counts in a time variant framework (dynamic rates) in a two-sex framework (Caswell, 2022) — kin_time_variant_2sex","text":"pf numeric. vector (atomic)  matrix probabilities (survival ratios, transition age class general perspective) rows ages (columns years case matrix, name col year). pm numeric. vector (atomic)  matrix probabilities (survival ratios, transition age class general perspective) rows ages (columns years case matrix, name col year). ff numeric. pf fertility rates. fm numeric. pm fertility rates. sex_focal character. \"f\" female \"m\" male. birth_female numeric. Female portion birth. multiplies f argument. f already female offspring, needs set 1. pif numeric. using specific age distribution childbearing mothers (length ages). Default NULL. pim numeric. using specific age distribution childbearing fathers (length ages). Default NULL. nf numeric. pf population distribution (counts %). Optional. nm numeric. pm population distribution (counts %). Optional. output_cohort integer. Vector year cohorts returning results. within input data years range. output_period integer. Vector period years returning results. within input data years range. output_kin character. kin types return: \"m\" mother, \"d\" daughter,... list_output logical. Results list years elements (result output_cohort output_period combination), second list output_kin elements, focal´s age columns kin ages rows (2 * ages, last chunk ages death experience). Default FALSE","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant_2sex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate kin counts in a time variant framework (dynamic rates) in a two-sex framework (Caswell, 2022) — kin_time_variant_2sex","text":"data.frame year, cohort, Focal´s age, related ages, sex type kin (example d daughter, oa older aunts, etc.), including living dead kin age sex.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant_2sex.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate kin counts in a time variant framework (dynamic rates) in a two-sex framework (Caswell, 2022) — kin_time_variant_2sex","text":"See Caswell (2022) details formulas.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant_2sex_cod.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate kin counts in a time variant framework (dynamic rates) in a two-sex framework (Caswell, 2022) — kin_time_variant_2sex_cod","title":"Estimate kin counts in a time variant framework (dynamic rates) in a two-sex framework (Caswell, 2022) — kin_time_variant_2sex_cod","text":"Two-sex matrix framework kin count estimates varying rates. produces kin counts grouped kin, age sex relatives Focal´s age. example, male cousins aunts uncles different sibling's parents grouped one male count cousins. also produces kin deaths grouped kin, age, sex relatives Focal´s age, cause death.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant_2sex_cod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate kin counts in a time variant framework (dynamic rates) in a two-sex framework (Caswell, 2022) — kin_time_variant_2sex_cod","text":"","code":"kin_time_variant_2sex_cod(   pf = NULL,   pm = NULL,   ff = NULL,   fm = NULL,   Hf = NULL,   Hm = NULL,   sex_focal = \"f\",   birth_female = 1/2.04,   pif = NULL,   pim = NULL,   nf = NULL,   nm = NULL,   output_cohort = NULL,   output_period = NULL,   output_kin = NULL,   list_output = FALSE )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant_2sex_cod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate kin counts in a time variant framework (dynamic rates) in a two-sex framework (Caswell, 2022) — kin_time_variant_2sex_cod","text":"pf numeric. vector (atomic)  matrix probabilities (survival ratios, transition age class general perspective) rows ages (columns years case matrix, name col year). pm numeric. vector (atomic)  matrix probabilities (survival ratios, transition age class general perspective) rows ages (columns years case matrix, name col year). ff numeric. pf fertility rates. fm numeric. pm fertility rates. Hf numeric. list list element (name list element year) contains matrix cause-specific hazards females rows causes columns ages, name col age. Hm numeric. list list element (name list element year) contains matrix cause-specific hazards males rows causes columns ages, name col age. sex_focal character. \"f\" female \"m\" male. birth_female numeric. Female portion birth. multiplies f argument. f already female offspring, needs set 1. pif numeric. using specific age distribution childbearing mothers (length ages). Default NULL. pim numeric. using specific age distribution childbearing fathers (length ages). Default NULL. nf numeric. pf population distribution (counts %). Optional. nm numeric. pm population distribution (counts %). Optional. output_cohort integer. Vector year cohorts returning results. within input data years range. output_period integer. Vector period years returning results. within input data years range. output_kin character. kin types return: \"m\" mother, \"d\" daughter,... list_output logical. Results list years elements (result output_cohort output_period combination), second list output_kin elements, focal´s age columns kin ages rows (2 * ages, last chunk ages death experience). Default FALSE","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant_2sex_cod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate kin counts in a time variant framework (dynamic rates) in a two-sex framework (Caswell, 2022) — kin_time_variant_2sex_cod","text":"data.frame year, cohort, Focal´s age, related ages, sex type kin (example d daughter, oa older aunts, etc.), including living dead kin age sex.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/kin_time_variant_2sex_cod.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate kin counts in a time variant framework (dynamic rates) in a two-sex framework (Caswell, 2022) — kin_time_variant_2sex_cod","text":"See Caswell (2022) details formulas.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/output_period_cohort_combination.html","id":null,"dir":"Reference","previous_headings":"","what":"APC combination to return — output_period_cohort_combination","title":"APC combination to return — output_period_cohort_combination","text":"define APC combination return kin kin2sex.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/output_period_cohort_combination.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"APC combination to return — output_period_cohort_combination","text":"","code":"output_period_cohort_combination(   output_cohort = NULL,   output_period = NULL,   age = NULL,   years_data = NULL )"},{"path":"https://ivanwilli.github.io/DemoKin/reference/output_period_cohort_combination.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"APC combination to return — output_period_cohort_combination","text":"output_cohort integer. vector selected calendar years. output_period integer. vector selected cohort years. age integer. vector ages kinship network filtered. years_data integer. vector years time-varying kinship network filtered.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/output_period_cohort_combination.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"APC combination to return — output_period_cohort_combination","text":"data.frame years ages filter kin kin_2sex functions.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/output_period_cohort_combination.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"APC combination to return — output_period_cohort_combination","text":"returning period cohort data huge time-series hard memory consuming, function auxiliary one deal selection inputs output_cohort output_period.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_caswell_2021.html","id":null,"dir":"Reference","previous_headings":"","what":"Historic and projected mother´s age distribution of childbearing from Sweden used in Caswell (2021) — pi_caswell_2021","title":"Historic and projected mother´s age distribution of childbearing from Sweden used in Caswell (2021) — pi_caswell_2021","text":"Historic projected mother´s age distribution childbearing Sweden used Caswell (2021)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_caswell_2021.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Historic and projected mother´s age distribution of childbearing from Sweden used in Caswell (2021) — pi_caswell_2021","text":"","code":"pi_caswell_2021"},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_caswell_2021.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Historic and projected mother´s age distribution of childbearing from Sweden used in Caswell (2021) — pi_caswell_2021","text":"matrix pi years cols ages rows.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_caswell_2021.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Historic and projected mother´s age distribution of childbearing from Sweden used in Caswell (2021) — pi_caswell_2021","text":"Caswell (2019)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix.html","id":null,"dir":"Reference","previous_headings":"","what":"Mixing distributions for the time-invariant multi-state 2-sex model: Non-parity case — pi_mix","title":"Mixing distributions for the time-invariant multi-state 2-sex model: Non-parity case — pi_mix","text":"Mixing distributions time-invariant multi-state 2-sex model: Non-parity case","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mixing distributions for the time-invariant multi-state 2-sex model: Non-parity case — pi_mix","text":"","code":"pi_mix(Uf, Um, Ff, Fm, alpha, na, ns)"},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mixing distributions for the time-invariant multi-state 2-sex model: Non-parity case — pi_mix","text":"Uf matrix. Block-structured matrix transfers females stage advances age Um matrix. Block-structured matrix transfers males stage advances age Ff matrix. Block-structured matrix counts reproduction females assigns newborns age stage Fm matrix. Block-structured matrix counts reproduction males assigns newborns age stage alpha scalar. Birth ratio male:female na scalar. Number age-classes ns scalar. Number stages","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mixing distributions for the time-invariant multi-state 2-sex model: Non-parity case — pi_mix","text":"list (vectors). list[1] = full agestagesex distribution list[2] = female agestage distribution normalised list[3] = male agestage distribution normalised list[4] = female marginal age distribution normalised list[5] = male marginal age distribution normalised","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix_TV.html","id":null,"dir":"Reference","previous_headings":"","what":"Mixing distributions for the time-variant multi-state 2-sex model: Non-parity case — pi_mix_TV","title":"Mixing distributions for the time-variant multi-state 2-sex model: Non-parity case — pi_mix_TV","text":"Mixing distributions time-variant multi-state 2-sex model: Non-parity case","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix_TV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mixing distributions for the time-variant multi-state 2-sex model: Non-parity case — pi_mix_TV","text":"","code":"pi_mix_TV(Ff, Fm, alpha, na, ns, previous_age_stage_dist)"},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix_TV.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mixing distributions for the time-variant multi-state 2-sex model: Non-parity case — pi_mix_TV","text":"Ff matrix. Block-structured matrix counts reproduction females assigns newborns age stage Fm matrix. Block-structured matrix counts reproduction males assigns newborns age stage alpha scalar. Birth ratio male:female na scalar. Number age-classes ns scalar. Number stages previous_age_stage_dist vector. Last years population structure (agestagesex full distribution)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix_TV.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mixing distributions for the time-variant multi-state 2-sex model: Non-parity case — pi_mix_TV","text":"list (vectors). list[1] = full agestagesex distribution list[2] = female agestage distribution normalised list[3] = male agestage distribution normalised list[4] = female marginal age distribution normalised list[5] = male marginal age distribution normalised","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix_TV_parity.html","id":null,"dir":"Reference","previous_headings":"","what":"Mixing distributions for the time-variant multi-state 2-sex model: Parity-specific case — pi_mix_TV_parity","title":"Mixing distributions for the time-variant multi-state 2-sex model: Parity-specific case — pi_mix_TV_parity","text":"Mixing distributions time-variant multi-state 2-sex model: Parity-specific case","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix_TV_parity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mixing distributions for the time-variant multi-state 2-sex model: Parity-specific case — pi_mix_TV_parity","text":"","code":"pi_mix_TV_parity(Ff, Fm, alpha, na, ns, previous_age_stage_dist)"},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix_TV_parity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mixing distributions for the time-variant multi-state 2-sex model: Parity-specific case — pi_mix_TV_parity","text":"Ff matrix. Block-structured matrix counts reproduction females assigns newborns age stage Fm matrix. Block-structured matrix counts reproduction males assigns newborns age stage alpha scalar. Birth ratio male:female na scalar. Number age-classes ns scalar. Number stages previous_age_stage_dist vector. Last years population structure (agestagesex full distribution) Uf matrix. Block-structured matrix transfers females stage advances age Um matrix. Block-structured matrix transfers males stage advances age","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix_TV_parity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mixing distributions for the time-variant multi-state 2-sex model: Parity-specific case — pi_mix_TV_parity","text":"list (vectors). list[1] = full agestagesex distribution list[2] = female agestage distribution normalised list[3] = male agestage distribution normalised list[4] = female marginal age distribution normalised list[5] = male marginal age distribution normalised","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix_parity.html","id":null,"dir":"Reference","previous_headings":"","what":"Mixing distributions for the time-invariant multi-state 2-sex model: Parity-specific case — pi_mix_parity","title":"Mixing distributions for the time-invariant multi-state 2-sex model: Parity-specific case — pi_mix_parity","text":"Mixing distributions time-invariant multi-state 2-sex model: Parity-specific case","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix_parity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mixing distributions for the time-invariant multi-state 2-sex model: Parity-specific case — pi_mix_parity","text":"","code":"pi_mix_parity(Uf, Um, Ff, Fm, alpha, na, ns)"},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix_parity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mixing distributions for the time-invariant multi-state 2-sex model: Parity-specific case — pi_mix_parity","text":"Uf matrix. Block-structured matrix transfers females stage advances age Um matrix. Block-structured matrix transfers males stage advances age Ff matrix. Block-structured matrix counts reproduction females assigns newborns age stage Fm matrix. Block-structured matrix counts reproduction males assigns newborns age stage alpha scalar. Birth ratio male:female na scalar. Number age-classes ns scalar. Number stages","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pi_mix_parity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mixing distributions for the time-invariant multi-state 2-sex model: Parity-specific case — pi_mix_parity","text":"list (vectors). list[1] = full agestagesex distribution list[2] = female agestage distribution normalised list[3] = male agestage distribution normalised list[4] = female marginal age distribution normalised list[5] = male marginal age distribution normalised","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://ivanwilli.github.io/DemoKin/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/plot_diagram.html","id":null,"dir":"Reference","previous_headings":"","what":"plot a Kin diagram (network) — plot_diagram","title":"plot a Kin diagram (network) — plot_diagram","text":"Draws Keyfitz-style kinship diagram given kinship object created kin function. Displays expected kin counts Focal aged ''.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/plot_diagram.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot a Kin diagram (network) — plot_diagram","text":"","code":"plot_diagram(kin_total, rounding = 3)"},{"path":"https://ivanwilli.github.io/DemoKin/reference/plot_diagram.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot a Kin diagram (network) — plot_diagram","text":"kin_total data.frame. values column kin define relative type - see demokin_codes(). Values column count expected number relatives. rounding numeric. Number decimals show diagram.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/plot_diagram.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot a Kin diagram (network) — plot_diagram","text":"Keyfitz-style kinship plot.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/rename_kin.html","id":null,"dir":"Reference","previous_headings":"","what":"rename kin — rename_kin","title":"rename kin — rename_kin","text":"Add kin labels depending sex","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/rename_kin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"rename kin — rename_kin","text":"","code":"rename_kin(df, sex = \"f\")"},{"path":"https://ivanwilli.github.io/DemoKin/reference/rename_kin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"rename kin — rename_kin","text":"df data.frame. data frame variable kin DemoKin codes labelled. sex character. \"f\" female, \"m\" male \"2sex\" sex naming.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/rename_kin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"rename kin — rename_kin","text":"Add column kin labels input data frame.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/rename_kin.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"rename kin — rename_kin","text":"See table demokin_codes know label options.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_Hxs.html","id":null,"dir":"Reference","previous_headings":"","what":"Age where assign offspring of individuals in each partity stage (Caswell, 2021). All to zero age in this case. — svk_Hxs","title":"Age where assign offspring of individuals in each partity stage (Caswell, 2021). All to zero age in this case. — svk_Hxs","text":"Age assign offspring individuals partity stage (Caswell, 2021). zero age case.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_Hxs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Age where assign offspring of individuals in each partity stage (Caswell, 2021). All to zero age in this case. — svk_Hxs","text":"","code":"svk_Hxs"},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_Hxs.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Age where assign offspring of individuals in each partity stage (Caswell, 2021). All to zero age in this case. — svk_Hxs","text":"matrix ones ages assign offspring individuals, stages cols ages rows.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_Hxs.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Age where assign offspring of individuals in each partity stage (Caswell, 2021). All to zero age in this case. — svk_Hxs","text":"Caswell (2021)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_Uxs.html","id":null,"dir":"Reference","previous_headings":"","what":"Probability of transition among parity stage for Slovakia in 1990, for each age, conditional on survival (Caswell, 2021). — svk_Uxs","title":"Probability of transition among parity stage for Slovakia in 1990, for each age, conditional on survival (Caswell, 2021). — svk_Uxs","text":"Probability transition among parity stage Slovakia 1990, age, conditional survival (Caswell, 2021).","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_Uxs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probability of transition among parity stage for Slovakia in 1990, for each age, conditional on survival (Caswell, 2021). — svk_Uxs","text":"","code":"svk_Uxs"},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_Uxs.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Probability of transition among parity stage for Slovakia in 1990, for each age, conditional on survival (Caswell, 2021). — svk_Uxs","text":"list column-stochastic matrix probabilities transition among parity stage, age, conditional survival.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_Uxs.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Probability of transition among parity stage for Slovakia in 1990, for each age, conditional on survival (Caswell, 2021). — svk_Uxs","text":"Caswell (2021)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_fxs.html","id":null,"dir":"Reference","previous_headings":"","what":"Female Slovakian fertility rates by parity stage in 1990 (Caswell, 2021) — svk_fxs","title":"Female Slovakian fertility rates by parity stage in 1990 (Caswell, 2021) — svk_fxs","text":"Female Slovakian fertility rates parity stage 1990 (Caswell, 2021)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_fxs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Female Slovakian fertility rates by parity stage in 1990 (Caswell, 2021) — svk_fxs","text":"","code":"svk_fxs"},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_fxs.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Female Slovakian fertility rates by parity stage in 1990 (Caswell, 2021) — svk_fxs","text":"matrix fx stages cols ages rows.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_fxs.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Female Slovakian fertility rates by parity stage in 1990 (Caswell, 2021) — svk_fxs","text":"Caswell (2021)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_pxs.html","id":null,"dir":"Reference","previous_headings":"","what":"Female Slovakian survival probabilities by parity stage in 1990 (Caswell, 2021) — svk_pxs","title":"Female Slovakian survival probabilities by parity stage in 1990 (Caswell, 2021) — svk_pxs","text":"Female Slovakian survival probabilities parity stage 1990 (Caswell, 2021)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_pxs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Female Slovakian survival probabilities by parity stage in 1990 (Caswell, 2021) — svk_pxs","text":"","code":"svk_pxs"},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_pxs.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Female Slovakian survival probabilities by parity stage in 1990 (Caswell, 2021) — svk_pxs","text":"matrix px stages cols ages rows.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/svk_pxs.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Female Slovakian survival probabilities by parity stage in 1990 (Caswell, 2021) — svk_pxs","text":"Caswell (2021)","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_Sx.html","id":null,"dir":"Reference","previous_headings":"","what":"Female swedish survival ratios from 1900 to 2015 — swe_Sx","title":"Female swedish survival ratios from 1900 to 2015 — swe_Sx","text":"Female swedish survival ratios 1900 2015","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_Sx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Female swedish survival ratios from 1900 to 2015 — swe_Sx","text":"","code":"swe_Sx"},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_Sx.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Female swedish survival ratios from 1900 to 2015 — swe_Sx","text":"matrix years cols ages (0 100 OAG) rows.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_Sx.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Female swedish survival ratios from 1900 to 2015 — swe_Sx","text":"HMD/HFD","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_asfr.html","id":null,"dir":"Reference","previous_headings":"","what":"Swedish age-specific fertility rates from 1900 to 2015 — swe_asfr","title":"Swedish age-specific fertility rates from 1900 to 2015 — swe_asfr","text":"Swedish age-specific fertility rates 1900 2015","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_asfr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Swedish age-specific fertility rates from 1900 to 2015 — swe_asfr","text":"","code":"swe_asfr"},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_asfr.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Swedish age-specific fertility rates from 1900 to 2015 — swe_asfr","text":"matrix years cols ages (0 100 OAG) rows.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_asfr.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Swedish age-specific fertility rates from 1900 to 2015 — swe_asfr","text":"HMD/HFD","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_pop.html","id":null,"dir":"Reference","previous_headings":"","what":"Female swedish population from 1900 to 2015 — swe_pop","title":"Female swedish population from 1900 to 2015 — swe_pop","text":"Female swedish population 1900 2015","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_pop.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Female swedish population from 1900 to 2015 — swe_pop","text":"","code":"swe_pop"},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_pop.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Female swedish population from 1900 to 2015 — swe_pop","text":"matrix years cols ages (0 100 OAG) rows.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_pop.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Female swedish population from 1900 to 2015 — swe_pop","text":"HMD/HFD","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_px.html","id":null,"dir":"Reference","previous_headings":"","what":"Female swedish survival probabilities from 1900 to 2015 — swe_px","title":"Female swedish survival probabilities from 1900 to 2015 — swe_px","text":"Female swedish survival probabilities 1900 2015","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_px.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Female swedish survival probabilities from 1900 to 2015 — swe_px","text":"","code":"swe_px"},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_px.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Female swedish survival probabilities from 1900 to 2015 — swe_px","text":"matrix years cols ages (0 100 OAG) rows.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/swe_px.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Female swedish survival probabilities from 1900 to 2015 — swe_px","text":"HMD/HFD","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/timevarying_kin.html","id":null,"dir":"Reference","previous_headings":"","what":"one time projection kin — timevarying_kin","title":"one time projection kin — timevarying_kin","text":"one time projection kin. internal function.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/timevarying_kin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"one time projection kin — timevarying_kin","text":"","code":"timevarying_kin(Ut, ft, pit, ages, pkin)"},{"path":"https://ivanwilli.github.io/DemoKin/reference/timevarying_kin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"one time projection kin — timevarying_kin","text":"Ut numeric. matrix survival probabilities (ratios). ft numeric. matrix age-specific fertility rates. pit numeric. matrix distribution childbearing. ages numeric. pkin numeric. list kin count distribution previous year.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/timevarying_kin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"one time projection kin — timevarying_kin","text":"list 14 types kin matrices (kin age Focal age) projected one time interval.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/timevarying_kin_2sex.html","id":null,"dir":"Reference","previous_headings":"","what":"one time projection kin — timevarying_kin_2sex","title":"one time projection kin — timevarying_kin_2sex","text":"one time projection kin. internal function.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/timevarying_kin_2sex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"one time projection kin — timevarying_kin_2sex","text":"","code":"timevarying_kin_2sex(Ut, Ft, Ft_star, pit, sex_focal, ages, pkin)"},{"path":"https://ivanwilli.github.io/DemoKin/reference/timevarying_kin_2sex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"one time projection kin — timevarying_kin_2sex","text":"Ut numeric. matrix survival probabilities (ratios). Ft numeric. matrix age-specific fertility rates. Ft_star numeric. Ft female fertility. pit numeric. matrix distribution childbearing. sex_focal character. \"f\" female \"m\" male. ages numeric. pkin numeric. list kin count distribution previous year.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/timevarying_kin_2sex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"one time projection kin — timevarying_kin_2sex","text":"list 14 types kin matrices (kin age Focal age, blocked two sex) projected one time interval.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/timevarying_kin_2sex_cod.html","id":null,"dir":"Reference","previous_headings":"","what":"one time projection kin — timevarying_kin_2sex_cod","title":"one time projection kin — timevarying_kin_2sex_cod","text":"one time projection kin. internal function.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/timevarying_kin_2sex_cod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"one time projection kin — timevarying_kin_2sex_cod","text":"","code":"timevarying_kin_2sex_cod(Ut, Ft, Ft_star, causes, pit, sex_focal, ages, pkin)"},{"path":"https://ivanwilli.github.io/DemoKin/reference/timevarying_kin_2sex_cod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"one time projection kin — timevarying_kin_2sex_cod","text":"Ut numeric. matrix survival probabilities (ratios). Ft numeric. matrix age-specific fertility rates. Ft_star numeric. Ft female fertility. causes integer. Number causes death included. pit numeric. matrix distribution childbearing. sex_focal character. \"f\" female \"m\" male. ages numeric. pkin numeric. list kin count distribution previous year.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/reference/timevarying_kin_2sex_cod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"one time projection kin — timevarying_kin_2sex_cod","text":"list 14 types kin matrices (kin age Focal age, blocked two sex) projected one time interval.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/news/index.html","id":"demokin-103","dir":"Changelog","previous_headings":"","what":"DemoKin 1.0.3","title":"DemoKin 1.0.3","text":"CRAN release: 2023-06-05","code":""},{"path":[]},{"path":[]},{"path":"https://ivanwilli.github.io/DemoKin/news/index.html","id":"demokin-100","dir":"Changelog","previous_headings":"","what":"DemoKin 1.0.0","title":"DemoKin 1.0.0","text":"Added NEWS.md file track changes package. Change stable/non-stable references time varying/non-varying rates. Add multi-state process.","code":""},{"path":"https://ivanwilli.github.io/DemoKin/news/index.html","id":"demokin-101-1","dir":"Changelog","previous_headings":"","what":"DemoKin 1.0.1","title":"DemoKin 1.0.1","text":"Submitted CRAN Death counts placed age Focal experience death. Aggregated kin types allowed (s older younger sisters, example).","code":""}]
